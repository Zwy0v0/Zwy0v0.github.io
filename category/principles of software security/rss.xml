<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title> â€¢ Posts by &#34;principles of software security&#34; category</title>
        <link>http://example.com</link>
        <description>ðŸŒ¸</description>
        <language>zh-CN</language>
        <pubDate>Wed, 30 Oct 2024 12:17:45 +1000</pubDate>
        <lastBuildDate>Wed, 30 Oct 2024 12:17:45 +1000</lastBuildDate>
        <category>JavaScript</category>
        <category>C</category>
        <category>software security</category>
        <category>AFL</category>
        <category>Linux</category>
        <category>Blog</category>
        <category>æ—¥å¸¸</category>
        <category>vulnerability</category>
        <category>C language</category>
        <category>SQL</category>
        <category>gdb</category>
        <item>
            <guid isPermalink="true">http://example.com/course/SQL-Injection/</guid>
            <title>SQL Injection</title>
            <link>http://example.com/course/SQL-Injection/</link>
            <category>software security</category>
            <category>SQL</category>
            <pubDate>Wed, 30 Oct 2024 12:17:45 +1000</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;SQL Injection&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#SQL Injection&#34;&gt;#&lt;/a&gt;SQL Injection&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Exploit vulnerabilities in input validation to run arbitrary commands in the database
&lt;ul&gt;
&lt;li&gt;Using user input to construct dynamic SQL statements to access the database&lt;/li&gt;
&lt;li&gt;Using stored procedures that are passed strings that contain unfiltered user input&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Attacker can execute arbitrary commands in the database
&lt;ul&gt;
&lt;li&gt;Worse if the application uses a privileged account to connect to the database&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight php&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Example&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$selecteduser&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$_GET&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;#x27;user&amp;#x27;&lt;/span&gt;];  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;variable&#34;&gt;$sql&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;SELECT Username, Key FROM Key &amp;quot;&lt;/span&gt; .  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;string&#34;&gt;&amp;quot;WHERE Username=&amp;#x27;&lt;span class=&#34;subst&#34;&gt;$selecteduser&lt;/span&gt;&amp;#x27;&amp;quot;&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;variable&#34;&gt;$rs&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$db&lt;/span&gt;-&amp;gt;&lt;span class=&#34;title function_ invoke__&#34;&gt;executeQuery&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$sql&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œ &lt;code&gt;$selecteduser&lt;/code&gt;  æ˜¯ä»Žç”¨æˆ·è¾“å…¥ä¸­ç›´æŽ¥èŽ·å–çš„ï¼Œå®ƒè¢«æ— è¿‡æ»¤åœ°æ’å…¥åˆ° SQL æŸ¥è¯¢ä¸­ã€‚ç”±äºŽæ²¡æœ‰å¯¹  &lt;code&gt;$selecteduser&lt;/code&gt;  è¿›è¡Œä»»ä½•è¿‡æ»¤æˆ–è½¬ä¹‰ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨è¾“å…¥ä¸­æ·»åŠ æ¶æ„çš„ SQL è¯­å¥ï¼Œæ”¹å˜åŽŸå§‹æŸ¥è¯¢çš„å«ä¹‰ã€‚å‡è®¾æ”»å‡»è€…æä¾›ä»¥ä¸‹è¾“å…¥ä½œä¸º user å‚æ•°ï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Example&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;admin&lt;span class=&#34;string&#34;&gt;&amp;#x27; OR &amp;#x27;&lt;/span&gt;1&lt;span class=&#34;string&#34;&gt;&amp;#x27;=&amp;#x27;&lt;/span&gt;1 &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;è¿™å°†å¯¼è‡´æŸ¥è¯¢å˜æˆï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Example&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;SELECT&lt;/span&gt; Username, Key &lt;span class=&#34;keyword&#34;&gt;FROM&lt;/span&gt; Key &lt;span class=&#34;keyword&#34;&gt;WHERE&lt;/span&gt; Username&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;string&#34;&gt;&amp;#x27;admin&amp;#x27;&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;OR&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;#x27;1&amp;#x27;&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;string&#34;&gt;&amp;#x27;1&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ &lt;code&gt;OR &#39;1&#39;=&#39;1&#39;&lt;/code&gt;  æ°¸è¿œä¸ºçœŸï¼Œè¿™æ„å‘³ç€æ•°æ®åº“å°†è¿”å›žæ‰€æœ‰ç”¨æˆ·çš„ä¿¡æ¯ï¼Œè€Œä¸ä»…ä»…æ˜¯  &lt;code&gt;admin&lt;/code&gt;  ç”¨æˆ·çš„ä¿¡æ¯&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://img.picui.cn/free/2024/10/30/6721ec7cbba70.png&#34; alt=&#34;img&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;Example&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Example&#34;&gt;#&lt;/a&gt;Example&lt;/h1&gt;
&lt;p&gt;SQL Injections Can be Used to â€¦&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Login&lt;br&gt;
SQL æ³¨å…¥ æ˜¯ä¸€ç§é€šè¿‡æ“æŽ§ç”¨æˆ·è¾“å…¥ï¼Œä½¿ä¹‹ç›´æŽ¥åµŒå…¥ SQL æŸ¥è¯¢ï¼Œä»Žè€Œæ”¹å˜æŸ¥è¯¢é€»è¾‘çš„æ”»å‡»æ–¹å¼ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ç§æ–¹å¼èŽ·å–æœªç»æŽˆæƒçš„æ•°æ®åº“è®¿é—®ï¼Œç”šè‡³èŽ·å–æ•æ„Ÿæ•°æ®&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Example&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;set&lt;/span&gt; userFound&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;keyword&#34;&gt;execute&lt;/span&gt;( &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   &amp;quot;SELECT * FROM USERS WHERE &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    username=&amp;#x27;$username&amp;#x27; AND password=&amp;#x27;$password&amp;#x27;;&amp;quot;); &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;To authenticate logins, server runs this SQL command against the user database&lt;/p&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Example&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;SELECT&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;FROM&lt;/span&gt; USERS &lt;span class=&#34;keyword&#34;&gt;WHERE&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  username&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;string&#34;&gt;&amp;#x27;$username&amp;#x27;&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;AND&lt;/span&gt; password&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;string&#34;&gt;&amp;#x27;$password&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;User enters the following as  &lt;code&gt;$username&lt;/code&gt;  and  &lt;code&gt;$password&lt;/code&gt;&lt;/p&gt;
 &lt;figure class=&#34;highlight sql&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Example&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;&amp;#x27; OR password LIKE &amp;#x27;&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;%&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Server then executes&lt;/p&gt;
 &lt;figure class=&#34;highlight sql&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Example&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;SELECT&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;FROM&lt;/span&gt; USERS &lt;span class=&#34;keyword&#34;&gt;WHERE&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  username&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;OR&lt;/span&gt; password &lt;span class=&#34;keyword&#34;&gt;LIKE&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;#x27;%&amp;#x27;&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;AND&lt;/span&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  password&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;OR&lt;/span&gt; password &lt;span class=&#34;keyword&#34;&gt;LIKE&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;#x27;%&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;code&gt;username=&#39;&#39; OR password LIKE &#39;%&#39;&lt;/code&gt;  çš„æ¡ä»¶æ€»æ˜¯ä¸ºçœŸï¼Œå› ä¸º  &lt;code&gt;password LIKE &#39;%&#39; &lt;/code&gt; å¯ä»¥åŒ¹é…ä»»ä½•å¯†ç ã€‚&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Steal Data&lt;br&gt;
 æ”»å‡»è€…ä½¿ç”¨ä¸€ç§å¸¸è§çš„æŠ€å·§ï¼Œé€šè¿‡æž„é€ ç‰¹æ®Šçš„è¾“å…¥ï¼Œä½¿æŸ¥è¯¢æ¡ä»¶æ€»æ˜¯è¿”å›ž trueï¼Œä»¥ä¾¿èŽ·å–æ›´å¤šçš„æ•°æ®ã€‚&lt;br&gt;
When the result is returned to the user&lt;/li&gt;
&lt;/ol&gt;
 &lt;figure class=&#34;highlight sql&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Example&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;SELECT&lt;/span&gt; email &lt;span class=&#34;keyword&#34;&gt;FROM&lt;/span&gt; USERS &lt;span class=&#34;keyword&#34;&gt;WHERE&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  username&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;string&#34;&gt;&amp;#x27;$username&amp;#x27;&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;AND&lt;/span&gt; password&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;string&#34;&gt;&amp;#x27;$password&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;To get more data, attacker gives  &lt;code&gt;username&lt;/code&gt;&lt;/p&gt;
  &lt;figure class=&#34;highlight sql&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Example&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;&amp;#x27; OR 1=1 #&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;code&gt;1=1&lt;/code&gt;  æ˜¯ä¸€ä¸ªå§‹ç»ˆä¸ºçœŸçš„æ¡ä»¶ã€‚&lt;br&gt;
 &lt;code&gt;#&lt;/code&gt;  (åœ¨ MySQL ä¸­) æˆ–  &lt;code&gt;--&lt;/code&gt;  (åœ¨å…¶ä»– RDBMS ä¸­) è¡¨ç¤ºæ³¨é‡Šç¬¦å·ï¼ŒåŽé¢çš„æ‰€æœ‰å†…å®¹éƒ½è¢«å¿½ç•¥ã€‚è¿™æ ·ä¸€æ¥ï¼Œ &lt;code&gt;AND password=&#39;$password&#39; &lt;/code&gt; å°±è¢«æ³¨é‡ŠæŽ‰äº†ï¼Œä¸ä¼šå½±å“æŸ¥è¯¢çš„ç»“æžœã€‚&lt;br&gt;
å› æ­¤æœ€ç»ˆç»“æžœæ˜¯ï¼š&lt;/p&gt;
  &lt;figure class=&#34;highlight sql&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Example&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;SELECT&lt;/span&gt; email &lt;span class=&#34;keyword&#34;&gt;FROM&lt;/span&gt; USERS &lt;span class=&#34;keyword&#34;&gt;WHERE&lt;/span&gt; username&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;OR&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ç”±äºŽ  &lt;code&gt;WHERE&lt;/code&gt;  å­å¥æ€»ä¸ºçœŸï¼ŒæŸ¥è¯¢ä¼šè¿”å›ž  &lt;code&gt;USERS&lt;/code&gt;  è¡¨ä¸­æ‰€æœ‰ç”¨æˆ·çš„ç”µå­é‚®ä»¶åœ°å€ï¼Œè€Œä¸ä»…ä»…æ˜¯åŒ¹é…ç‰¹å®šç”¨æˆ·åå’Œå¯†ç çš„è®°å½•ã€‚&lt;/p&gt;
&lt;p&gt;ä¹Ÿå¯ä»¥ä»Žå…¶ä»–æ•°æ®åº“çªƒå–æ•°æ® é€šè¿‡è¾“å…¥ &lt;code&gt;username&lt;/code&gt;&lt;/p&gt;
  &lt;figure class=&#34;highlight sql&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Example&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;&amp;#x27; AND 1=0 &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt; UNION SELECT cardholder, number, exp_month, exp_year FROM &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt; creditcards #&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ç”±äºŽç¬¬ä¸€éƒ¨åˆ†çš„æ¡ä»¶ä¸æˆç«‹ï¼ŒåŽŸæŸ¥è¯¢ä¸è¿”å›žä»»ä½•ç»“æžœï¼›ä½†  &lt;code&gt;UNION&lt;/code&gt;  æ“ä½œç¬¦ä½¿å¾—æŸ¥è¯¢çš„ç»“æžœå˜æˆä¿¡ç”¨å¡è¡¨ä¸­çš„æ•°æ®ï¼Œä»Žè€Œè¢«æ”»å‡»è€…èŽ·å–ã€‚&lt;/p&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Run Shell Commands&lt;br&gt;
 é€šè¿‡åœ¨æ•°æ®åº“æœåŠ¡å™¨ä¸Š æ‰§è¡Œ shell å‘½ä»¤ï¼Œæ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ç”¨æˆ·è´¦æˆ·ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæ”»å‡»è€…èƒ½å¤Ÿçªç ´æ•°æ®åº“çš„è¾¹ç•Œï¼Œç›´æŽ¥å¯¹æ“ä½œç³»ç»Ÿè¿›è¡Œä¿®æ”¹ï¼Œä»Žè€Œä½¿æœåŠ¡å™¨æ›´åŠ å®¹æ˜“å—åˆ°è¿›ä¸€æ­¥çš„æ”»å‡»ã€‚&lt;br&gt;
ç”¨æˆ·è¾“å…¥ï¼šæ”»å‡»è€…åœ¨ç”¨æˆ·åå­—æ®µä¸­è¾“å…¥ä»¥ä¸‹å­—ç¬¦ä¸²ï¼š&lt;/li&gt;
&lt;/ol&gt;
  &lt;figure class=&#34;highlight sql&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Example&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;&amp;#x27;; exec cmdshell &amp;#x27;&lt;/span&gt;net &lt;span class=&#34;keyword&#34;&gt;user&lt;/span&gt; badguy badpwd&lt;span class=&#34;string&#34;&gt;&amp;#x27; /ADD #&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;code&gt;&#39;;&lt;/code&gt; ï¼šç»“æŸäº†å½“å‰çš„ SQL æŸ¥è¯¢è¯­å¥ã€‚&lt;br&gt;
 &lt;code&gt;exec cmdshell &#39;net user badguy badpwd&#39; /ADD&#39;&lt;/code&gt; ï¼šåˆ©ç”¨æ•°æ®åº“æœåŠ¡å™¨çš„  &lt;code&gt;cmdshell&lt;/code&gt;  åŠŸèƒ½æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªåä¸º  &lt;code&gt;badguy&lt;/code&gt; ï¼Œå¯†ç ä¸º  &lt;code&gt;badpwd&lt;/code&gt;  çš„æ–°ç”¨æˆ·è´¦æˆ·ã€‚&lt;br&gt;
 &lt;code&gt;#&lt;/code&gt; ï¼šæ³¨é‡Šç¬¦å·ï¼Œç”¨æ¥å¿½ç•¥åŽç»­çš„ SQL è¯­å¥ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨å…¥åŽçš„ SQL æŸ¥è¯¢å˜æˆäº†ï¼š&lt;/p&gt;
  &lt;figure class=&#34;highlight sql&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Example&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;SELECT&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;FROM&lt;/span&gt; UserTable &lt;span class=&#34;keyword&#34;&gt;WHERE&lt;/span&gt; username&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt;; &lt;span class=&#34;keyword&#34;&gt;exec&lt;/span&gt; cmdshell &lt;span class=&#34;string&#34;&gt;&amp;#x27;net user badguy badpwd&amp;#x27;&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;keyword&#34;&gt;ADD&lt;/span&gt; #...&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;Changeã€Destory Data&lt;br&gt;
Create new users&lt;/li&gt;
&lt;/ol&gt;
  &lt;figure class=&#34;highlight sql&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Example&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;&amp;#x27;; INSERT INTO USERS (&amp;#x27;&lt;/span&gt;uname&lt;span class=&#34;string&#34;&gt;&amp;#x27;,&amp;#x27;&lt;/span&gt;passwd&lt;span class=&#34;string&#34;&gt;&amp;#x27;) &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt; VALUES (&amp;#x27;&lt;/span&gt;hacker&lt;span class=&#34;string&#34;&gt;&amp;#x27;,&amp;#x27;&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;38&lt;/span&gt;a74f&lt;span class=&#34;string&#34;&gt;&amp;#x27;); # &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Reset email (or password, etc.)&lt;/p&gt;
  &lt;figure class=&#34;highlight sql&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Example&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;&amp;#x27;; UPDATE USERS SET email=&amp;#x27;&lt;/span&gt;hacker&lt;span class=&#34;variable&#34;&gt;@root&lt;/span&gt;.org&lt;span class=&#34;string&#34;&gt;&amp;#x27;  &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt; WHERE email=&amp;#x27;&lt;/span&gt;victim&lt;span class=&#34;variable&#34;&gt;@yahoo&lt;/span&gt;.com&lt;span class=&#34;string&#34;&gt;&amp;#x27;; #&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;Second-Order SQL Injections&lt;/li&gt;
&lt;/ol&gt;
  &lt;figure class=&#34;highlight php&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Example&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;variable&#34;&gt;$db&lt;/span&gt; = &lt;span class=&#34;title function_ invoke__&#34;&gt;mysql_connect&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;localhost&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;root&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;password&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;title function_ invoke__&#34;&gt;mysql_select_db&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;Shipping&amp;quot;&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$db&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;variable&#34;&gt;$id&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$HTTP_GET_VARS&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;]; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;variable&#34;&gt;$qry&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;quot;SELECT ccnum FROM cust WHERE id = &lt;span class=&#34;subst&#34;&gt;$id&lt;/span&gt;&amp;quot;&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;variable&#34;&gt;$result&lt;/span&gt; = &lt;span class=&#34;title function_ invoke__&#34;&gt;mysql_query&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$qry&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$db&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;variable&#34;&gt;$result&lt;/span&gt;) &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;title function_ invoke__&#34;&gt;mysql_result&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$result&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;ccnum&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;No result!&amp;quot;&lt;/span&gt; . &lt;span class=&#34;title function_ invoke__&#34;&gt;mysql_error&lt;/span&gt;(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;åˆå§‹æ³¨å…¥ï¼šæ”»å‡»è€…è®¾æ³•å°†  &lt;code&gt;uname&lt;/code&gt;  å­—æ®µè®¾ç½®ä¸ºï¼š &lt;code&gt;admin&#39; #&lt;/code&gt; ã€‚&lt;br&gt;
åœ¨å¦ä¸€ä¸ªæ´»åŠ¨ä¸­ï¼Œä¾‹å¦‚å¯†ç æ›´æ–°æ“ä½œï¼Œä»£ç å¯èƒ½ä¼šä½¿ç”¨ä¹‹å‰å­˜å‚¨çš„  &lt;code&gt;uname&lt;/code&gt;  å€¼ã€‚å› ä¸º  &lt;code&gt;uname&lt;/code&gt;  åŒ…å«æ³¨é‡Šç¬¦å·ï¼Œå®žé™…æ‰§è¡Œçš„ SQL è¯­å¥å°†å˜æˆï¼š&lt;/p&gt;
  &lt;figure class=&#34;highlight sql&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Example&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;UPDATE&lt;/span&gt; USERS &lt;span class=&#34;keyword&#34;&gt;SET&lt;/span&gt; passwd&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;string&#34;&gt;&amp;#x27;cracked&amp;#x27;&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;WHERE&lt;/span&gt; uname&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;string&#34;&gt;&amp;#x27;admin&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Persistent storage (such as a table row) is deemed as a &lt;strong&gt;trusted source&lt;/strong&gt; thus may not be sanitised&lt;br&gt;
Attacks may be subsequently executed by &lt;strong&gt;multiple&lt;/strong&gt; activities&lt;/p&gt;
&lt;h1 id=&#34;Preventing SQL Injection&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Preventing SQL Injection&#34;&gt;#&lt;/a&gt;Preventing SQL Injection&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;Finding SQL Injection Vulnerabilities&lt;br&gt;
Any application that has the following pattern is at risk of SQL injection
&lt;ol&gt;
&lt;li&gt;Take user input&lt;/li&gt;
&lt;li&gt;Do not check validity of user input&lt;/li&gt;
&lt;li&gt;Use user input data to query a database&lt;/li&gt;
&lt;li&gt;Use string manipulation to build the SQL query or the SQL exec command&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Manual Techniques&lt;br&gt;
Try entering junk SQL commands into input fields you suspect may not be validated
&lt;ul&gt;
&lt;li&gt;Use as username:  &lt;code&gt;abc&#39; JFKDJ #&lt;/code&gt; &lt;br&gt;
Look for errors or unexpected behaviour&lt;/li&gt;
&lt;li&gt;Some web applications running in debug mode will show you the whole SQL statement to â€œhelp you debugâ€, but this also helps attackers attack&lt;/li&gt;
&lt;li&gt;å¸¸è§çš„æ‰‹åŠ¨æµ‹è¯•å­—ç¬¦ä¸²ï¼š&lt;br&gt;
 &lt;code&gt;&#39; OR 1=1 --&lt;/code&gt; ï¼šç»•è¿‡èº«ä»½éªŒè¯ã€‚&lt;br&gt;
 &lt;code&gt;&#39; UNION SELECT NULL, NULL, NULL --&lt;/code&gt; ï¼šå°è¯•è®¿é—®å…¶ä»–è¡¨ä¸­çš„æ•°æ®ã€‚&lt;br&gt;
 &lt;code&gt;&#39; AND (SELECT COUNT(*) FROM users) &amp;gt; 0 --&lt;/code&gt; ï¼šæ£€æµ‹æŸ¥è¯¢é€»è¾‘ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Automated Techniques
&lt;ol&gt;
&lt;li&gt;Sqlmap (&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3NxbG1hcC5vcmc=&#34;&gt;sqlmap.org&lt;/span&gt;) profiles the database on a given URL&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Identify vulnerable parameters&lt;/li&gt;
&lt;li&gt;Identify which types of attacks work&lt;/li&gt;
&lt;li&gt;Take over the database&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;SQL Inject Me was a Firefox add-on&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Try standard SQL injection techniques for a variety of database languages&lt;/li&gt;
&lt;li&gt;In every form on a page&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Preventing SQL Injection
&lt;ol&gt;
&lt;li&gt;Input validation&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Filter any character with special meanings (apostrophes, semicolons, percent symbols, hyphens, etc.)&lt;/li&gt;
&lt;li&gt;Check the data type (e.g. make sure itâ€™s an integer)&lt;/li&gt;
&lt;li&gt;Blacklisting â€œbadâ€ characters doesnâ€™t always work
&lt;ol&gt;
&lt;li&gt;Could prevent valid input (e.g. last name Oâ€™Brien)&lt;/li&gt;
&lt;li&gt;Forget to filter out some characters&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Escaping quotes&lt;br&gt;
Use escape characters to prevent the quote from becoming part of the query. Example: convert  &lt;code&gt;&#39; &lt;/code&gt;  into  &lt;code&gt; \&#39;&lt;/code&gt; . Different databases have different rules for escaping&lt;/li&gt;
&lt;li&gt;Whitelisting&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Allow only well-defined set of safe values&lt;/li&gt;
&lt;li&gt;Set implicitly defined through regular expressions æ­£åˆ™è¡¨è¾¾å¼&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Best Solution: Prepared Statements( Separating code and data)&lt;br&gt;
In most injection attacks, data is interpreted as control: this changes the semantics of a query or a command&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Typed bind variables:  &lt;code&gt;? &lt;/code&gt; placeholders guaranteed to be data (not control)&lt;/li&gt;
&lt;li&gt;Prepared statements are &lt;strong&gt;pre-compiled&lt;/strong&gt; by the database management system waiting for input&lt;/li&gt;
&lt;li&gt;Placeholders prevent that the users input gets attached to the SQL query resulting in a separation of code and data&lt;/li&gt;
&lt;li&gt;For example, the database registers  &lt;code&gt;&#39;Robert&#39; ); DROP TABLE Students;--&#39;&lt;/code&gt;&lt;figure class=&#34;highlight java&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Prepared Statement: Java&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;PreparedStatement&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;ps&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; db.prepareStatement(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;string&#34;&gt;&amp;quot;SELECT pizza, toppings, quantity, &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;  order_day FROM orders WHERE userid=? &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;  AND order_month=?&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; ps.setInt(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, session.getCurrentUserId());&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; ps.setInt(&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;, Integer.parseInt(request.getParameter(&lt;span class=&#34;string&#34;&gt;&amp;quot;month&amp;quot;&lt;/span&gt;)));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;type&#34;&gt;ResultSet&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;res&lt;/span&gt; &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; ps.executeQuery();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨é¢„å¤„ç†è¯­å¥ (PreparedStatement)&lt;br&gt;
 &lt;code&gt;PreparedStatement&lt;/code&gt;  æ˜¯ Java ä¸­ç”¨äºŽæ‰§è¡Œé¢„ç¼–è¯‘çš„ SQL è¯­å¥çš„å¯¹è±¡ï¼Œå®ƒç¡®ä¿ SQL æŸ¥è¯¢ç»“æž„å’Œè¾“å…¥æ•°æ®çš„åˆ†ç¦»ã€‚åœ¨æ­¤ä»£ç ä¸­ï¼Œä½¿ç”¨  &lt;code&gt;?&lt;/code&gt;  å ä½ç¬¦æ¥æ ‡è®°ç”¨æˆ·è¾“å…¥çš„ä½ç½®ï¼Œç¡®ä¿è¾“å…¥çš„æ•°æ®ä¸è¢«è§£é‡Šä¸º SQL æŽ§åˆ¶é€»è¾‘ã€‚&lt;/li&gt;
&lt;li&gt;ç»‘å®šå˜é‡&lt;br&gt;
é€šè¿‡  &lt;code&gt;ps.setInt(1, ...)&lt;/code&gt;  å’Œ  &lt;code&gt;ps.setInt(2, ...)&lt;/code&gt;  æ–¹æ³•ï¼Œå°† &lt;code&gt;ç”¨æˆ· ID&lt;/code&gt;  å’Œ &lt;code&gt;æœˆä»½&lt;/code&gt; å‚æ•°ç»‘å®šåˆ°ç›¸åº”çš„å ä½ç¬¦ä¸Šã€‚&lt;br&gt;
ç»‘å®šçš„å˜é‡å…·æœ‰æ˜Žç¡®çš„ç±»åž‹ï¼ˆå¦‚ intã€String ç­‰ï¼‰ï¼Œè¿™ç¡®ä¿äº†è¾“å…¥æ•°æ®ä¸ä¼šæ”¹å˜ SQL æŸ¥è¯¢çš„é€»è¾‘ã€‚&lt;/li&gt;
&lt;/ul&gt;
 &lt;figure class=&#34;highlight csharp&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Prepared Statement: ASP.NET&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;SqlCommand cmd = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; SqlCommand(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;string&#34;&gt;&amp;quot;SELECT * FROM UserTable &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;   WHERE username = @User AND password = @Pwd&amp;quot;&lt;/span&gt;, &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   dbConnection&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; cmd.Parameters.Add(&lt;span class=&#34;string&#34;&gt;&amp;quot;@User&amp;quot;&lt;/span&gt;, Request[&lt;span class=&#34;string&#34;&gt;&amp;quot;user&amp;quot;&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; cmd.Parameters.Add(&lt;span class=&#34;string&#34;&gt;&amp;quot;@Pwd&amp;quot;&lt;/span&gt;, Request[&lt;span class=&#34;string&#34;&gt;&amp;quot;pwd&amp;quot;&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; cmd.ExecuteReader();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;æŸ¥è¯¢è¯­å¥ä¸­çš„  &lt;code&gt;@User&lt;/code&gt;  å’Œ  &lt;code&gt;@Pwd&lt;/code&gt;  æ˜¯å‚æ•°å ä½ç¬¦ï¼Œç”¨äºŽæ ‡è®°ç”¨æˆ·è¾“å…¥çš„ä½ç½®ã€‚&lt;figure class=&#34;highlight php&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Prepared Statement: PHP&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;variable&#34;&gt;$db&lt;/span&gt; = &lt;span class=&#34;title function_ invoke__&#34;&gt;mysqli_connect&lt;/span&gt;(&lt;span class=&#34;title function_ invoke__&#34;&gt;getServer&lt;/span&gt;(), &lt;span class=&#34;title function_ invoke__&#34;&gt;getUid&lt;/span&gt;(), &lt;span class=&#34;title function_ invoke__&#34;&gt;getPwd&lt;/span&gt;()); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;variable&#34;&gt;$stmt&lt;/span&gt; = &lt;span class=&#34;title function_ invoke__&#34;&gt;mysqli_prepare&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$db&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;SELECT ccnum FROM cust WHERE id = ?&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;variable&#34;&gt;$id&lt;/span&gt; = &lt;span class=&#34;variable&#34;&gt;$HTTP_GET_VARS&lt;/span&gt;[&lt;span class=&#34;string&#34;&gt;&amp;quot;id&amp;quot;&lt;/span&gt;]; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;comment&#34;&gt;// ä»…å…è®¸æœ‰æ•ˆçš„IDï¼ˆ1-8ä½æ•°å­—ï¼‰&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;title function_ invoke__&#34;&gt;preg_match&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;/^\d&amp;#123;1,8&amp;#125;$/&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$id&lt;/span&gt;)) &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;title function_ invoke__&#34;&gt;mysqli_stmt_bind_param&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$stmt&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;s&amp;quot;&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$id&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;title function_ invoke__&#34;&gt;mysqli_stmt_execute&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$stmt&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;title function_ invoke__&#34;&gt;mysqli_stmt_bind_result&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$stmt&lt;/span&gt;, &lt;span class=&#34;variable&#34;&gt;$result&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;title function_ invoke__&#34;&gt;mysqli_stmt_fetch&lt;/span&gt;(&lt;span class=&#34;variable&#34;&gt;$stmt&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; ...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;meta&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;li&gt;SQL æŸ¥è¯¢ä¸­ä½¿ç”¨  &lt;code&gt;?&lt;/code&gt;  ä½œä¸ºå ä½ç¬¦ï¼Œè¡¨ç¤ºå‚æ•°çš„ä½ç½®&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼  &lt;code&gt;preg_match(&#39;/^\d&amp;#123;1,8&amp;#125;$/&#39;, $id)&lt;/code&gt;  æ¥éªŒè¯ç”¨æˆ·è¾“å…¥ã€‚è¿™ç¡®ä¿äº†è¾“å…¥æ˜¯ 1 åˆ° 8 ä½çš„æ•°å­—ï¼Œè¿‡æ»¤æŽ‰äº†æ½œåœ¨çš„æ¶æ„è¾“å…¥&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨  &lt;code&gt;mysqli_stmt_bind_param($stmt, &amp;quot;s&amp;quot;, $id)&lt;/code&gt;  æ–¹æ³•å°†ç”¨æˆ·è¾“å…¥çš„ ID ä½œä¸ºå‚æ•°ç»‘å®šåˆ°é¢„å¤„ç†è¯­å¥ä¸­ã€‚å‚æ•°ç±»åž‹  &lt;code&gt;s&lt;/code&gt;  æŒ‡å®šç»‘å®šçš„å˜é‡æ˜¯å­—ç¬¦ä¸²ç±»åž‹ï¼ˆstringï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;Fixing SQL Injections&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Validate all input&lt;/li&gt;
&lt;li&gt;Never use string concatenation to build SQL statements&lt;/li&gt;
&lt;li&gt;Use parameterised stored procedures or other functions for database access&lt;/li&gt;
&lt;li&gt;Use least privileged accounts to connect to the database&lt;/li&gt;
&lt;li&gt;Remove access to all user defined tables and grant access only to stored procedures&lt;/li&gt;
&lt;/ul&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/course/Security-Concepts/</guid>
            <title>Security Concepts</title>
            <link>http://example.com/course/Security-Concepts/</link>
            <category>software security</category>
            <pubDate>Wed, 30 Oct 2024 10:32:09 +1000</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34; Computer Security Concepts&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;# Computer Security Concepts&#34;&gt;#&lt;/a&gt; Computer Security Concepts &lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;A Definition of Computer Security&lt;br&gt;
Computer Security is the protection afforded to an automated information system in order to attain the applicable objectives of preserving the &lt;strong&gt;integrity&lt;/strong&gt;, &lt;strong&gt;availability&lt;/strong&gt;, and &lt;strong&gt;confidentiality&lt;/strong&gt; of information system resources (includes hardware, software, firmware, information/data, and telecommunications)
&lt;ul&gt;
&lt;li&gt;Confidentiality&lt;br&gt;
&lt;strong&gt;Data confidentiality&lt;/strong&gt; assures that private or confidential information is not made available or disclosed to unauthorised individuals&lt;br&gt;
&lt;strong&gt;Privacy&lt;/strong&gt; assures that individuals control or influence what information related to them may be collected and stored and by whom and to whom that information may be disclosed&lt;/li&gt;
&lt;li&gt;Integrity&lt;br&gt;
&lt;strong&gt;Data integrity&lt;/strong&gt; assures that information and programs are changed only in a specified and authorised manner&lt;br&gt;
&lt;strong&gt;System integrity&lt;/strong&gt; assures that a system performs its intended function in an unimpaired manner, free from deliberate or inadvertent unauthorised manipulation of the system&lt;/li&gt;
&lt;li&gt;Availability&lt;br&gt;
&lt;strong&gt;Availability assures&lt;/strong&gt; that systems work promptly and service is not denied to authorised users&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;CIA Triad (NIST standard FIPS 199)&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Confidentiality&lt;/strong&gt; preserves authorised restrictions on information access and disclosure, including means for protecting personal privacy and proprietary information
&lt;ul&gt;
&lt;li&gt;A loss of confidentiality is the unauthorised disclosure of information&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Integrity&lt;/strong&gt; guards against improper information modification or destruction, including ensuring information nonrepudiation and authenticity
&lt;ul&gt;
&lt;li&gt;A loss of integrity is the unauthorised modification or destruction of information&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Availability&lt;/strong&gt; ensures timely and reliable access to and use of information
&lt;ul&gt;
&lt;li&gt;A loss of availability is the disruption of access to or use of information or a system&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Additional Concepts
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Authenticity&lt;/strong&gt; is the property of being genuine and being able to be verified and trusted; confidence in the validity of a transmission, a message, or message originator (çœŸå®žæ€§ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Accountability&lt;/strong&gt; is the security goal that generates the requirement for actions of an entity to be traced uniquely to that entityï¼ˆå¯è¿½æº¯æ€§ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;NIST Levels of Security Impact&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Low&lt;/strong&gt; when the loss is expected to have a limited adverse effect. E.g. reduced effectiveness, minor damage, financial loss or harm&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Moderate&lt;/strong&gt; when the loss is expected to have a serious adverse effect. E.g. Significant reduced effectiveness, damage, financial loss or harm (but does not involve loss of life or serious injuries)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;High&lt;/strong&gt; when the loss is expected to have a severe or catastrophic adverse effect. E.g. unable to perform primary functions, major damage, and financial loss, involve loss of life or serious injuries&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;CIA Triad Examples&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Confidentiality&lt;br&gt;
High: student grades&lt;br&gt;
Moderate: enrolment information&lt;br&gt;
Low: faculty directory information&lt;/li&gt;
&lt;li&gt;Integrity&lt;br&gt;
High: patient allergy information&lt;br&gt;
Moderate: web site like online forums&lt;br&gt;
Low: anonymous online poll&lt;/li&gt;
&lt;li&gt;Availability&lt;br&gt;
High: authentication services&lt;br&gt;
Moderate: public web site for a university&lt;br&gt;
Low: online telephone directory lookup application&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;Computer Security Terminology&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Adversary&lt;/strong&gt; (threat agent) is an entity that attacks, or is a threat to, a system&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Attack&lt;/strong&gt; is an assault on system security that derives from an intelligent threat; that is, an intelligent act that is a deliberate attempt (especially in the sense of a method or technique) to evade security services and violate the security policy of a system&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Countermeasure&lt;/strong&gt; is an action, device, procedure, or technique that reduces a threat, a vulnerability, or an attack by eliminating or preventing it, by minimising the harm it can cause, or by discovering and reporting it so that corrective action can be taken&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Risk&lt;/strong&gt; is an expectation of loss expressed as the probability that a particular threat will exploit a particular vulnerability with a particular harmful result&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Security Policy&lt;/strong&gt; is the set of rules and practices that specify or regulate how a system or organisation provides security services to protect sensitive and critical system resources&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;System Resource (Asset)&lt;/strong&gt; is the data contained in an information system; or a service provided by a system; or a system capability, such as processing power or communication bandwidth; or an item of system equipment; or a facility that houses system operations and equipment&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Threat&lt;/strong&gt; is a potential for violation of security, which exists when there is a circumstance, capability, action, or event, that could breach security and cause harm&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Vulnerability&lt;/strong&gt; is a flaw or weakness in a systemâ€™s design, implementation, or operation and management that could be exploited to violate the systemâ€™s security policy&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;Threats and Attacks&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Threats and Attacks&#34;&gt;#&lt;/a&gt; Threats and Attacks&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;Assets&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Hardware&lt;/strong&gt; includes computer systems and other data processing, data storage, and data communications devices&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Software&lt;/strong&gt; includes the operating system, system utilities, and applications&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Data&lt;/strong&gt; includes files and databases, as well as security-related data, such as password files&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Network&lt;/strong&gt; includes communication facilities such as local and wide area network communication links, bridges, routers, and so on&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Vulnerabilities&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;It can be corrupted, so that it does the wrong thing or gives wrong answers (Integrity)
&lt;ul&gt;
&lt;li&gt;E.g. stored data values may differ from what they should be because they have been improperly modified&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;It can become leaky (Confidentiality)
&lt;ul&gt;
&lt;li&gt;E.g. someone who should not have access to some or all of the information available through the network obtains such access&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;It can become unavailable or very slow (Availability)
&lt;ul&gt;
&lt;li&gt;E.g. using the system or network becomes impossible or impractical.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Threats&lt;br&gt;
An attack is a threat that is carried out and leads to threat consequence&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Types of attacks
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Active attack&lt;/strong&gt; attempts to alter system resources or affect their operation&lt;br&gt;
 ç¤ºä¾‹ï¼šç¯¡æ”¹æ•°æ®ã€ç ´åç³»ç»ŸåŠŸèƒ½ã€åˆ é™¤æ–‡ä»¶ã€æ‹’ç»æœåŠ¡æ”»å‡»ï¼ˆDoSï¼‰ç­‰ã€‚&lt;br&gt;
å½±å“ï¼šç›´æŽ¥å¯¹ç³»ç»Ÿèµ„æºè¿›è¡Œä¿®æ”¹æˆ–ç ´åï¼Œå¯¼è‡´ç³»ç»ŸåŠŸèƒ½å—æŸã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Passive attack&lt;/strong&gt; attempts to learn or make use of information from the system that does not affect system resources. Passive attacks are very difficult to detect because they do not involve any alteration of the data&lt;br&gt;
 ç¤ºä¾‹ï¼šæµé‡åˆ†æžã€æ•°æ®åŒ…å—…æŽ¢ã€è§£å¯†é€šä¿¡ç­‰ã€‚&lt;br&gt;
å½±å“ï¼šæ”»å‡»è€…ä¸ä¼šä¿®æ”¹ç³»ç»Ÿæˆ–æ•°æ®ï¼Œä½†å¯èƒ½ä¼šèŽ·å¾—æ•æ„Ÿä¿¡æ¯æˆ–é€šä¿¡å†…å®¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Origin of attacks
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Inside attack&lt;/strong&gt; is initiated by an entity inside the security perimeter&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Outside attack&lt;/strong&gt; is initiated from outside the perimeter&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;Threat Consequences&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Attacks that Cause Unauthorised Disclosure&lt;br&gt;
&lt;strong&gt;Unauthorised disclosure&lt;/strong&gt; is a circumstance or event whereby an entity gains&lt;br&gt;
access to data for which the entity is not authorised
&lt;ol&gt;
&lt;li&gt;ä¿¡æ¯æš´éœ²ï¼ˆExposureï¼‰&lt;br&gt;
å®šä¹‰ï¼šå½“å†…éƒ¨äººå‘˜æ•…æ„æˆ–æ— æ„é—´å°†æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚ä¿¡ç”¨å¡å·ï¼‰æ³„éœ²ç»™å¤–éƒ¨äººå‘˜æ—¶ï¼Œå°±ä¼šå‘ç”Ÿä¿¡æ¯æš´éœ²ã€‚&lt;br&gt;
ç¤ºä¾‹ï¼šç¤¾äº¤ç½‘ç«™æ„å¤–å°†ç”¨æˆ·çš„ä¿å¯†ä¿¡æ¯å‘å¸ƒåœ¨ç½‘é¡µä¸Šã€‚&lt;br&gt;
è§£é‡Šï¼šä¿¡æ¯æš´éœ²å¯ä»¥æ˜¯ç”±äºŽäººä¸ºé”™è¯¯æˆ–ç³»ç»Ÿé…ç½®ä¸å½“å¯¼è‡´çš„ï¼Œå¸¸è§äºŽæ•°æ®æ³„éœ²äº‹ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;æ‹¦æˆªï¼ˆInterceptionï¼‰&lt;br&gt;
å®šä¹‰ï¼šè¿™æ˜¯åŸºäºŽç½‘ç»œçš„æ”»å‡»ï¼Œé»‘å®¢é€šè¿‡ç½‘ç»œç›‘å¬èŽ·å–ç”µå­é‚®ä»¶æµé‡å’Œå…¶ä»–æ•°æ®ä¼ è¾“å†…å®¹ã€‚&lt;br&gt;
ç¤ºä¾‹ï¼šæ•°æ®åŒ…å—…æŽ¢ã€ç½‘ç»œæµé‡çªƒå¬ç­‰ã€‚&lt;br&gt;
è§£é‡Šï¼šæ‹¦æˆªæ”»å‡»é€šå¸¸é€šè¿‡ç½‘ç»œä¸­çš„ä¸­é—´äººæ”»å‡»ï¼ˆMITMï¼‰ã€ä¸å®‰å…¨çš„æ— çº¿è¿žæŽ¥æˆ–å…¶ä»–ç½‘ç»œæ¼æ´žæ¥å®žçŽ°ã€‚&lt;/li&gt;
&lt;li&gt;æŽ¨ç†ï¼ˆInferenceï¼‰&lt;br&gt;
å®šä¹‰ï¼šå½“æ”»å‡»è€…é€šè¿‡è§‚å¯Ÿç½‘ç»œæµé‡æ¨¡å¼æˆ–æ•°æ®åº“è®¿é—®æ¨¡å¼è€ŒèŽ·å¾—ä¿¡æ¯æ—¶ï¼Œå°±ä¼šå‘ç”ŸæŽ¨ç†æ”»å‡»ã€‚&lt;br&gt;
ç¤ºä¾‹ï¼šæµé‡åˆ†æžå¯ä»¥é€šè¿‡æ£€æµ‹æµé‡çš„æ¨¡å¼ã€æ—¶é—´æˆ–æ•°é‡æ¥æŽ¨æ–­ä¿¡æ¯çš„ç±»åž‹æˆ–å†…å®¹ã€‚&lt;br&gt;
è§£é‡Šï¼šæŽ¨ç†æ”»å‡»å¹¶ä¸éœ€è¦å®žé™…è®¿é—®æ•æ„Ÿä¿¡æ¯ï¼Œè€Œæ˜¯é€šè¿‡åˆ†æžå…ƒæ•°æ®æˆ–è¡Œä¸ºæ¨¡å¼æŽ¨æµ‹å‡ºä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;å…¥ä¾µï¼ˆIntrusionï¼‰&lt;br&gt;
å®šä¹‰ï¼šå½“æ”»å‡»è€…ç»•è¿‡ç³»ç»Ÿçš„è®¿é—®æŽ§åˆ¶ä¿æŠ¤ï¼ŒèŽ·å–å¯¹æ•æ„Ÿæ•°æ®çš„æœªç»æŽˆæƒè®¿é—®æ—¶ï¼Œå°±ä¼šå‘ç”Ÿå…¥ä¾µã€‚&lt;br&gt;
ç¤ºä¾‹ï¼šé€šè¿‡æ¼æ´žåˆ©ç”¨ã€æš´åŠ›ç ´è§£æˆ–èŽ·å–å‡­è¯ç»•è¿‡èº«ä»½éªŒè¯ã€‚&lt;br&gt;
è§£é‡Šï¼šå…¥ä¾µæ”»å‡»é€šå¸¸æ˜¯é€šè¿‡ç›´æŽ¥ç ´åç³»ç»Ÿé˜²çº¿æ¥è®¿é—®æˆ–çªƒå–æ•æ„Ÿä¿¡æ¯çš„ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Attacks that Cause Deception&lt;br&gt;
Deception is circumstance or event that may result in an authorised entity receiving false data and believing it to be true
&lt;ol&gt;
&lt;li&gt;ä¼ªè£…ï¼ˆMasqueradeï¼‰&lt;br&gt;
å®šä¹‰ï¼šä¼ªè£…æ˜¯æŒ‡æœªç»æŽˆæƒçš„ç”¨æˆ·é€šè¿‡å†’å……æŽˆæƒç”¨æˆ·æ¥è¯•å›¾è®¿é—®ç³»ç»Ÿã€‚&lt;br&gt;
è§£é‡Šï¼šä¼ªè£…æ”»å‡»ç ´åäº†ç³»ç»Ÿçš„èº«ä»½éªŒè¯æœºåˆ¶ï¼Œä½¿å¾—æ”»å‡»è€…èƒ½å¤Ÿä»¥åˆæ³•ç”¨æˆ·çš„èº«ä»½è¿›è¡Œæ“ä½œã€‚&lt;br&gt;
ç¤ºä¾‹ï¼š
&lt;ul&gt;
&lt;li&gt;æœªæŽˆæƒç”¨æˆ·èŽ·å–ä»–äººçš„ ID å’Œå¯†ç åŽå†’å……åˆæ³•ç”¨æˆ·ã€‚&lt;/li&gt;
&lt;li&gt;æ¶æ„è½¯ä»¶ä¼ªè£…æˆæŽˆæƒåº”ç”¨ç¨‹åºï¼ŒèŽ·å¾—å¯¹ç³»ç»Ÿçš„æœªç»æŽˆæƒçš„è®¿é—®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç¯¡æ”¹ï¼ˆFalsificationï¼‰&lt;br&gt;
å®šä¹‰ï¼šç¯¡æ”¹æ˜¯æŒ‡å¯¹æœ‰æ•ˆæ•°æ®è¿›è¡Œæ›´æ”¹æˆ–æ›¿æ¢ï¼Œæˆ–å°†è™šå‡æ•°æ®å¼•å…¥æ–‡ä»¶æˆ–æ•°æ®åº“ä¸­ã€‚&lt;br&gt;
è§£é‡Šï¼šç¯¡æ”¹æ”»å‡»æ¶‰åŠæ•°æ®çš„éžæ³•ä¿®æ”¹ï¼Œç ´åäº†ç³»ç»Ÿçš„ å®Œæ•´æ€§ï¼ˆIntegrityï¼‰ï¼Œå¯¼è‡´æ•°æ®ä¸å‡†ç¡®æˆ–ä¸å¯é ã€‚&lt;br&gt;
ç¤ºä¾‹ï¼š
&lt;ul&gt;
&lt;li&gt;å­¦ç”Ÿåœ¨å­¦æ ¡æ•°æ®åº“ä¸­ä¿®æ”¹è‡ªå·±çš„æˆç»©ã€‚&lt;/li&gt;
&lt;li&gt;é»‘å®¢æ›´æ”¹é‡‘èžäº¤æ˜“è®°å½•æˆ–æ›¿æ¢æ•°æ®åº“ä¸­çš„æ•æ„Ÿä¿¡æ¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å¦è®¤ï¼ˆRepudiationï¼‰&lt;br&gt;
å®šä¹‰ï¼šå¦è®¤æ˜¯æŒ‡ç”¨æˆ·å¦è®¤å‘é€æˆ–æŽ¥æ”¶æ•°æ®çš„è¡Œä¸ºã€‚&lt;br&gt;
è§£é‡Šï¼šå¦è®¤æ”»å‡»æ¶‰åŠé€šä¿¡æˆ–äº¤æ˜“çš„ä¸å¯å¦è®¤æ€§ï¼Œå½±å“äº†ç³»ç»Ÿçš„å¯é æ€§å’Œä¿¡ä»»æ€§ã€‚è¿™ç§æ”»å‡»é€šå¸¸éœ€è¦é€šè¿‡æ•°å­—ç­¾åã€æ—¥å¿—è®°å½•å’Œä¸å¯å¦è®¤æ€§åè®®è¿›è¡Œé˜²å¾¡ã€‚&lt;br&gt;
ç¤ºä¾‹ï¼š
&lt;ul&gt;
&lt;li&gt;ç”¨æˆ·å£°ç§°æ²¡æœ‰å‘é€æŸå°ç”µå­é‚®ä»¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Attacks that Cause Disruption&lt;br&gt;
Disruption is a circumstance or event that interrupts or prevents the correct operation of system services and functions
&lt;ol&gt;
&lt;li&gt;ç˜«ç—ªï¼ˆIncapacitationï¼‰&lt;br&gt;
å®šä¹‰ï¼šç˜«ç—ªæ˜¯ä¸€ç§é’ˆå¯¹ç³»ç»Ÿå¯ç”¨æ€§çš„æ”»å‡»ï¼Œå…¶ç›®çš„æ˜¯é€šè¿‡ç‰©ç†ç ´åæˆ–æ¶æ„è½¯ä»¶å¯¼è‡´ç³»ç»Ÿç¡¬ä»¶æˆ–æœåŠ¡å¤±æ•ˆã€‚&lt;br&gt;
è§£é‡Šï¼šæ”»å‡»è€…é€šè¿‡ç›´æŽ¥æŸåç¡¬ä»¶æˆ–åˆ©ç”¨æ¶æ„ä»£ç ä½¿ç³»ç»Ÿå…³é”®ç»„ä»¶æ— æ³•å·¥ä½œï¼Œå¯¼è‡´ç³»ç»Ÿæ— æ³•ä¸ºç”¨æˆ·æä¾›æ­£å¸¸çš„æœåŠ¡ã€‚è¿™ç±»æ”»å‡»ç ´åäº†ç³»ç»Ÿçš„ å¯ç”¨æ€§ï¼ˆAvailabilityï¼‰ã€‚&lt;br&gt;
ç¤ºä¾‹ï¼šç‰¹æ´›ä¼Šæœ¨é©¬ã€ç—…æ¯’æˆ–è •è™«å¯¼è‡´å…³é”®æœåŠ¡å¤±æ•ˆï¼Œæˆ–ä½¿å¾—ç³»ç»Ÿç¡¬ä»¶å´©æºƒï¼Œé˜»æ­¢åˆæ³•ç”¨æˆ·çš„æ­£å¸¸è®¿é—®ã€‚&lt;/li&gt;
&lt;li&gt;ç ´åï¼ˆCorruptionï¼‰&lt;br&gt;
å®šä¹‰ï¼šç ´åæ˜¯æŒ‡é€šè¿‡æ¶æ„è½¯ä»¶æ”¹å˜ç³»ç»Ÿèµ„æºæˆ–æœåŠ¡çš„æ­£å¸¸è¡Œä¸ºï¼Œä»Žè€Œä½¿ç³»ç»Ÿåœ¨éžé¢„æœŸæƒ…å†µä¸‹è¿è¡Œã€‚&lt;br&gt;
è§£é‡Šï¼šæ”»å‡»è€…é€šè¿‡ç¯¡æ”¹ç³»ç»Ÿçš„æ•°æ®ã€é…ç½®æˆ–åŠŸèƒ½ï¼Œä½¿å¾—ç³»ç»Ÿçš„è¡Œä¸ºä¸å†å¯é æˆ–å‡†ç¡®ã€‚è¿™ç§æ”»å‡»å½±å“äº†ç³»ç»Ÿçš„ å®Œæ•´æ€§ï¼ˆIntegrityï¼‰ï¼Œå¯¼è‡´æ•°æ®ä¸å¯ä¿¡æˆ–ç³»ç»ŸåŠŸèƒ½å—æŸã€‚&lt;br&gt;
ç¤ºä¾‹ï¼šé»‘å®¢æ¤å…¥åŽé—¨ç¨‹åºï¼Œä½¿å¾—ç³»ç»Ÿæä¾›äº†æœªæŽˆæƒçš„è®¿é—®ï¼Œæˆ–ç¯¡æ”¹äº†æ•°æ®åº“ä¸­çš„å…³é”®æ•°æ®ï¼Œå¯¼è‡´åº”ç”¨ç¨‹åºçš„è¡Œä¸ºå¼‚å¸¸ã€‚&lt;/li&gt;
&lt;li&gt;é˜»å¡žï¼ˆObstructionï¼‰&lt;br&gt;
å®šä¹‰ï¼šé˜»å¡žæ˜¯ä¸€ç§å¹²æ‰°é€šä¿¡çš„æ”»å‡»ï¼Œé€šè¿‡ç¦ç”¨é€šä¿¡é“¾è·¯æˆ–ç¯¡æ”¹é€šä¿¡æŽ§åˆ¶ä¿¡æ¯æ¥å½±å“ç³»ç»Ÿçš„æ­£å¸¸é€šä¿¡ã€‚&lt;br&gt;
è§£é‡Šï¼šæ”»å‡»è€…é€šè¿‡å‘é€å¤§é‡åžƒåœ¾æ•°æ®æˆ–ç¯¡æ”¹é€šä¿¡åè®®ï¼Œä½¿ç³»ç»Ÿçš„ç½‘ç»œæˆ–å¤„ç†èƒ½åŠ›è¿‡è½½ï¼Œä»Žè€Œå½±å“åˆæ³•ç”¨æˆ·çš„é€šä¿¡ã€‚è¿™ç§æ”»å‡»ç ´åäº†ç³»ç»Ÿçš„ å¯ç”¨æ€§ï¼ˆAvailabilityï¼‰ å’Œé€šä¿¡çš„æœ‰æ•ˆæ€§ã€‚&lt;br&gt;
ç¤ºä¾‹ï¼šæ”»å‡»è€…é€šè¿‡åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡æ”»å‡»ï¼ˆDDoSï¼‰è®©ç½‘ç»œæµé‡è¶…è½½ï¼Œå¯¼è‡´æ­£å¸¸çš„é€šä¿¡è¢«é˜»å¡žæˆ–å»¶è¿Ÿã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Attacks that Cause Usurpation&lt;br&gt;
Usurpation is a circumstance or event that results in control of system services or functions by an unauthorised entity
&lt;ol&gt;
&lt;li&gt;æŒªç”¨ï¼ˆMisappropriationï¼‰&lt;br&gt;
å®šä¹‰ï¼šæŒªç”¨æ˜¯æŒ‡æ”»å‡»è€…æœªç»æŽˆæƒä½¿ç”¨æˆ–ç›—ç”¨ç³»ç»Ÿèµ„æºæˆ–æœåŠ¡ã€‚&lt;br&gt;
è§£é‡Šï¼šæ”»å‡»è€…é€šè¿‡èŽ·å–æœªæŽˆæƒçš„è®¿é—®æƒé™ï¼Œåˆ©ç”¨ç³»ç»Ÿçš„èµ„æºæˆ–æœåŠ¡ï¼Œå¯èƒ½åŒ…æ‹¬ç½‘ç»œå¸¦å®½ã€è®¡ç®—èƒ½åŠ›ç­‰ã€‚è¿™ç§æ”»å‡»å¯¹ç³»ç»Ÿçš„ å¯ç”¨æ€§ï¼ˆAvailabilityï¼‰ å’Œèµ„æºçš„å…¬å¹³åˆ†é…æž„æˆå¨èƒã€‚&lt;br&gt;
ç¤ºä¾‹ï¼šåˆ†å¸ƒå¼æ‹’ç»æœåŠ¡ï¼ˆDDoSï¼‰æ”»å‡»ä½¿å¾—ç½‘ç»œèµ„æºè¢«è€—å°½ï¼Œå¯¼è‡´åˆæ³•ç”¨æˆ·æ— æ³•æ­£å¸¸ä½¿ç”¨æœåŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;æ»¥ç”¨ï¼ˆMisuseï¼‰&lt;br&gt;
å®šä¹‰ï¼šæ»¥ç”¨æ˜¯æŒ‡é€šè¿‡æ¶æ„é€»è¾‘æˆ–é»‘å®¢æ‰‹æ®µï¼Œä½¿ç³»ç»Ÿè¢«ç”¨äºŽéžæŽˆæƒçš„ç›®çš„æˆ–åç¦»å…¶æ­£å¸¸ç”¨é€”ã€‚&lt;br&gt;
è§£é‡Šï¼šæ”»å‡»è€…å¯èƒ½é€šè¿‡æ¤å…¥æ¶æ„è½¯ä»¶æˆ–èŽ·å¾—æœªæŽˆæƒçš„ç³»ç»Ÿè®¿é—®ï¼Œç¦ç”¨æˆ–ç»•è¿‡å®‰å…¨åŠŸèƒ½ï¼Œä½¿ç³»ç»Ÿæ— æ³•ä¿æŠ¤å…¶èµ„æºå’Œæ•°æ®çš„å®‰å…¨ã€‚è¿™ç§æ”»å‡»å½±å“ç³»ç»Ÿçš„ å®Œæ•´æ€§ï¼ˆIntegrityï¼‰ å’Œ å¯ç”¨æ€§ï¼ˆAvailabilityï¼‰ã€‚&lt;br&gt;
ç¤ºä¾‹ï¼šé»‘å®¢ç»•è¿‡å®‰å…¨æŽ§åˆ¶æŽªæ–½ï¼Œä½¿å¾—é˜²ç«å¢™è§„åˆ™è¢«ç¦ç”¨ï¼Œä»Žè€Œä½¿ç³»ç»Ÿæ˜“å—è¿›ä¸€æ­¥çš„æ”»å‡»ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;Threats and Assets&lt;/li&gt;
&lt;/ol&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Asset&lt;/th&gt;
&lt;th&gt;Availability&lt;/th&gt;
&lt;th&gt;Confidentiality&lt;/th&gt;
&lt;th&gt;Integrity&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Hardware&lt;/td&gt;
&lt;td&gt;Equipment is stolen or disabled, thus denying service&lt;/td&gt;
&lt;td&gt;An unencrypted HDD or CD/DVD is stolen&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Software&lt;/td&gt;
&lt;td&gt;Programs are deleted, denying access to users&lt;/td&gt;
&lt;td&gt;An unauthorised copy of software is made&lt;/td&gt;
&lt;td&gt;A working program is modified, either to cause it to fail during execution or to cause it to do some unintended task&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Data&lt;/td&gt;
&lt;td&gt;Files are deleted, denying access to users&lt;/td&gt;
&lt;td&gt;An unauthorised read of data is performed. An analysis of statistical data reveals underlying data&lt;/td&gt;
&lt;td&gt;Existing files are modified or new files are fabricated&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Network&lt;/td&gt;
&lt;td&gt;Messages are destroyed or deleted. Communication lines or networks are rendered unavailable&lt;/td&gt;
&lt;td&gt;Messages are read. The traffic pattern of messages is observed&lt;/td&gt;
&lt;td&gt;Messages are modified, delayed, reordered, or duplicated. False messages are fabricated&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol start=&#34;6&#34;&gt;
&lt;li&gt;Attack Surfaces
&lt;ol&gt;
&lt;li&gt;ç½‘ç»œæ”»å‡»é¢ (Network Attack Surface)&lt;br&gt;
 å®šä¹‰ï¼šç½‘ç»œæ”»å‡»é¢æ˜¯æŒ‡ä¼ä¸šç½‘ç»œã€å¹¿åŸŸç½‘æˆ–äº’è”ç½‘ä¸­çš„å„ç§æ¼æ´žï¼Œè¿™äº›æ¼æ´žå¯èƒ½è¢«æ”»å‡»è€…åˆ©ç”¨ã€‚&lt;br&gt;
è§£é‡Šï¼šæ”»å‡»è€…å¯èƒ½é€šè¿‡ç½‘ç»œå±‚çš„æ¼æ´žï¼Œå¦‚æœåŠ¡ä¸­æ–­ã€é€šä¿¡é“¾è·¯ç ´åç­‰ï¼Œæ¥å‘èµ·æ”»å‡»ã€‚&lt;br&gt;
ç¤ºä¾‹ï¼š
&lt;ul&gt;
&lt;li&gt;æ‹’ç»æœåŠ¡æ”»å‡» (DoS)ï¼šæ”»å‡»è€…åˆ©ç”¨å¤§é‡æ— æ•ˆè¯·æ±‚å ç”¨æœåŠ¡å™¨èµ„æºï¼Œå¯¼è‡´åˆæ³•ç”¨æˆ·æ— æ³•è®¿é—®æœåŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;é€šä¿¡é“¾è·¯ä¸­æ–­ï¼šé€šè¿‡ç‰©ç†æˆ–ç½‘ç»œæ‰‹æ®µç ´åé€šä¿¡é“¾è·¯ï¼Œä»Žè€Œé˜»æ­¢æˆ–å¹²æ‰°æ•°æ®ä¼ è¾“ã€‚&lt;br&gt;
å…¥ä¾µæ”»å‡»ï¼šæœªç»æŽˆæƒçš„ç”¨æˆ·é€šè¿‡ç½‘ç»œæ¼æ´žè¿›å…¥ç³»ç»Ÿï¼ŒèŽ·å–æˆ–ä¿®æ”¹æ•æ„Ÿä¿¡æ¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;è½¯ä»¶æ”»å‡»é¢ (Software Attack Surface)&lt;br&gt;
 å®šä¹‰ï¼šè½¯ä»¶æ”»å‡»é¢æ˜¯æŒ‡åº”ç”¨ç¨‹åºæˆ–æ“ä½œç³»ç»Ÿä»£ç ä¸­çš„æ¼æ´žã€‚&lt;br&gt;
è§£é‡Šï¼šæ­¤ç±»æ¼æ´žå¯èƒ½å­˜åœ¨äºŽç¨‹åºä»£ç ä¸­ï¼Œè¢«æ”»å‡»è€…åˆ©ç”¨æ¥æ‰§è¡ŒæœªæŽˆæƒçš„æ“ä½œæˆ–èŽ·å–ç³»ç»Ÿæƒé™ã€‚&lt;br&gt;
ç¤ºä¾‹ï¼š
&lt;ul&gt;
&lt;li&gt;Web æœåŠ¡å™¨è½¯ä»¶æ¼æ´žï¼šæ”»å‡»è€…é€šè¿‡æ³¨å…¥æ¶æ„ä»£ç ã€SQL æ³¨å…¥æˆ–ç¼“å†²åŒºæº¢å‡ºæ¥èŽ·å–æœåŠ¡å™¨æŽ§åˆ¶æƒæˆ–è®¿é—®æ•æ„Ÿä¿¡æ¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;äººç±»æ”»å‡»é¢ (Human Attack Surface)&lt;br&gt;
 å®šä¹‰ï¼šäººç±»æ”»å‡»é¢æ˜¯æŒ‡ç”±äºŽäººå‘˜æˆ–å¤–éƒ¨äººå‘˜çš„è¡Œä¸ºæ‰€é€ æˆçš„æ¼æ´žã€‚&lt;br&gt;
è§£é‡Šï¼šæ”»å‡»è€…å¯ä»¥é€šè¿‡ç¤¾ä¼šå·¥ç¨‹ã€äººä¸ºé”™è¯¯æˆ–ä¿¡ä»»çš„å†…éƒ¨äººå‘˜æ¥æ”»å‡»ç³»ç»Ÿã€‚&lt;br&gt;
ç¤ºä¾‹ï¼š
&lt;ul&gt;
&lt;li&gt;ç¤¾ä¼šå·¥ç¨‹ï¼šæ”»å‡»è€…é€šè¿‡ä¼ªè£…èº«ä»½æˆ–æ“çºµç”¨æˆ·æƒ…æ„Ÿæ¥éª—å–æ•æ„Ÿä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;äººä¸ºé”™è¯¯ï¼šå‘˜å·¥åœ¨å¤„ç†ä¿¡æ¯æ—¶çš„å¤±è¯¯å¯èƒ½ä¼šå¯¼è‡´æ•°æ®æ³„éœ²æˆ–ç³»ç»ŸæŸåã€‚&lt;/li&gt;
&lt;li&gt;ä¿¡ä»»çš„å†…éƒ¨äººå‘˜ï¼šæœ‰è®¿é—®æƒé™çš„å‘˜å·¥æˆ–åˆä½œä¼™ä¼´å¯èƒ½ä¼šæ¶æ„ä½¿ç”¨ä»–ä»¬çš„æƒé™æ¥èŽ·å–æœªæŽˆæƒçš„æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Security Implementation&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Prevention: it is an ideal security scheme is one in which no attack is successful. Although not practical in all cases, there are threats in which prevention is a reasonable goal&lt;/li&gt;
&lt;li&gt;Detection: if absolute protection is not feasible, it may be practical to detect security attacks&lt;/li&gt;
&lt;li&gt;Response: if an ongoing attack is detected, the system can respond to halt the attack and prevent further damage&lt;/li&gt;
&lt;li&gt;Recovery: if data integrity is compromised, a prior, correct copy of the data can be reloaded&lt;/li&gt;
&lt;/ul&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/course/Heap-buffer-overflow/</guid>
            <title>Heap buffer overflow</title>
            <link>http://example.com/course/Heap-buffer-overflow/</link>
            <category>C</category>
            <category>software security</category>
            <pubDate>Mon, 28 Oct 2024 21:57:22 +1000</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;Heap allocation&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Heap allocation&#34;&gt;#&lt;/a&gt;Heap allocation&lt;/h1&gt;
&lt;h2 id=&#34;Memory Allocation&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Memory Allocation&#34;&gt;#&lt;/a&gt;Memory Allocation&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Static memory&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Store global variables, permanent for the entire lifetime of the process&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Automatic memory&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Stack stores local variables, stackframes are added or removed for functional calls&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Dynamic memory&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Heap stores shared data structures in a large pool of memory&lt;/li&gt;
&lt;li&gt;Not allocated in contiguous order ç”±ç¨‹åºå‘˜ç®¡ç†&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;Stack Allocation&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Stack Allocation&#34;&gt;#&lt;/a&gt;Stack Allocation&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Stack is contiguous blocks of memory managed by OS&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Cannot be modified&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Stack grows and shrinks as functions are called and exited&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Usually has an upper bound, may raise exceptions&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Variables are allocated and freed automatically&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Only exist when the function that created them is active on the stack&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;Heap Allocation&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Heap Allocation&#34;&gt;#&lt;/a&gt;Heap Allocation&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Heap is noncontiguous blocks of memory managed by the programmer&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Can be modified programatically&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Heap is large and boundless, usually limited by only the physical memory available&lt;/li&gt;
&lt;li&gt;Variables are allocated and freed by using library functions or build-in language constructs&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;C calls standard library functions, e.g. malloc, realloc, calloc and free&lt;/li&gt;
&lt;li&gt;C++ also uses these functions, but adds build-in operators new and delete&lt;/li&gt;
&lt;li&gt;Pointers are required to access data on the heap&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Memory Allocation Example&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;lt;stdlib.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; x;  &lt;span class=&#34;comment&#34;&gt;// é™æ€å˜é‡ï¼Œå­˜å‚¨åœ¨é™æ€å†…å­˜åŒºï¼Œç”Ÿå‘½å‘¨æœŸä¸Žè¿›ç¨‹ç›¸åŒ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;type&#34;&gt;void&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; y;          &lt;span class=&#34;comment&#34;&gt;// æ ˆå˜é‡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; *str;      &lt;span class=&#34;comment&#34;&gt;// æŒ‡å‘å †å†…å­˜çš„æŒ‡é’ˆ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     y = &lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;stack memory: %d\n&amp;quot;&lt;/span&gt;, y);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;comment&#34;&gt;// åˆ†é… 100 ä¸ªå­—ç¬¦çš„å †å†…å­˜&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     str = &lt;span class=&#34;built_in&#34;&gt;malloc&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;100&lt;/span&gt; * &lt;span class=&#34;keyword&#34;&gt;sizeof&lt;/span&gt;(&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     str[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;] = &lt;span class=&#34;string&#34;&gt;&amp;#x27;m&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;heap memory: %c\n&amp;quot;&lt;/span&gt;, str[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;comment&#34;&gt;// é‡Šæ”¾åˆ†é…çš„å †å†…å­˜&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;built_in&#34;&gt;free&lt;/span&gt;(str);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;  &lt;span class=&#34;comment&#34;&gt;// æ ˆä¸Šçš„å±€éƒ¨å˜é‡ y å’Œ str ä¼šåœ¨è¿™é‡Œè¢«è‡ªåŠ¨é‡Šæ”¾&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://img.picui.cn/free/2024/10/28/671f7e7bed371.png&#34; alt=&#34;img&#34;&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;Stack&lt;/th&gt;
&lt;th&gt;Heap&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Basic&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Memory is allocated in a contiguous block&lt;/td&gt;
&lt;td&gt;Memory is allocated in any random order&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Allocation and Deallocation&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Automatic by compiler instructions&lt;/td&gt;
&lt;td&gt;Manual by programmer&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Cost&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Less&lt;/td&gt;
&lt;td&gt;More&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Implementation&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Hard&lt;/td&gt;
&lt;td&gt;Easy&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Access time&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Faster&lt;/td&gt;
&lt;td&gt;Slower&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Main Issue&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Shortage of memory&lt;/td&gt;
&lt;td&gt;Memory fragmentation&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Locality of reference&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Excellent&lt;/td&gt;
&lt;td&gt;Adequate&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Flexibility&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Fixed size&lt;/td&gt;
&lt;td&gt;Resizing is possible&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;Data type structure&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;Linear&lt;/td&gt;
&lt;td&gt;Hierarchical&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id=&#34;Heap buffer overflow&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Heap buffer overflow&#34;&gt;#&lt;/a&gt;Heap buffer overflow&lt;/h1&gt;
&lt;h2 id=&#34;Dereference&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Dereference&#34;&gt;#&lt;/a&gt;Dereference&lt;/h2&gt;
&lt;p&gt;Much harder to exploit heap overflows:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Heap memory is not flat or contiguous&lt;/li&gt;
&lt;li&gt;There is no return address saved on the heap&lt;/li&gt;
&lt;li&gt;The address to overwrite is hard to find&lt;/li&gt;
&lt;li&gt;General exploitation techniques manipulate the metadata used by memory allocator&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To read/write the value inside the memory address pointed to by the pointer&lt;/p&gt;
&lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Dereference a Pointer&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; x; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; *p; &lt;span class=&#34;comment&#34;&gt;// p æ˜¯ä¸€ä¸ªæŒ‡å‘æ•´æ•°çš„æŒ‡é’ˆ  *p is an integer&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; x = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;  &lt;span class=&#34;comment&#34;&gt;// x çŽ°åœ¨ç­‰äºŽ 0 &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; p = &amp;amp;x; &lt;span class=&#34;comment&#34;&gt;// p æŒ‡å‘ x çš„åœ°å€   now *p == 0, since *p == x&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; *p = &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;; &lt;span class=&#34;comment&#34;&gt;// ç›¸å½“äºŽ x = 1ï¼Œå› ä¸º p == &amp;amp;x&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	     &lt;span class=&#34;comment&#34;&gt;// çŽ°åœ¨ *p å’Œ x éƒ½ç­‰äºŽ 1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;A C-language structure is a basic data structure that holds multiple fields&lt;/p&gt;
&lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Dereference a Structure Pointer&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;MY_STRUCT&lt;/span&gt; &amp;#123;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; my_int; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;type&#34;&gt;float&lt;/span&gt; my_float; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125; MY_STRUCT_T; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; MY_STRUCT_T info = &amp;#123;&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;3.141593F&lt;/span&gt;&amp;#125;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; MY_STRUCT_T *instance = &amp;amp;info; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; a = info.my_int;        &lt;span class=&#34;comment&#34;&gt;// ä½¿ç”¨ &amp;#x27;.&amp;#x27; æ“ä½œç¬¦é€‰æ‹©å­—æ®µ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; b = (*instance).my_int; &lt;span class=&#34;comment&#34;&gt;// è§£å¼•ç”¨åŽé€‰æ‹©å­—æ®µ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; c = instance-&amp;gt;my_int;   &lt;span class=&#34;comment&#34;&gt;// &amp;#x27;-&amp;gt;&amp;#x27; æ˜¯å‰ä¸€ç§æƒ…å†µçš„è¯­æ³•ç³–&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;è®¿é—®ç»“æž„ä½“å­—æ®µçš„ä¸‰ç§æ–¹å¼ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;info.my_int&lt;/code&gt; ï¼šä½¿ç”¨  &lt;code&gt;.&lt;/code&gt;  æ“ä½œç¬¦ç›´æŽ¥è®¿é—®ç»“æž„ä½“å˜é‡  &lt;code&gt;info&lt;/code&gt;  ä¸­çš„å­—æ®µ  &lt;code&gt;my_int&lt;/code&gt; ã€‚è¿™æ˜¯æœ€ç®€å•çš„è®¿é—®æ–¹å¼ï¼Œå› ä¸º  &lt;code&gt;info&lt;/code&gt;  æ˜¯ç»“æž„ä½“å˜é‡ï¼Œä¸æ˜¯æŒ‡é’ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;*instance&lt;/code&gt; ï¼šè§£å¼•ç”¨æŒ‡é’ˆ  &lt;code&gt;instance&lt;/code&gt; ï¼ŒèŽ·å–å®ƒæŒ‡å‘çš„ç»“æž„ä½“  &lt;code&gt;info&lt;/code&gt; ã€‚ &lt;code&gt;(*instance)&lt;/code&gt;  ä»£è¡¨ç»“æž„ä½“æœ¬èº«ã€‚&lt;br&gt;
 &lt;code&gt;(*instance).my_int&lt;/code&gt; ï¼šåœ¨è§£å¼•ç”¨åŽä½¿ç”¨ &lt;code&gt;.&lt;/code&gt;  æ“ä½œç¬¦è®¿é—®ç»“æž„ä½“å­—æ®µ  &lt;code&gt;my_int&lt;/code&gt; ã€‚è¿™ç§æ–¹å¼ç›¸å½“äºŽå¯¹ info å˜é‡çš„ç›´æŽ¥è®¿é—®ï¼Œåªä¸è¿‡æ˜¯é€šè¿‡æŒ‡é’ˆæ¥å®Œæˆçš„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;instance-&amp;gt;my_int&lt;/code&gt; ï¼š &lt;code&gt;-&amp;gt;&lt;/code&gt;  æ˜¯ä¸€ç§ç®€ä¾¿å†™æ³•ï¼ˆè¯­æ³•ç³–ï¼‰ï¼Œç”¨äºŽè®¿é—®æŒ‡é’ˆæŒ‡å‘çš„ç»“æž„ä½“çš„å­—æ®µã€‚è¿™ç›¸å½“äºŽ  &lt;code&gt;(*instance).my_int&lt;/code&gt; ï¼Œä½†å†™æ³•æ›´åŠ ç®€æ´ã€‚ &lt;code&gt;-&amp;gt;&lt;/code&gt;  åªèƒ½ç”¨äºŽæŒ‡é’ˆï¼Œè€Œ  &lt;code&gt;.&lt;/code&gt;  ç”¨äºŽç›´æŽ¥çš„ç»“æž„ä½“å˜é‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;Heap Overflow&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Heap Overflow&#34;&gt;#&lt;/a&gt;Heap Overflow&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Simple Heap Overflow&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Simple Heap Overflow&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;lt;stdlib.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;keyword&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;target&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; buf[&lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;];        &lt;span class=&#34;comment&#34;&gt;// æ˜“å—æ”»å‡»çš„ç¼“å†²åŒº&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;type&#34;&gt;void&lt;/span&gt; (*fun)(&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; *);  &lt;span class=&#34;comment&#34;&gt;// å‡½æ•°æŒ‡é’ˆ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125; &lt;span class=&#34;type&#34;&gt;target_t&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;type&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;foo&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; *buf)&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;comment&#34;&gt;// ç›®æ ‡å‡½æ•°ï¼Œå¯èƒ½è¢«æ”»å‡»è€…æŽ§åˆ¶çš„æ•°æ®æ›¿æ¢&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; argc, &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; *argv[])&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;type&#34;&gt;target_t&lt;/span&gt; *rec = &lt;span class=&#34;built_in&#34;&gt;malloc&lt;/span&gt;(&lt;span class=&#34;keyword&#34;&gt;sizeof&lt;/span&gt;(&lt;span class=&#34;type&#34;&gt;target_t&lt;/span&gt;)); &lt;span class=&#34;comment&#34;&gt;// åŠ¨æ€åˆ†é…ç»“æž„ä½“å†…å­˜&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     rec-&amp;gt;fun = foo; &lt;span class=&#34;comment&#34;&gt;// å°†å‡½æ•°æŒ‡é’ˆåˆå§‹åŒ–ä¸º foo&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     gets(rec-&amp;gt;buf); &lt;span class=&#34;comment&#34;&gt;// æ˜“å—æ”»å‡»çš„å‡½æ•°ï¼Œå¯èƒ½å¯¼è‡´ç¼“å†²åŒºæº¢å‡º&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     rec-&amp;gt;fun(&lt;span class=&#34;string&#34;&gt;&amp;quot;test&amp;quot;&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;// è°ƒç”¨å‡½æ•°æŒ‡é’ˆ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;ç»“æž„ä½“å®šä¹‰&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;typedef&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;target&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; buf[&lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;];        &lt;span class=&#34;comment&#34;&gt;// ç¼“å†²åŒº&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;type&#34;&gt;void&lt;/span&gt; (*fun)(&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; *);  &lt;span class=&#34;comment&#34;&gt;// å‡½æ•°æŒ‡é’ˆ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125; &lt;span class=&#34;type&#34;&gt;target_t&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ç»“æž„ä½“  &lt;code&gt;target&lt;/code&gt;  åŒ…å«ä¸¤ä¸ªå­—æ®µï¼š&lt;br&gt;
 &lt;code&gt;buf&lt;/code&gt; ï¼šä¸€ä¸ªå¤§å°ä¸º 100 å­—èŠ‚çš„å­—ç¬¦æ•°ç»„ï¼Œæ˜¯æ˜“å—æ”»å‡»çš„ç¼“å†²åŒºã€‚&lt;br&gt;
 &lt;code&gt;fun&lt;/code&gt; ï¼šä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼ŒæŒ‡å‘æŽ¥å—ä¸€ä¸ªå­—ç¬¦æŒ‡é’ˆå‚æ•°çš„å‡½æ•°ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¼“å†²åŒºæº¢å‡º&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;gets(rec-&amp;gt;buf);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;code&gt;gets()&lt;/code&gt;  æ˜¯ä¸€ä¸ªå±é™©çš„å‡½æ•°ï¼Œå®ƒä»Žæ ‡å‡†è¾“å…¥è¯»å–æ•°æ®å¹¶å­˜å‚¨åˆ°æŒ‡å®šçš„ç¼“å†²åŒº  &lt;code&gt;buf&lt;/code&gt;  ä¸­ã€‚&lt;br&gt;
 &lt;code&gt;gets()&lt;/code&gt;  ä¸ä¼šæ£€æŸ¥è¾“å…¥æ•°æ®çš„é•¿åº¦ï¼Œå¦‚æžœè¾“å…¥è¶…è¿‡äº†  &lt;code&gt;buf&lt;/code&gt;  çš„ 100 å­—èŠ‚å¤§å°é™åˆ¶ï¼Œå°±ä¼šå¯¼è‡´ç¼“å†²åŒºæº¢å‡ºã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åˆ©ç”¨å †æº¢å‡º&lt;br&gt;
å½“æ”»å‡»è€…æä¾›çš„è¾“å…¥é•¿åº¦è¶…è¿‡ 100 å­—èŠ‚æ—¶ï¼Œè¶…å‡ºçš„æ•°æ®å°†ä¼šè¦†ç›–  &lt;code&gt;fun&lt;/code&gt;  å‡½æ•°æŒ‡é’ˆã€‚&lt;br&gt;
æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ç§æƒ…å†µï¼Œå°†  &lt;code&gt;fun&lt;/code&gt;  æŒ‡é’ˆé‡å†™ä¸ºæ”»å‡»è€…æŽ§åˆ¶çš„åœ°å€ï¼Œä»Žè€Œåœ¨ç¨‹åºä¸­æ‰§è¡Œä»»æ„ä»£ç ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Difficult to Overwrite Non-Contiguous Memory&lt;br&gt;
Heap buffers are not adjacent, there may some extra space&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;It may be possible to calculate the extra space to craft an exploit&lt;/li&gt;
&lt;li&gt;But the exploit will be application-specific!
&lt;ol&gt;
&lt;li&gt;å †å†…å­˜çš„åˆ†æ•£æ€§
&lt;ul&gt;
&lt;li&gt;å †ä¸Šçš„ç¼“å†²åŒºå¹¶ä¸æ€»æ˜¯ç›¸é‚»çš„ï¼Œå› ä¸ºå®ƒä»¬æ ¹æ®å†…å­˜åˆ†é…å™¨çš„ç­–ç•¥è¿›è¡Œåˆ†é…ã€‚&lt;/li&gt;
&lt;li&gt;ä¸åŒåˆ†é…ä¹‹é—´å¯èƒ½å­˜åœ¨ç©ºéš™ï¼ˆpaddingï¼‰æˆ–å…ƒæ•°æ®ï¼ˆmetadataï¼‰ï¼Œä½¿å¾—ç›´æŽ¥è¦†ç›–éžè¿žç»­å†…å­˜å˜å¾—å›°éš¾ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å†…å­˜åˆ†é…å™¨çš„å…ƒæ•°æ®
&lt;ul&gt;
&lt;li&gt;å †å†…å­˜ä¸­åˆ†é…çš„æ¯ä¸ªå—é€šå¸¸å¸¦æœ‰å…ƒæ•°æ®ï¼ˆå¦‚å¤§å°ã€çŠ¶æ€ã€æŒ‡å‘ä¸‹ä¸€ä¸ªå—çš„æŒ‡é’ˆç­‰ï¼‰ï¼Œç”¨äºŽç®¡ç†å†…å­˜å—çš„åˆ†é…å’Œé‡Šæ”¾ã€‚&lt;/li&gt;
&lt;li&gt;æ”»å‡»è€…åœ¨è¯•å›¾è¦†ç›–éžè¿žç»­å†…å­˜æ—¶ï¼Œè¿˜éœ€è¦è€ƒè™‘è¿™äº›å…ƒæ•°æ®çš„å­˜åœ¨ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´åˆ†é…å™¨å´©æºƒæˆ–å¼‚å¸¸ï¼Œæš´éœ²æ”»å‡»çš„ç—•è¿¹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;Heap Allocator&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Heap Allocator&#34;&gt;#&lt;/a&gt;Heap Allocator&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;How heap memory is allocated?&lt;br&gt;
Heap allocator maintains a &lt;strong&gt;doubly-linked list&lt;/strong&gt; of allocated and free chunks (blocks of memory)
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;malloc()&lt;/code&gt;  and  &lt;code&gt;free()&lt;/code&gt;  add or remove chunks from this list&lt;br&gt;
Chunk management information is stored together with user data in memory&lt;/li&gt;
&lt;li&gt;Writing data past the end of a chunk boundary may overwrite the management fields&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Chunk Record&lt;br&gt;
Heap blocks are C records (i.e. struct) that have a few fields along with the chunk of memory
&lt;ul&gt;
&lt;li&gt;fd: the pointer to the next block&lt;/li&gt;
&lt;li&gt;bk: the pointer to the previous block&lt;/li&gt;
&lt;li&gt;ps: the size of the previous chunk&lt;/li&gt;
&lt;li&gt;sz: the size of the current chunk&lt;/li&gt;
&lt;li&gt;Other fields such as free flag to indicate if the current chunk is in the freelis&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Unlink a Chunk&lt;br&gt;
 &lt;code&gt;free()&lt;/code&gt;  removes a chunk from allocated list&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img data-src=&#34;https://img.picui.cn/free/2024/10/28/671f8d584507c.png&#34; alt=&#34;img&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Unlink performs the following two writes on the listâ€™s fields:
&lt;ul&gt;
&lt;li&gt;chunk2â€&amp;gt;bkâ€&amp;gt;fd = chunk2â€&amp;gt;fd&lt;/li&gt;
&lt;li&gt;chunk2â€&amp;gt;fdâ€&amp;gt;bk = chunk2â€&amp;gt;bk&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;By overflowing  &lt;code&gt;chunk2&lt;/code&gt; , attacker can take control of  &lt;code&gt;chunk2â€&amp;gt;fd&lt;/code&gt;  and  &lt;code&gt;chunk2â€&amp;gt;bk&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Suppose the attacker wants to write  &lt;code&gt;value&lt;/code&gt;  to memory address  &lt;code&gt;addr&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;Attacker sets  &lt;code&gt;chunk2â€&amp;gt;fd&lt;/code&gt;  to be  &lt;code&gt;value&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Attacker sets  &lt;code&gt;chunk2â€&amp;gt;bk&lt;/code&gt;  to be  &lt;code&gt;(addr - offset_fd)&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;offset_fd&lt;/code&gt;  is the offset of the fd field in the record&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;The attacker can write arbitrary value to arbitrary memory address in this way&lt;/li&gt;
&lt;li&gt;The first unlink write achieves the attackerâ€™s goal:  &lt;code&gt;chunk2â€&amp;gt;bkâ€&amp;gt;fd = chunk2â€&amp;gt;fd&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;The first write effectively becomes:  &lt;code&gt;(addr - offset_fb)â€&amp;gt;fd = value&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;This is the same as  &lt;code&gt;*addr = value&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;Fields are selected by offsets&lt;/li&gt;
&lt;li&gt;&lt;code&gt;offset_fd&lt;/code&gt;  cancels out  &lt;code&gt;fd&lt;/code&gt; &lt;br&gt;
Attackers can use hundreds of writes to copy the shellcode into memory&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;Prevention&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Prevention&#34;&gt;#&lt;/a&gt;Prevention&lt;/h2&gt;
&lt;p&gt;Very hard to detect and prevent due to the dynamic nature of the heap&lt;br&gt;
Possible ways to protect against heap overflow&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Prevent execution of the payload by separating the code and data&lt;/li&gt;
&lt;li&gt;Introduce randomisation so the heap is not found at a fixed offset&lt;/li&gt;
&lt;li&gt;Introduce sanity checks into the heap allocator&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;Pointer-related heap errors &#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Pointer-related heap errors &#34;&gt;#&lt;/a&gt;Pointer-related heap errors &lt;/h1&gt;
&lt;h2 id=&#34;Use After Free&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Use After Free&#34;&gt;#&lt;/a&gt;Use After Free&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;A memory is accessed after it is freed (and re-allocated)
&lt;ul&gt;
&lt;li&gt;Can cause a program to crash, use unexpected values, or execute code&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Attackers may overwrite the re-allocated memory including metadata
&lt;ul&gt;
&lt;li&gt;May result in the same effect as some heap overflow vulnerabilities&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Use After Free Example&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; argc, &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; **argv)&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; *buf1, *buf2; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    buf1 = (&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; *)&lt;span class=&#34;built_in&#34;&gt;malloc&lt;/span&gt;(BUFSIZE1); &lt;span class=&#34;comment&#34;&gt;// ä¸º buf1 åˆ†é… BUFSIZE1 å¤§å°çš„å†…å­˜&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// é‡Šæ”¾ buf1ï¼Œä½¿å…¶åˆ†é…çš„å†…å­˜å¯è¢«é‡ç”¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;free&lt;/span&gt;(buf1); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// å¯èƒ½åœ¨ buf1 é‡Šæ”¾çš„å†…å­˜åŒºåŸŸå†…åˆ†é… buf2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    buf2 = (&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; *)&lt;span class=&#34;built_in&#34;&gt;malloc&lt;/span&gt;(BUFSIZE2); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// æ”»å‡»è€…å¯èƒ½ä¼šé€šè¿‡è¦†ç›– buf2 åŠå…¶å…ƒæ•°æ®æ¥åˆ©ç”¨æ¼æ´ž&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;strncpy&lt;/span&gt;(buf1, argv[&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;], BUFSIZE1&lt;span class=&#34;number&#34;&gt;-1&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// ...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Example Problems
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;free(buf1)&lt;/code&gt;  çš„å½±å“
&lt;ul&gt;
&lt;li&gt;å½“  &lt;code&gt;buf1&lt;/code&gt;  è¢«é‡Šæ”¾åŽï¼Œå…¶å¯¹åº”çš„å†…å­˜åŒºåŸŸå˜å¾—å¯ä¾›å†æ¬¡åˆ†é…ã€‚&lt;/li&gt;
&lt;li&gt;å› ä¸º  &lt;code&gt;free()&lt;/code&gt;  å¹¶ä¸ä¼šç«‹å³å°†å†…å­˜æ¸…é›¶æˆ–ä½¿æŒ‡é’ˆå¤±æ•ˆï¼Œæ‰€ä»¥  &lt;code&gt;buf1&lt;/code&gt;  ä»ç„¶æŒ‡å‘è¢«é‡Šæ”¾çš„å†…å­˜åŒºåŸŸã€‚&lt;/li&gt;
&lt;li&gt;åœ¨è¿™æ®µä»£ç ä¸­ï¼Œ &lt;code&gt;buf2&lt;/code&gt;  å¯èƒ½ä¼šè¢«åˆ†é…åˆ°  &lt;code&gt;buf1&lt;/code&gt;  é‡Šæ”¾çš„å†…å­˜åŒºåŸŸï¼ˆè¿™å–å†³äºŽå †åˆ†é…å™¨çš„å®žçŽ°å’Œå†…å­˜å¸ƒå±€ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;strncpy(buf1, argv[1], BUFSIZE1-1)&lt;/code&gt;  çš„é—®é¢˜
&lt;ul&gt;
&lt;li&gt;å³ä½¿  &lt;code&gt;buf1&lt;/code&gt;  å·²è¢«é‡Šæ”¾ï¼Œç¨‹åºä»ç„¶åœ¨æ­¤å¤„è¯•å›¾ä½¿ç”¨  &lt;code&gt;buf1&lt;/code&gt;  è¿›è¡Œå†™æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;ç”±äºŽ  &lt;code&gt;buf1&lt;/code&gt;  è¢«é‡Šæ”¾åŽå¯èƒ½è¢«  &lt;code&gt;buf2&lt;/code&gt;  é‡æ–°ä½¿ç”¨ï¼Œ &lt;code&gt;buf1&lt;/code&gt;  å’Œ  &lt;code&gt;buf2&lt;/code&gt;  å¯èƒ½æŒ‡å‘ç›¸åŒçš„å†…å­˜åŒºåŸŸã€‚è¿™æ„å‘³ç€é€šè¿‡  &lt;code&gt;strncpy()&lt;/code&gt;  å¯¹  &lt;code&gt;buf1&lt;/code&gt;  çš„å†™å…¥å¯èƒ½ä¼šå½±å“  &lt;code&gt;buf2&lt;/code&gt; ï¼Œç”šè‡³è¦†ç›–  &lt;code&gt;buf2&lt;/code&gt;  çš„å…ƒæ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;Double Free&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Double Free&#34;&gt;#&lt;/a&gt;Double Free&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;A memory address is freed (i.e.  &lt;code&gt;free()&lt;/code&gt; ) twice
&lt;ul&gt;
&lt;li&gt;Can also cause a program to crash, use unexpected values, or execute code&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Attackers may corrupt metadata of new memory allocated at the address
&lt;ul&gt;
&lt;li&gt;May also result in the same effect as some heap overflow vulnerabilities&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Double Free Example&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; argc, &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; **argv)&lt;/span&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; *buf1, *buf2; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    buf1 = (&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; *)&lt;span class=&#34;built_in&#34;&gt;malloc&lt;/span&gt;(BUFSIZE1);  &lt;span class=&#34;comment&#34;&gt;// ä¸º buf1 åˆ†é… BUFSIZE1 å¤§å°çš„å†…å­˜&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;free&lt;/span&gt;(buf1);  &lt;span class=&#34;comment&#34;&gt;// é‡Šæ”¾ buf1ï¼Œå†…å­˜å¯ä¾›é‡ç”¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// buf2 å¯èƒ½è¢«åˆ†é…åˆ° buf1 é‡Šæ”¾çš„å†…å­˜åŒºåŸŸ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    buf2 = (&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; *)&lt;span class=&#34;built_in&#34;&gt;malloc&lt;/span&gt;(BUFSIZE2);  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// buf2 å¯èƒ½åŒ…å«æ”»å‡»è€…æä¾›çš„æ•°æ®&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;strncpy&lt;/span&gt;(buf2, argv[&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;], BUFSIZE2&lt;span class=&#34;number&#34;&gt;-1&lt;/span&gt;);  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// buf1 è¢«å†æ¬¡é‡Šæ”¾ï¼ˆåŒé‡é‡Šæ”¾ï¼‰&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;free&lt;/span&gt;(buf1); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;// é‡Šæ”¾ buf2ï¼ˆä½¿ç”¨äº†å¯èƒ½è¢«æ”»å‡»è€…ä¿®æ”¹çš„å…ƒæ•°æ®ï¼‰&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;free&lt;/span&gt;(buf2);  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Example Problems
&lt;ol&gt;
&lt;li&gt;ç¬¬ä¸€æ¬¡é‡Šæ”¾  &lt;code&gt;buf1&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡  &lt;code&gt;free(buf1)&lt;/code&gt; ï¼Œ &lt;code&gt;buf1&lt;/code&gt;  æ‰€å ç”¨çš„å†…å­˜è¢«é‡Šæ”¾ï¼Œæˆä¸ºå¯ä¾›é‡ç”¨çš„å†…å­˜åŒºåŸŸã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;buf2&lt;/code&gt;  å¯èƒ½åˆ†é…åˆ°  &lt;code&gt;buf1&lt;/code&gt;  çš„å†…å­˜åŒºåŸŸ&lt;/li&gt;
&lt;li&gt;å› ä¸º  &lt;code&gt;buf1&lt;/code&gt;  å·²è¢«é‡Šæ”¾ï¼Œå†…å­˜åˆ†é…å™¨å¯èƒ½ä¼šå°†  &lt;code&gt;buf2&lt;/code&gt;  åˆ†é…åˆ°ä¹‹å‰  &lt;code&gt;buf1&lt;/code&gt;  å ç”¨çš„å†…å­˜åŒºåŸŸã€‚&lt;/li&gt;
&lt;li&gt;æ”»å‡»è€…å¯èƒ½é€šè¿‡è¦†ç›–  &lt;code&gt;buf2&lt;/code&gt;  ä¸­çš„å†…å®¹æ¥ä¿®æ”¹å…ƒæ•°æ®&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨  &lt;code&gt;strncpy()&lt;/code&gt;  å‡½æ•°å°†ç”¨æˆ·è¾“å…¥å¤åˆ¶åˆ°  &lt;code&gt;buf2&lt;/code&gt;  ä¸­ï¼Œè¿™å¯èƒ½å¯¼è‡´è¦†ç›–  &lt;code&gt;buf2&lt;/code&gt;  çš„å…ƒæ•°æ®ï¼ˆå¦‚å †é“¾è¡¨æŒ‡é’ˆæˆ–å…¶ä»–å…³é”®æ•°æ®ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç¬¬äºŒæ¬¡é‡Šæ”¾  &lt;code&gt;buf1&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;free(buf1)&lt;/code&gt;  å¯¼è‡´åŒé‡é‡Šæ”¾ï¼Œå› ä¸º  &lt;code&gt;buf1&lt;/code&gt;  å·²ç»åœ¨ç¬¬ä¸€æ¬¡é‡Šæ”¾åŽè¢«é‡ç”¨ï¼ŒçŽ°åœ¨ä¸Ž  &lt;code&gt;buf2&lt;/code&gt;  æŒ‡å‘ç›¸åŒçš„å†…å­˜åŒºåŸŸã€‚&lt;/li&gt;
&lt;li&gt;æ­¤æ—¶ï¼Œå†…å­˜åˆ†é…å™¨å¯èƒ½ä¼šä½¿ç”¨è¢«æ”»å‡»è€…ä¿®æ”¹çš„å…ƒæ•°æ®ï¼Œä»Žè€Œå¯¼è‡´ä¸å®‰å…¨çš„å†…å­˜æ“ä½œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;é‡Šæ”¾  &lt;code&gt;buf2&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;å½“  &lt;code&gt;buf2&lt;/code&gt;  è¢«é‡Šæ”¾æ—¶ï¼Œå†…å­˜åˆ†é…å™¨å¯èƒ½ä¼šå†æ¬¡å¤„ç†è¢«æ”»å‡»è€…ä¿®æ”¹çš„å…ƒæ•°æ®ï¼Œè¿›ä¸€æ­¥å¯¼è‡´å†…å­˜è¦†ç›–æˆ–å¼‚å¸¸ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;Prevention and Detection of Pointer Errors&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Prevention and Detection of Pointer Errors&#34;&gt;#&lt;/a&gt;Prevention and Detection of Pointer Errors&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Difficult to detect all of them by either dynamic or static analysis&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Complex runtime states&lt;/li&gt;
&lt;li&gt;E.g. memory may be allocated, freed and used in different functions via aliases (pointers)&lt;/li&gt;
&lt;li&gt;Fuzzing may detect some in executed paths when they crash the program&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;The simplest prevention is to set all freed pointers to NULL&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Trigger null pointer dereference errors when accessed&lt;/li&gt;
&lt;li&gt;Most operating systems provide built-in defence against null-pointer dereference&lt;/li&gt;
&lt;/ul&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/course/AFL/</guid>
            <title>AFL</title>
            <link>http://example.com/course/AFL/</link>
            <category>C</category>
            <category>software security</category>
            <category>AFL</category>
            <category>Linux</category>
            <pubDate>Mon, 28 Oct 2024 14:45:49 +1000</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;American Fuzzy Lop&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#American Fuzzy Lop&#34;&gt;#&lt;/a&gt; American Fuzzy Lop&lt;/h1&gt;
&lt;h2 id=&#34;Definition&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Definition&#34;&gt;#&lt;/a&gt;Definition&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;A security-oriented fuzzer that employs a novel type of compile-time instrumentation and genetic algorithms to automatically discover clean, interesting test cases that trigger new internal states in the targeted binary. Currently state-of-the-practice at fuzzing (together with forks)&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;A type of coverage-based fuzzing: Instrument target programs to track test coverage&lt;/li&gt;
&lt;li&gt;A type of evolutionary/genetic fuzzing: Attempt to generate inputs based on the response of the program&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Why AFL&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;The best general purpose fuzzer
&lt;ul&gt;
&lt;li&gt;For C/C++/Objective C programs&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Effective and well-engineered with lots of heuristics
&lt;ul&gt;
&lt;li&gt;Fast â€“ lots of test cases per second&lt;/li&gt;
&lt;li&gt;Clever â€“ test cases are well chosen&lt;/li&gt;
&lt;li&gt;Easy to use (Linux and other platforms)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Deliver out-of-the-box performance far superior to mutation fuzzing or coverage-only tools&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;AFL Approach
&lt;ol&gt;
&lt;li&gt;Load user-supplied initial test cases into the queue&lt;/li&gt;
&lt;li&gt;Take next input file from the queue&lt;/li&gt;
&lt;li&gt;Attempt to trim the test case to the smallest size&lt;/li&gt;
&lt;li&gt;Repeatedly mutate the file using traditional fuzzing strategies&lt;/li&gt;
&lt;li&gt;If any of the generated mutations resulted in a new state transition recorded by the instrumentation, add mutated output as a new entry in the queue&lt;/li&gt;
&lt;li&gt;Go to 2&lt;br&gt;
&lt;img data-src=&#34;https://img.picui.cn/free/2024/10/28/671f221b5c7ee.png&#34; alt=&#34;img&#34;&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;Fuzzing Through AFL&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Fuzzing Through AFL&#34;&gt;#&lt;/a&gt;Fuzzing Through AFL&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Instrumenting Programs for AFL&lt;br&gt;
Compile through AFL wrappers to generate an instrumented executable for fuzzing
&lt;ul&gt;
&lt;li&gt;Basically, replace  &lt;code&gt;gcc&lt;/code&gt;  with  &lt;code&gt;aflâ€gcc&lt;/code&gt;  or  &lt;code&gt;afl-clang&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;For simple compilation,  &lt;code&gt;aflâ€gcc test.c â€o test&lt;/code&gt; &lt;br&gt;
For larger projects that use the make build system, add to the Makefile:&lt;/li&gt;
&lt;li&gt;&lt;code&gt;CC=path-to/afl-gcc&lt;/code&gt;  or  &lt;code&gt;CC=path-to/afl-clang&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;This allows to build instrumented target program with the AFL wrappers&lt;br&gt;
For C++ code, use the C++ wrappers  &lt;code&gt;afl-g++&lt;/code&gt;  or  &lt;code&gt;afl-clang++&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;For example in the Makefile:  &lt;code&gt;CXX=path-to/afl-g++&lt;/code&gt;  or  &lt;code&gt;CXX=path-to/afl-clang++&lt;/code&gt; &lt;br&gt;
AFL ä¼šåœ¨ç¼–è¯‘æ—¶æ’è£…ç›®æ ‡ç¨‹åºçš„ä»£ç ï¼Œä»¥ä¾¿åœ¨æ‰§è¡ŒæœŸé—´è·Ÿè¸ªè·¯å¾„è¦†ç›–æƒ…å†µã€‚æ’è£…åŽçš„äºŒè¿›åˆ¶æ–‡ä»¶åŒ…å«å¯¹ &lt;code&gt; __afl_maybe_log&lt;/code&gt;  çš„è°ƒç”¨ï¼Œè¯¥å‡½æ•°è®°å½•ç¨‹åºçš„æ‰§è¡ŒçŠ¶æ€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Fuzzing Through AFL&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Start fuzzing with AFL   &lt;code&gt;aflâ€fuzz â€i testcase â€o output ./test @@&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Test cases are under testcase&lt;/li&gt;
&lt;li&gt;The output produced by  goes to the output directory&lt;/li&gt;
&lt;li&gt;The special symbols  &lt;code&gt;@@&lt;/code&gt;  tell AFL to take the file names under test case and feed it to test. Not needed if the program takes input from stdin&lt;/li&gt;
&lt;li&gt;Other common options:
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-t&lt;/code&gt;  sets timeout for the executed process&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-m&lt;/code&gt;  sets memory limit for the executed process&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Initial Test Cases&lt;br&gt;
Donâ€™t waste too much time trying to synthesise your targetâ€™s input format&lt;br&gt;
Find some real inputs that exercise as much of the target as possible&lt;br&gt;
From the AFL user guide:
&lt;ul&gt;
&lt;li&gt;Keep the files small. Under 1 kB is ideal, although not strictly necessary&lt;/li&gt;
&lt;li&gt;Use multiple test cases only if they are functionally different from each other&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;When To Stop&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Never, as fuzzing is part of continuous integration&lt;/li&gt;
&lt;li&gt;hen the  &lt;code&gt;cycles counter&lt;/code&gt;  is green
&lt;ul&gt;
&lt;li&gt;Last new path was found many cycles ago&lt;/li&gt;
&lt;li&gt;Pending paths is zero&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;When the cycles counter is blue
&lt;ul&gt;
&lt;li&gt;Last new path was found over a cycle ago&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;If you want to stop earlier, press Ctrl-C
&lt;ul&gt;
&lt;li&gt;E.g. itâ€™s been running for a while (hours + millions of executions + at least 2 cycles&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;AFL Output&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;File  &lt;code&gt;fuzzer_stats&lt;/code&gt;  provides summary of stats UI&lt;/li&gt;
&lt;li&gt;File  &lt;code&gt;plot_data&lt;/code&gt;  shows the progress of fuzzer&lt;/li&gt;
&lt;li&gt;Directory  &lt;code&gt;queue&lt;/code&gt;  shows inputs that led to paths&lt;/li&gt;
&lt;li&gt;Directory  &lt;code&gt;crashes&lt;/code&gt;  contains input that caused crash&lt;/li&gt;
&lt;li&gt;Directory  &lt;code&gt;hangs&lt;/code&gt;  contains input that caused hang&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;6&#34;&gt;
&lt;li&gt;AFL Crashes&lt;br&gt;
Unique if the associated execution paths involve any state transitions not seen previously. A single bug may be reached in multiple ways, but AFL can usually recognise&lt;br&gt;
Crashes may be caused by failed assertions - as they abort&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;Compiler-supported sanitizers&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Compiler-supported sanitizers&#34;&gt;#&lt;/a&gt;Compiler-supported sanitizers&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;Sanitisers å’ŒåŠ å›ºæŽªæ–½&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Sanitisersï¼ˆå†…å­˜æ¸…ç†å™¨ï¼‰ï¼šé€šè¿‡åœ¨äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ’å…¥é¢å¤–çš„ä»£ç ï¼Œæ£€æŸ¥ä¸è‰¯çš„è¿è¡Œæ¡ä»¶ã€‚æé«˜æ¨¡ç³Šæµ‹è¯•æ•ˆæžœã€‚&lt;/li&gt;
&lt;li&gt;Common compiler-supported sanitisers: ASan, MSan, UBSan, TSan&lt;/li&gt;
&lt;li&gt;åŠ å›ºé€‰é¡¹ï¼šä½¿å†…å­˜é”™è¯¯çš„æ£€æµ‹æ›´å®¹æ˜“ã€‚ &lt;code&gt;AFL_HARDEN=1&lt;/code&gt; ï¼šAFL çš„ç¡¬åŒ–é€‰é¡¹ï¼Œç”¨äºŽæ£€æµ‹æ›´å¤šçš„å†…å­˜é”™è¯¯ã€‚&lt;/li&gt;
&lt;li&gt;æ³¨æ„ï¼šSanitisers é€šå¸¸ä¸å…¼å®¹ï¼Œå› æ­¤å»ºè®®ï¼š
&lt;ul&gt;
&lt;li&gt;å¤§å¤šæ•°æ¨¡ç³Šæµ‹è¯•è¿è¡Œæ—¶å¯ç”¨  &lt;code&gt;AFL_HARDEN&lt;/code&gt; ã€‚&lt;/li&gt;
&lt;li&gt;å°éƒ¨åˆ†æµ‹è¯•è¿è¡Œæ—¶åˆ†åˆ«å¯ç”¨æ¯ä¸ª Sanitisersï¼Œä»¥è¦†ç›–ä¸åŒç±»åž‹çš„å†…å­˜é”™è¯¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;ASanï¼ˆAddress Sanitizerï¼‰Compile with  &lt;code&gt;-fsanitize=address&lt;/code&gt; &lt;br&gt;
 æ£€æµ‹å†…å®¹ï¼š
&lt;ul&gt;
&lt;li&gt;å †ã€æ ˆå’Œå…¨å±€å˜é‡çš„è¶Šç•Œè®¿é—®ã€‚&lt;/li&gt;
&lt;li&gt;Use-after-freeã€double-freeã€invalid freeã€‚&lt;/li&gt;
&lt;li&gt;å†…å­˜æ³„æ¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ€§èƒ½å½±å“ï¼šå¤§çº¦ 2 å€çš„è¿è¡Œæ—¶é—´å¼€é”€ã€‚&lt;/p&gt;
&lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;ASan Example1&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;define&lt;/span&gt; N 10 &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;type&#34;&gt;void&lt;/span&gt;)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; s[N] = &lt;span class=&#34;string&#34;&gt;&amp;quot;123456789&amp;quot;&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; i = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; i &amp;lt;= N; i++) &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;%c&amp;quot;&lt;/span&gt;, s[i]); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;\n&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Loop bound goes past the end of the array, cannot assess  &lt;code&gt;s[10]&lt;/code&gt;&lt;/p&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;ASan Example2&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;type&#34;&gt;void&lt;/span&gt;)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; *a = &lt;span class=&#34;built_in&#34;&gt;malloc&lt;/span&gt;(&lt;span class=&#34;keyword&#34;&gt;sizeof&lt;/span&gt;(&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt;) * &lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;built_in&#34;&gt;free&lt;/span&gt;(a); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; a[&lt;span class=&#34;number&#34;&gt;5&lt;/span&gt;]; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;The array is dereferenced after it is free&lt;/p&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;ASan Example3&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;type&#34;&gt;void&lt;/span&gt;)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; *s = &lt;span class=&#34;built_in&#34;&gt;malloc&lt;/span&gt;(&lt;span class=&#34;keyword&#34;&gt;sizeof&lt;/span&gt;(&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt;) * &lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;built_in&#34;&gt;free&lt;/span&gt;(s); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;built_in&#34;&gt;free&lt;/span&gt;(s);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;%s&amp;quot;&lt;/span&gt;, s);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;The array is double-freed&lt;/p&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;MSanï¼ˆMemory Sanitizerï¼‰ Compile with  &lt;code&gt;-fsanitize=memory&lt;/code&gt; &lt;br&gt;
 æ£€æµ‹æœªåˆå§‹åŒ–çš„å†…å­˜ä½¿ç”¨ã€‚&lt;br&gt;
æ€§èƒ½å½±å“ï¼šå¤§çº¦ 3 å€çš„è¿è¡Œæ—¶é—´å¼€é”€ã€‚&lt;/li&gt;
&lt;/ol&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;MSan Example1&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; argc, &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; **argv)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; a[&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;]; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     a[&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;] = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (a[argc]) &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         &lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;print something\n&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;The array is allocated on &lt;strong&gt;stack&lt;/strong&gt;, but only partially initialised&lt;/p&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;MSan Example2&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; argc, &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; **argv)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; a = &lt;span class=&#34;built_in&#34;&gt;malloc&lt;/span&gt;(&lt;span class=&#34;keyword&#34;&gt;sizeof&lt;/span&gt;(&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt;) * &lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     a[&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;] = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (a[argc]) &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         &lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;print something\n&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;built_in&#34;&gt;free&lt;/span&gt;(a); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;The array is allocated on &lt;strong&gt;heap&lt;/strong&gt;, but only partially initialised&lt;/p&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;UBSanï¼ˆUndefined Behavior Sanitizerï¼‰ Compile with  &lt;code&gt;-fsanitize=undefined&lt;/code&gt; &lt;br&gt;
 æ£€æµ‹ï¼š
&lt;ul&gt;
&lt;li&gt;è§£å¼•ç”¨ç©ºæŒ‡é’ˆã€‚&lt;/li&gt;
&lt;li&gt;æœ‰ç¬¦å·æ•´æ•°æº¢å‡ºã€‚&lt;br&gt;
æ€§èƒ½å½±å“ï¼šå¤§çº¦ 20% çš„è¿è¡Œæ—¶é—´å¼€é”€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;UBSan Example1&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;type&#34;&gt;void&lt;/span&gt;)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; n = &lt;span class=&#34;number&#34;&gt;65&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; m = n / (n - n); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Division-by-zero is undefined&lt;/p&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;UBSan Example2&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;foo&lt;/span&gt; &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;class&#34;&gt; &amp;#123;&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; a, b; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;type&#34;&gt;void&lt;/span&gt;)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;foo&lt;/span&gt; *&lt;span class=&#34;title&#34;&gt;x&lt;/span&gt; =&lt;/span&gt; &lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; m = x-&amp;gt;a;  &lt;span class=&#34;comment&#34;&gt;// è®¿é—®ç©ºæŒ‡é’ˆ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Accessing a null pointer is undefined&lt;/p&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;TSanï¼ˆThread Sanitizerï¼‰&lt;br&gt;
æ£€æµ‹æ•°æ®ç«žäº‰ï¼ˆdata racesï¼‰ã€‚&lt;br&gt;
æ€§èƒ½å½±å“ï¼šè¿è¡Œæ—¶é—´å¼€é”€çº¦ä¸º 5-15 å€ï¼Œå†…å­˜å¼€é”€çº¦ä¸º 5-10 å€ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;Others&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Others&#34;&gt;#&lt;/a&gt;Others&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Parallel Fuzzing(High performance fuzzing)&lt;br&gt;
Run concurrent fuzzing jobs on multicore systems&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;One master instance, one slave per core&lt;/li&gt;
&lt;li&gt;Use the afl-gotcpu tool to measure per-core pre-emption rate&lt;br&gt;
Run the master (-M) like this:&lt;/li&gt;
&lt;li&gt;&lt;code&gt;./afl-fuzz -i testcase_dir -o sync_dir -M fuzzer01&lt;/code&gt; &lt;br&gt;
Then, run the slaves (-S) instances like this:&lt;/li&gt;
&lt;li&gt;&lt;code&gt;./afl-fuzz -i testcase_dir -o sync_dir -S fuzzer02&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;./afl-fuzz -i testcase_dir -o sync_dir -S fuzzer03&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Fuzzer Dictionaries(Improve fuzzer mutations)&lt;br&gt;
By default, AFL mutation engine is optimised for compact data formats&lt;br&gt;
Custom dictionaries can help the fuzzer access paths it otherwise wouldnâ€™t  &lt;code&gt;afl-fuzz -x mydict&lt;/code&gt; &lt;br&gt;
Get them from:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;dictionaries&lt;/code&gt;  directory in AFL&lt;/li&gt;
&lt;li&gt;&lt;code&gt;libtokencap&lt;/code&gt;  directory in AFL
&lt;ul&gt;
&lt;li&gt;Create a dictionary by intercepting calls like  &lt;code&gt;strcmp&lt;/code&gt;  and  &lt;code&gt;memcmp&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9jaHJvbWl1bS5nb29nbGVzb3VyY2UuY29tL2Nocm9taXVtL3NyYy8rL21hc3Rlci90ZXN0aW5nL2xpYmZ1enplci9mdXp6ZXJzL2RpY3Rz&#34;&gt;Online resource&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Limitations of Fuzzing&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Hard to tell when to stop&lt;/li&gt;
&lt;li&gt;Test the target in the exact configuration you provided, on the input source you set up&lt;/li&gt;
&lt;li&gt;Can get stuck (e.g. checksums)&lt;/li&gt;
&lt;li&gt;Crashes only (typical of most fuzzers). Only notice problems that can be automatically detected&lt;/li&gt;
&lt;li&gt;Need to build target from source&lt;/li&gt;
&lt;li&gt;stdin or file input only&lt;/li&gt;
&lt;li&gt;Coverage-based instrumentation wonâ€™t guide it towards all crashes
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;x = 1/(input â€“ 1234)&lt;/code&gt;  ï¼šåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒAFL å¯èƒ½éš¾ä»¥æ‰¾åˆ°è¾“å…¥ 1234ï¼Œä»Žè€Œå¯¼è‡´æ— æ³•æ£€æµ‹åˆ°é™¤é›¶é”™è¯¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;No automatic parallelisation&lt;/li&gt;
&lt;li&gt;Linux/macOS only&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;libFuzzer: Guided Fuzzing for APIs&lt;br&gt;
The other top general purpose fuzzer
&lt;ul&gt;
&lt;li&gt;Use similar algorithms to AFL&lt;/li&gt;
&lt;li&gt;Build it with special compiler instrumentation (LLVM)&lt;br&gt;
Targets functions rather than programs&lt;/li&gt;
&lt;li&gt;Testers have to write a harness&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/course/Fuzz-testing/</guid>
            <title>Fuzz testing</title>
            <link>http://example.com/course/Fuzz-testing/</link>
            <category>software security</category>
            <pubDate>Sun, 27 Oct 2024 18:28:09 +1000</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;Software testing&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Software testing&#34;&gt;#&lt;/a&gt; Software testing&lt;/h1&gt;
&lt;h2 id=&#34;Definition&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Definition&#34;&gt;#&lt;/a&gt;Definition&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;The process of running a program to evaluate properties of interest&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Meet design requirements&lt;/li&gt;
&lt;li&gt;Produce correct results&lt;/li&gt;
&lt;li&gt;Perform within an acceptable time&lt;/li&gt;
&lt;li&gt;Reasonably usable&lt;/li&gt;
&lt;li&gt;Handle all inputs correctly&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Software Testing Steps&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;éªŒè¯ï¼ˆVerificationï¼‰ï¼šæˆ‘ä»¬æ˜¯å¦åœ¨æ­£ç¡®åœ°æž„å»ºäº§å“ï¼Ÿ&lt;br&gt;
ä»»åŠ¡é›†ç¡®ä¿è½¯ä»¶æ­£ç¡®åœ°å®žçŽ°äº†ç‰¹å®šåŠŸèƒ½ã€‚&lt;br&gt;
éªŒè¯çš„ç›®æ ‡æ˜¯ç¡®ä¿ç¨‹åºåœ¨æ‰€æœ‰å¯èƒ½çš„è¾“å…¥ä¸‹éƒ½èƒ½æ­£å¸¸å·¥ä½œã€‚&lt;/li&gt;
&lt;li&gt;ç¡®è®¤ï¼ˆValidationï¼‰ï¼šæˆ‘ä»¬æ˜¯å¦åœ¨æž„å»ºæ­£ç¡®çš„äº§å“ï¼Ÿ&lt;br&gt;
ä»»åŠ¡é›†ç¡®ä¿è½¯ä»¶ç¬¦åˆå®¢æˆ·éœ€æ±‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Test Oracles&lt;br&gt;
Software testing determines the correctness of software under the assumption of some specific hypotheses. Compares the state and behaviour of the product against test oracles.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img data-src=&#34;https://img.picui.cn/free/2024/10/27/671dfbadce67b.png&#34; alt=&#34;img&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;Types of Software Testing
&lt;ol&gt;
&lt;li&gt;Manual testing&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Without using any automated tool or any script&lt;/li&gt;
&lt;li&gt;E.g. unit testing, integration testing, system testing, user experience testing&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Automated testing&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Use scripts or another software to test the product&lt;/li&gt;
&lt;li&gt;E.g. regression testing, performance testing, stress testing&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Testing levels
&lt;ol&gt;
&lt;li&gt;Unit testing: Test an individual component or group of inter-related components&lt;/li&gt;
&lt;li&gt;Integration testing: Individual components are combined and tested as a group&lt;/li&gt;
&lt;li&gt;System testing: Test a complete and integrated system&lt;/li&gt;
&lt;li&gt;Acceptance testing: Evaluate a system for compliance with the business requirements&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Testing techniques and tactics
&lt;ol&gt;
&lt;li&gt;Regression testing: Make sure that whole system works properly after adding new components&lt;/li&gt;
&lt;li&gt;Stress testing: Test the software under extreme conditions&lt;/li&gt;
&lt;li&gt;Performance testing: Test the speed and effectiveness of the software&lt;/li&gt;
&lt;li&gt;Security testing: Test the program for security vulnerabilities&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;Methods&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Methods&#34;&gt;#&lt;/a&gt;Methods&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Black-box testing: No access to the source code of the software. Only monitor the output of a system after providing a specific input
&lt;ol&gt;
&lt;li&gt;Treat the software as a black box&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Examining functionality without any knowledge of internal implementation&lt;/li&gt;
&lt;li&gt;Not biased toward an implementation&lt;/li&gt;
&lt;li&gt;But may leaves parts of the program untested&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Examples:&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Boundary value and all-pairs testing&lt;/li&gt;
&lt;li&gt;Model-based and specification-based testing&lt;/li&gt;
&lt;li&gt;Use case testing&lt;/li&gt;
&lt;li&gt;Fuzz testing&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;White-box testing: Access to the source code of the software
&lt;ol&gt;
&lt;li&gt;Verify the internal structures or workings of a program&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Exercise paths through the code and determine the appropriate outputs&lt;/li&gt;
&lt;li&gt;Bring more complexity to testing&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Code coverage criteria:&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Control flow testing&lt;/li&gt;
&lt;li&gt;Data flow testing&lt;/li&gt;
&lt;li&gt;Branch testing and decision coverage&lt;/li&gt;
&lt;li&gt;Statement coverage&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Code Coverage: Code that has not been covered by tests is likely to contain bugs&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Coverage = (# of elements tested) Ã· (# of elements in the program)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Grey-box testing: A mix of white-box and black-box tests&lt;br&gt;
Grey-box testers partially know the internal structure, such as documentation of internal data structures as well as the algorithms used&lt;br&gt;
They make better-informed testing choices while testing the software from outside&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Can take the straightforward technique of black-box testing&lt;/li&gt;
&lt;li&gt;Still benefited from the code-targeted systems in white-box testing&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;Principles of Software Testing&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Testing shows the presence of defects, not their absence: Testing reduces the number of defects but not a proof of correctness&lt;/li&gt;
&lt;li&gt;Exhaustive testing is impossible: For every combinations of inputs and preconditions in a nontrivial program&lt;/li&gt;
&lt;li&gt;Early testing saves time and money: Testing should start as early as possible in software development life cycle&lt;/li&gt;
&lt;li&gt;Defects cluster together: Pareto Principle in software testing: 80% of issues comes from 20% of modules&lt;/li&gt;
&lt;li&gt;Beware of the pesticide paradox: Repeating old test cases will eventually fail to find new defects&lt;/li&gt;
&lt;li&gt;Testing is context dependent: Different kinds of software are tested differently&lt;/li&gt;
&lt;li&gt;Absence-of-errors is a fallacy: Unusable software without bugs is still unusable&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;Fuzz testing&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Fuzz testing&#34;&gt;#&lt;/a&gt;Fuzz testing&lt;/h1&gt;
&lt;h2 id=&#34;Definition&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Definition&#34;&gt;#&lt;/a&gt;Definition&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;What Is Fuzzing&lt;br&gt;
A negative testing method that provides random or abnormal input data (fuzz) to a program&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Produce almost no false positive (è¯¯æŠ¥)&lt;br&gt;
Monitor bad behaviour in the responses&lt;/li&gt;
&lt;li&gt;For example, by crashing, or by failing built-in code assertions&lt;/li&gt;
&lt;li&gt;If the program fails, the defects can be noted&lt;/li&gt;
&lt;li&gt;If no crash is produced, inputs are mutated to produce further inputs&lt;br&gt;
Software tools that work with fuzzing are called fuzzers&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Anatomy of a Fuzzer&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Fuzz targets: Small programs that test predefined API functions, similar to unit tests&lt;/li&gt;
&lt;li&gt;Fuzz generators: Create random mutations of inputs to the software under test&lt;/li&gt;
&lt;li&gt;Delivery mechanism: Process inputs from fuzz generators and feed them to the software for execution&lt;/li&gt;
&lt;li&gt;Monitoring system: Keep track of how the inputs are executed and detect triggered bugs from the&lt;br&gt;
software&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img data-src=&#34;https://img.picui.cn/free/2024/10/27/671e081d4f722.png&#34; alt=&#34;img&#34;&gt;&lt;/p&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Reasons for its Success
&lt;ol&gt;
&lt;li&gt;Random input&lt;br&gt;
No model of program behaviour, application type, or system description
&lt;ul&gt;
&lt;li&gt;Random ASCII characters used to test command-line utility options&lt;/li&gt;
&lt;li&gt;Studied Unix, Linux, Windows NT and Mac OS X&lt;br&gt;
Able to test hundreds of applications, each with a multitude of inputs&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Simple criteria&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Pass or fail verdict for fuzzing was very simple: If the application crashes or hangs, it is considered to fail the test. Otherwise, it passes (i.e. quietly exit)&lt;/li&gt;
&lt;li&gt;Very little monitoring was used&lt;br&gt;
Any means of trying to hide the failures would have left the problems undiscovered&lt;br&gt;
No memory leak or heap overflow was caught, unless they resulted in a crash&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Automated testing&lt;br&gt;
The fuzz testing was entirely automated&lt;br&gt;
Results were compared across applications, operating systems, and vendors&lt;br&gt;
Key differences to traditional testing practices
&lt;ul&gt;
&lt;li&gt;General purpose tool&lt;/li&gt;
&lt;li&gt;Extremely easy to use&lt;/li&gt;
&lt;li&gt;Find security problems&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;Types of Fuzzers&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Types of Fuzzers&#34;&gt;#&lt;/a&gt;Types of Fuzzers&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Dumb fuzzing&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Produce input completely randomly&lt;/li&gt;
&lt;li&gt;Easy and inexpensive to set up&lt;/li&gt;
&lt;li&gt;Not efficient&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Smart fuzzing&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Produce inputs that are based on valid input formats&lt;/li&gt;
&lt;li&gt;Require detailed knowledge about input format&lt;/li&gt;
&lt;li&gt;Take longer to set up&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Black-box fuzzin&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Feed a program random inputs to see whether it crashes&lt;/li&gt;
&lt;li&gt;Advantage: easy to configure&lt;/li&gt;
&lt;li&gt;Disadvantage: inefficient search
&lt;ul&gt;
&lt;li&gt;Input often requires structures, random inputs are likely to be malformed&lt;/li&gt;
&lt;li&gt;Hard to generate inputs for certain paths&lt;/li&gt;
&lt;li&gt;May re-run the same path over and over again&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;White-box fuzzing&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Look inside the box: Use source code to guide fuzzing&lt;/li&gt;
&lt;li&gt;Can understand and assert security properties: Explore different program execution paths to check for security properties&lt;/li&gt;
&lt;li&gt;Significantly more complex
&lt;ul&gt;
&lt;li&gt;Need to check whether an input can violate a security property&lt;/li&gt;
&lt;li&gt;Find inputs that will go down different program execution paths&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;Mutation-based fuzzing&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;User supplies a well-formed input&lt;/li&gt;
&lt;li&gt;Fuzzer generates random changes to that input&lt;/li&gt;
&lt;li&gt;No assumption about input
&lt;ul&gt;
&lt;li&gt;Only assume that variants of well-formed input may be problematic&lt;/li&gt;
&lt;li&gt;Not dependent on program details&lt;/li&gt;
&lt;li&gt;May be strongly biased by the initial input!&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Example: zzuf&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;6&#34;&gt;
&lt;li&gt;Generation-based fuzzing&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Generate inputs from some description of the format
&lt;ul&gt;
&lt;li&gt;Using specified protocols or file format info (RFC, documentation, etc.)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Require the user to specify a format or protocol. Or, write a generator for generating well-formatted inputs&lt;/li&gt;
&lt;li&gt;Advantage: more complete search with inputs more specific to the program operations&lt;/li&gt;
&lt;li&gt;Disadvantage: more cumbersome
&lt;ul&gt;
&lt;li&gt;Need specification or generator for every input format and program!&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Example: Peach, SPIKE&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;7&#34;&gt;
&lt;li&gt;Coverage-based fuzzing&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Instrument the program to track coverage&lt;/li&gt;
&lt;li&gt;Maintain a pool of high-quality tests
&lt;ul&gt;
&lt;li&gt;Start with some initial ones specified by users&lt;/li&gt;
&lt;li&gt;Mutate tests in the pool to generate new tests&lt;/li&gt;
&lt;li&gt;Run new tests&lt;/li&gt;
&lt;li&gt;If a new test leads to new elements, save the new test to the pool&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Example: AFL&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;Challenges&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Challenges&#34;&gt;#&lt;/a&gt;Challenges&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;What Fuzzing is NOT Good for&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Bugs that can be found by fuzzing
&lt;ul&gt;
&lt;li&gt;Memory corruption errors, incorrect null handling, bad exception handling&lt;/li&gt;
&lt;li&gt;Deadlocks, infinite loops, assertion violations&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Possible target programs:
&lt;ul&gt;
&lt;li&gt;Desktop applications (browsers, PDF readers, graphics, office suites)&lt;/li&gt;
&lt;li&gt;Libraries (images, audio, crypto APIs) and tools (perl, clang, gcc, sqlite)&lt;/li&gt;
&lt;li&gt;Systems (OS kernels, drivers)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;NOT Good for&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Unit tests that verify that the software works as expected&lt;/li&gt;
&lt;li&gt;Finding logical security flaws
&lt;ul&gt;
&lt;li&gt;E.g. privilege escalation, access control, authorisation, information leakage&lt;/li&gt;
&lt;li&gt;Fuzzing wonâ€™t tell you unless you have some tests that checks for this situation&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Testing for known bugs&lt;/li&gt;
&lt;li&gt;Memory safe code&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Challenges of Guided Fuzzing&lt;br&gt;
Like any testing, fuzzing is unlikely to reach all code paths in the target program&lt;br&gt;
Attempts to solve this problem
&lt;ul&gt;
&lt;li&gt;Corpus distillation: Select a subset of interesting seeds with simple block coverage&lt;/li&gt;
&lt;li&gt;Static analysis: Over-approximate program behaviours without running the program&lt;/li&gt;
&lt;li&gt;Symbolic or concolic execution: Symbolically execute a program to explore all feasible program paths&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/course/Format-string-bugs/</guid>
            <title>Format string bugs</title>
            <link>http://example.com/course/Format-string-bugs/</link>
            <category>C</category>
            <category>software security</category>
            <category>vulnerability</category>
            <pubDate>Sat, 26 Oct 2024 21:52:22 +1000</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;Format Functions&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Format Functions&#34;&gt;#&lt;/a&gt;Format Functions&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;Format Functions&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;printf&lt;/code&gt;  Output a formatted string&lt;/li&gt;
&lt;li&gt;&lt;code&gt;fprintf&lt;/code&gt;  Writes the printf to a file&lt;/li&gt;
&lt;li&gt;&lt;code&gt;sprintf&lt;/code&gt;  Prints into a string&lt;/li&gt;
&lt;li&gt;&lt;code&gt;snprintf&lt;/code&gt;  Prints into a string checking the length&lt;/li&gt;
&lt;li&gt;&lt;code&gt;vprintf&lt;/code&gt;  Prints the argument list to stdout&lt;/li&gt;
&lt;li&gt;&lt;code&gt;vfprintf&lt;/code&gt;  Prints the argument list to a file&lt;/li&gt;
&lt;li&gt;&lt;code&gt;vsprintf&lt;/code&gt;  Prints the argument list to a string&lt;/li&gt;
&lt;li&gt;&lt;code&gt;vsnprintf&lt;/code&gt;  Prints the argument to a string checking the length&lt;br&gt;
 æ€»ç»“ï¼š &lt;code&gt;printf&lt;/code&gt;  å’Œ  &lt;code&gt;fprintf&lt;/code&gt;  ç”¨äºŽè¾“å‡ºæ ¼å¼åŒ–å­—ç¬¦ä¸²åˆ°æ ‡å‡†è¾“å‡ºæˆ–æ–‡ä»¶ã€‚&lt;br&gt;
 &lt;code&gt;sprintf&lt;/code&gt;  å’Œ  &lt;code&gt;snprintf&lt;/code&gt;  ç”¨äºŽå°†æ ¼å¼åŒ–å­—ç¬¦ä¸²å†™å…¥å­—ç¬¦ä¸²ç¼“å†²åŒºï¼Œ &lt;code&gt;snprintf&lt;/code&gt;  æ›´å®‰å…¨ã€‚&lt;br&gt;
 &lt;code&gt;vprintf&lt;/code&gt; ã€ &lt;code&gt;vfprintf&lt;/code&gt; ã€ &lt;code&gt;vsprintf&lt;/code&gt;  å’Œ  &lt;code&gt;vsnprintf&lt;/code&gt;  ç”¨äºŽå¤„ç†å¯å˜å‚æ•°åˆ—è¡¨ï¼Œä¸Žå‰é¢çš„å‡½æ•°ç±»ä¼¼ï¼Œä½†ä¸“é—¨ç”¨äºŽ  &lt;code&gt;va_list&lt;/code&gt;  å‚æ•°çš„å¤„ç†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Format Strings&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Format String is the argument of format functions that contains format parameters. Format parameters are placeholders to be replaced with user inputs&lt;/li&gt;
&lt;li&gt;For example, the statement will output different sentences, depending on what is contained in the variable name:  &lt;code&gt;printf(&amp;quot;Hello, %s.&amp;quot;, &amp;amp;name);&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;If the variable name contains the string â€œZzâ€, then  &lt;code&gt;printf()&lt;/code&gt;  will output: Hello, Zz.&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Common Parameters Used in Format String Attacks&lt;/li&gt;
&lt;/ol&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å‚æ•°&lt;/th&gt;
&lt;th&gt;æè¿°&lt;/th&gt;
&lt;th&gt;ä¼ é€’æ–¹å¼&lt;/th&gt;
&lt;th&gt;åœ¨æ”»å‡»ä¸­çš„ä½œç”¨&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;%s&lt;/td&gt;
&lt;td&gt;æ‰“å°å­—ç¬¦ä¸²&lt;/td&gt;
&lt;td&gt;å¼•ç”¨ï¼ˆæŒ‡å‘å­—ç¬¦ä¸²çš„æŒ‡é’ˆï¼‰&lt;/td&gt;
&lt;td&gt;æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ % s æ‰“å°å‡ºå†…å­˜ä¸­çš„ä»»æ„æ•°æ®ï¼Œé€šè¿‡æä¾›ç‰¹å®šçš„å†…å­˜åœ°å€ï¼Œè¯»å–æ•æ„Ÿæ•°æ®ï¼ˆå¦‚å¯†ç ã€å¯†é’¥ç­‰ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;%d&lt;/td&gt;
&lt;td&gt;æ‰“å°æœ‰ç¬¦å·åè¿›åˆ¶æ•´æ•°&lt;/td&gt;
&lt;td&gt;æ•´æ•°å€¼&lt;/td&gt;
&lt;td&gt;è™½ç„¶ % d é€šå¸¸ç”¨äºŽæ•´æ•°æ˜¾ç¤ºï¼Œä½†æ”»å‡»è€…å¯ä»¥é€šè¿‡å®ƒæ¥æ³„éœ²å†…å­˜ä¸­çš„æ•´æ•°å€¼ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;%u&lt;/td&gt;
&lt;td&gt;æ‰“å°æ— ç¬¦å·åè¿›åˆ¶æ•´æ•°&lt;/td&gt;
&lt;td&gt;æ— ç¬¦å·æ•´æ•°å€¼&lt;/td&gt;
&lt;td&gt;ä¸Ž % d ç±»ä¼¼ï¼Œä½†ç”¨äºŽæ— ç¬¦å·æ•´æ•°çš„æ˜¾ç¤ºã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;%x&lt;/td&gt;
&lt;td&gt;æ‰“å°åå…­è¿›åˆ¶æ•´æ•°ï¼ˆå°å†™ï¼‰&lt;/td&gt;
&lt;td&gt;æ— ç¬¦å·æ•´æ•°å€¼&lt;/td&gt;
&lt;td&gt;æ”»å‡»è€…å¯ä»¥é€šè¿‡ % x é€æ­¥è¯»å–å†…å­˜ï¼Œä»¥åå…­è¿›åˆ¶æ˜¾ç¤ºåœ°å€ä¸­çš„æ•°æ®å†…å®¹ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;%c&lt;/td&gt;
&lt;td&gt;æ‰“å°å•ä¸ªå­—ç¬¦&lt;/td&gt;
&lt;td&gt;å­—ç¬¦å€¼&lt;/td&gt;
&lt;td&gt;ç”¨äºŽæ˜¾ç¤ºå•ä¸ªå­—ç¬¦ï¼Œä½†åœ¨æ”»å‡»ä¸­ç”¨é€”æœ‰é™ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;%n&lt;/td&gt;
&lt;td&gt;å°†å·²æ‰“å°çš„å­—ç¬¦æ•°å†™å…¥æŒ‡å®šå˜é‡&lt;/td&gt;
&lt;td&gt;å¼•ç”¨ï¼ˆæŒ‡å‘æ•´æ•°çš„æŒ‡é’ˆï¼‰&lt;/td&gt;
&lt;td&gt;æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ % n ä¿®æ”¹ä»»æ„å†…å­˜åœ°å€çš„å€¼ï¼Œè¿™æ˜¯æ ¼å¼å­—ç¬¦ä¸²æ”»å‡»ä¸­æœ€å±é™©çš„å‚æ•°ä¹‹ä¸€ï¼Œå¯èƒ½è¢«ç”¨æ¥ä¿®æ”¹ç¨‹åºçš„æŽ§åˆ¶æµã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;%%&lt;/td&gt;
&lt;td&gt;æ‰“å° % å­—ç¬¦&lt;/td&gt;
&lt;td&gt;æ— &lt;/td&gt;
&lt;td&gt;ç”¨äºŽè¾“å‡º % å­—ç¬¦ï¼Œæ— ç‰¹åˆ«çš„æ”»å‡»ä»·å€¼ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;How Do Format Functions Work?&lt;br&gt;
According to the data format dictated by the format parameters, format functions retrieve the arguments from the stack&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;printf(â€œA is the number %d, B is the string %sâ€, A, &amp;amp;B);&lt;br&gt;
The  &lt;code&gt;printf()&lt;/code&gt;  function will attempt to retrieve the value of A and the address of string B from the stack&lt;br&gt;
 åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¸­ï¼Œæ¯ä¸ªæ ¼å¼å‚æ•°ï¼ˆå¦‚  &lt;code&gt;%d&lt;/code&gt; ã€ &lt;code&gt;%s&lt;/code&gt; ï¼‰éƒ½å‘Šè¯‰  &lt;code&gt;printf()&lt;/code&gt;  å¦‚ä½•è§£é‡Šæ ˆä¸­çš„æ•°æ®ï¼š &lt;code&gt;%d&lt;/code&gt;  è¡¨ç¤ºæ£€ç´¢ä¸€ä¸ª æ•´æ•°å€¼ã€‚ &lt;code&gt;%s&lt;/code&gt;  è¡¨ç¤ºæ£€ç´¢ä¸€ä¸ª å­—ç¬¦ä¸²æŒ‡é’ˆï¼ˆåœ°å€ï¼‰ï¼Œç„¶åŽæ ¹æ®åœ°å€æ‰“å°å¯¹åº”çš„å­—ç¬¦ä¸²ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;Exploit&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Exploit&#34;&gt;#&lt;/a&gt;Exploit&lt;/h1&gt;
The vulnerability occurs when there is a mismatch between the number of format parameters and the number of function arguments provided to fill those places 
- For example, if an attacker is able to supply more placeholders than there are arguments, he/she can use format functions to read or write the stack! 
Format functions can be exploited when an attacker is given direct control over the format string fed into the function
&lt;ol&gt;
&lt;li&gt;Reading Data from Stack&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;printf(&amp;quot;A is the number  &lt;code&gt;%d&lt;/code&gt; , reading stack data:  &lt;code&gt;%x&lt;/code&gt; &amp;quot;, A);
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;printf()&lt;/code&gt;  will attempt to retrieve two values from the stack&lt;/li&gt;
&lt;li&gt;But only one of those is placed on the stack&lt;/li&gt;
&lt;li&gt;&lt;code&gt;printf()&lt;/code&gt;  will retrieve the next value on the stack and display it in hex format!&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;To print the next 20 items on the stack:
&lt;ul&gt;
&lt;li&gt;printf(&amp;quot;%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x&amp;quot;);&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;To print the tenth element next on the stack:
&lt;ul&gt;
&lt;li&gt;printf(&amp;quot;%10$x&amp;quot;);&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Reading Data at Arbitrary Location  &lt;code&gt;%s&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Format functions treat the data on the stack as an address to go fetch a string
&lt;ul&gt;
&lt;li&gt;Note that  &lt;code&gt;%s&lt;/code&gt;  is passed as reference!&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;How to control the address accessed by  &lt;code&gt;%s&lt;/code&gt; ?
&lt;ul&gt;
&lt;li&gt;Place an address on the format string (the string is stored on stack)&lt;/li&gt;
&lt;li&gt;Get  &lt;code&gt;%s&lt;/code&gt;  to dereference it!&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;To print the string located at address 0x12345678:
&lt;ul&gt;
&lt;li&gt;printf(&amp;quot;\x78\x56\x34\x12%x%x%x%s&amp;quot;, A, B, C);&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Writing Data at Arbitrary Location  &lt;code&gt;%n&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;%n&lt;/code&gt;  stores the number of characters written so far into the corresponding function argument! For example, the following code put the integer 5 into the variable  &lt;code&gt;num_char&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; num_char; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;11111%n&amp;quot;&lt;/span&gt;, &amp;amp;num_char); &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;With width-controlling format parameters, the attacker can write arbitrary integers to the location pointed to by the function argument&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Write 10 to num_char using width-controlling format parameter&lt;/li&gt;
&lt;/ul&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; num_char; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;%10d%n&amp;quot;&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &amp;amp;num_char);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;Control the amount of data written with length parameter
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;printf(&amp;quot;%10d%hn&amp;quot;, 0, &amp;amp;num_char);&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Writes 2 bytes (instead of 4 bytes) to  &lt;code&gt;&amp;amp;num_char&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Combined with the trick to access arbitrary memory locations, the attacker can write to arbitrary memory locations&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;Example&lt;/li&gt;
&lt;/ol&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; argc, &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; *argv[])&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; buf[&lt;span class=&#34;number&#34;&gt;512&lt;/span&gt;]; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     fgets(buf, &lt;span class=&#34;keyword&#34;&gt;sizeof&lt;/span&gt;(buf), &lt;span class=&#34;built_in&#34;&gt;stdin&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;// å®‰å…¨è¯»å–è¾“å…¥ï¼Œä¸ä¼šå¯¼è‡´ç¼“å†²åŒºæº¢å‡º&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;The input is:&amp;quot;&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;(buf);  &lt;span class=&#34;comment&#34;&gt;// å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ž&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;printf(buf);&lt;/code&gt;  ç›´æŽ¥ä½¿ç”¨äº†ç”¨æˆ·è¾“å…¥çš„å†…å®¹ä½œä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚å¦‚æžœ  &lt;code&gt;buf&lt;/code&gt;  ä¸­åŒ…å«æ ¼å¼åŒ–å ä½ç¬¦ï¼ˆå¦‚  &lt;code&gt;%s&lt;/code&gt; ã€ &lt;code&gt;%x&lt;/code&gt; ã€ &lt;code&gt;%n&lt;/code&gt;  ç­‰ï¼‰ï¼Œ &lt;code&gt;printf()&lt;/code&gt;  ä¼šå°†å…¶è§£é‡Šä¸ºæ ¼å¼åŒ–æŒ‡ä»¤ï¼Œä»Žè€Œé€ æˆå®‰å…¨éšæ‚£ã€‚&lt;/li&gt;
&lt;li&gt;ä¿®å¤ï¼š  &lt;code&gt;printf(&amp;quot;The input is: %s&amp;quot;, buf);&lt;/code&gt; ï¼š% s ç¡®ä¿è¾“å…¥å†…å®¹è¢«å½“ä½œæ™®é€šå­—ç¬¦ä¸²å¤„ç†ï¼Œè€Œä¸æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;Denial of Service Attacks&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Denial of Service Attacks&#34;&gt;#&lt;/a&gt;Denial of Service Attacks&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Crash the program by attempting to access an invalid address&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Use  &lt;code&gt;%s&lt;/code&gt;  to retrieve a value from the stack till encountering an invalid memory location&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The exploit string would look something like this&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Â·printf(&amp;quot;%s%s%s%s%s%s%s%s%s%s%s%s%s%s%s%s%s%s%s%s%s%s%s&amp;quot;);Â·&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The more %s used in the format string, the higher the chance of an invalid address&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;Format String Attacks Prevention&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Format String Attacks Prevention&#34;&gt;#&lt;/a&gt;Format String Attacks Prevention&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;Hard-coded format strings (e.g. no  &lt;code&gt;printf(arg)&lt;/code&gt; )&lt;/li&gt;
&lt;li&gt;Do not use the fancy  &lt;code&gt;%n&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Be careful with pass as references&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;e.g.  &lt;code&gt;%s&lt;/code&gt;  and  &lt;code&gt;sprintf&lt;/code&gt;  can be used to create disclosure attacks&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;Compiler support to match  &lt;code&gt;printf&lt;/code&gt;  arguments with format string&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;e.g. the  &lt;code&gt;gcc&lt;/code&gt;  compiler provides options to check format strings&lt;/li&gt;
&lt;/ul&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/course/Integer-overflow/</guid>
            <title>Integer overflow</title>
            <link>http://example.com/course/Integer-overflow/</link>
            <category>C</category>
            <category>software security</category>
            <pubDate>Sat, 26 Oct 2024 20:33:32 +1000</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;Integer overflow&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Integer overflow&#34;&gt;#&lt;/a&gt;Integer overflow&lt;/h1&gt;
 When the result of an integer operation does not fit within the allocated memory space. All common languages are affected 
&lt;ol&gt;
&lt;li&gt;How Does an Integer Overflow Happen?
&lt;ol&gt;
&lt;li&gt;æ— ç¬¦å·æ•´æ•°æº¢å‡ºï¼šä¾‹å¦‚ï¼Œä¸€ä¸ª 32 ä½æ— ç¬¦å·æ•´æ•°çš„èŒƒå›´æ˜¯ 0 åˆ° 4,294,967,295ï¼ˆå³ 2**32 âˆ’ 1 æˆ– 0xffffffffï¼‰ã€‚å¦‚æžœæˆ‘ä»¬æ‰§è¡Œè®¡ç®— 4,294,967,295 + 1ï¼Œåˆ™ä¼šå¯¼è‡´æº¢å‡ºï¼Œå› ä¸ºç»“æžœè¶…å‡ºäº†æ— ç¬¦å·æ•´æ•°çš„èŒƒå›´&lt;/li&gt;
&lt;li&gt;æœ‰ç¬¦å·æ•´æ•°æº¢å‡º&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;ç¬¦å·ä½çš„æº¢å‡º&lt;br&gt;
å½“ä¸€ä¸ªæ•´æ•°è¿ç®—çš„ç»“æžœè¶…è¿‡æœ‰ç¬¦å·æ•´æ•°çš„èŒƒå›´æ—¶ï¼Œç¬¦å·ä½ï¼ˆæœ€é«˜ä½ï¼‰å¯èƒ½ä¼šè¢«è¦†ç›–ï¼Œä»Žè€Œå¼•å‘æº¢å‡ºã€‚&lt;br&gt;
æœ‰ç¬¦å·æ•´æ•°çš„ç¬¦å·ä½ï¼šåœ¨æœ‰ç¬¦å·æ•´æ•°ä¸­ï¼Œæœ€é«˜ä½ç”¨æ¥è¡¨ç¤ºæ•°å€¼çš„æ­£è´Ÿã€‚ä¾‹å¦‚ï¼Œ32 ä½æœ‰ç¬¦å·æ•´æ•°çš„æœ€é«˜ä½æ˜¯ç¬¬ 31 ä½ï¼ˆç¬¬ 0 ä½åˆ°ç¬¬ 30 ä½æ˜¯æ•°å€¼ä½ï¼‰ã€‚æº¢å‡ºå¯¼è‡´ç¬¦å·å˜åŒ–ï¼šå¦‚æžœè¿ç®—ç»“æžœè¶…å‡ºæ­£æ•°èŒƒå›´ï¼Œç¬¦å·ä½ä¼šè¢«è®¾ç½®ä¸º 1ï¼Œè¿™ä¼šå¯¼è‡´æ•°å€¼è¢«è§£é‡Šä¸ºè´Ÿæ•°ã€‚ä¾‹å¦‚ï¼Œåœ¨ 32 ä½æœ‰ç¬¦å·æ•´æ•°ä¸­ï¼Œ+2,147,483,647 + 1 ä¼šå¯¼è‡´æ•°å€¼å˜æˆ -2,147,483,648ï¼Œå› ä¸ºç¬¦å·ä½è¢«æ”¹å˜ã€‚&lt;/li&gt;
&lt;li&gt;å‘ä¸‹ç±»åž‹è½¬æ¢ï¼ˆDowncastingï¼‰å’Œæ•°å€¼æˆªæ–­ï¼ˆTruncationï¼‰
&lt;ul&gt;
&lt;li&gt;å‘ä¸‹ç±»åž‹è½¬æ¢ï¼šæŒ‡å°†ä¸€ä¸ªé«˜ç²¾åº¦çš„æ•°æ®ç±»åž‹è½¬æ¢ä¸ºä½Žç²¾åº¦çš„æ•°æ®ç±»åž‹ã€‚ä¾‹å¦‚ï¼Œå°† long ç±»åž‹è½¬æ¢ä¸º int æ—¶ï¼Œå¦‚æžœåŽŸå§‹å€¼è¶…è¿‡ int çš„èŒƒå›´ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•°å€¼æˆªæ–­ã€‚&lt;/li&gt;
&lt;li&gt;æ•°å€¼æˆªæ–­å¯èƒ½å¯¼è‡´æº¢å‡ºï¼šæˆªæ–­å‘ç”Ÿæ—¶ï¼Œè¾ƒé«˜ä½çš„æ•°å€¼ä¼šè¢«å¿½ç•¥ï¼Œåªä¿ç•™ä½Žä½éƒ¨åˆ†ã€‚è¿™å¯èƒ½å¯¼è‡´æ•°å€¼é”™è¯¯ï¼Œç”šè‡³è§¦å‘æ•´æ•°æº¢å‡ºã€‚ä¾‹å¦‚ï¼Œå¦‚æžœä¸€ä¸ª 64 ä½çš„ long ç±»åž‹è¢«è½¬æ¢ä¸º 32 ä½çš„ int ç±»åž‹ï¼Œè€Œå…¶æ•°å€¼è¶…è¿‡äº† 32 ä½æ•´æ•°çš„æœ€å¤§å€¼ï¼Œé‚£ä¹ˆé«˜ä½å°†è¢«æˆªæ–­ï¼Œåªä¿ç•™ä½Ž 32 ä½ï¼Œå¯èƒ½å¯¼è‡´æº¢å‡ºæˆ–é”™è¯¯çš„è®¡ç®—ç»“æžœã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Risks of Integer Overflow&lt;br&gt;
Mostly lead to program errors, but can have severe consequences&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Buffer overflow occurs when an integer overflow happens in calculating the length of the buffer&lt;/li&gt;
&lt;li&gt;Erroneous program behaviours in mission critical software Incorrect financial calculations&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;Real-World Examples&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Real-World Examples&#34;&gt;#&lt;/a&gt;Real-World Examples&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;Integer Overflow Leads to Buffer Overflow in OpenSSH 3.3&lt;/li&gt;
&lt;/ol&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;nresp = packet_get_int(); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (nresp &amp;gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;) &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; 	response = xmalloc(nresp * &lt;span class=&#34;keyword&#34;&gt;sizeof&lt;/span&gt;(&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; *)); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; 	&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (i = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; i &amp;lt; nresp; i++) &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; 		response[i] = packet_get_string(&lt;span class=&#34;literal&#34;&gt;NULL&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;When  &lt;code&gt;nresp&lt;/code&gt;  is 1073741824 (1073741824*4=4294967296=2**32), results in an overflow&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;xmalloc()&lt;/code&gt;  receives and allocates a 0-byte buffer&lt;/li&gt;
&lt;li&gt;The subsequent loop causes a heap buffer overflow (å½“å¾ªçŽ¯è¯•å›¾å°†æ•°æ®å†™å…¥åˆ°  &lt;code&gt;response&lt;/code&gt;  æ—¶ï¼Œç”±äºŽ  &lt;code&gt;response&lt;/code&gt;  å¹¶æœªçœŸæ­£åˆ†é…å†…å­˜ï¼Œå†™å…¥æ“ä½œä¼šè¦†ç›–å…¶ä»–å†…å­˜åŒºåŸŸï¼Œå¯¼è‡´ç¨‹åºå´©æºƒæˆ–è¢«æ”»å‡»è€…åˆ©ç”¨ã€‚)&lt;/li&gt;
&lt;li&gt;fixed:  &lt;code&gt;if (nresp &amp;gt; 0 &amp;amp;&amp;amp; nresp &amp;lt;= SIZE_MAX / sizeof(char *))&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;A Real-World Vulnerability in the Handling JPEG Files&lt;/li&gt;
&lt;/ol&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;getComment&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;type&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; len, &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; *src)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; 	&lt;span class=&#34;type&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; size; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; 	size = len â€ &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; 	&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; *comment = (&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; *)&lt;span class=&#34;built_in&#34;&gt;malloc&lt;/span&gt;(size + &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; 	&lt;span class=&#34;built_in&#34;&gt;memcpy&lt;/span&gt;(comment, src, size); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; 	&lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;æ•´æ•°ä¸‹æº¢&lt;br&gt;
åœ¨è¿™æ®µä»£ç ä¸­ï¼Œå˜é‡  &lt;code&gt;len&lt;/code&gt;  å’Œ  &lt;code&gt;size&lt;/code&gt;  è¢«å£°æ˜Žä¸ºæ— ç¬¦å·æ•´æ•°ï¼ˆunsigned intï¼‰ï¼Œè¿™æ„å‘³ç€å®ƒä»¬çš„å€¼ä¸èƒ½æ˜¯è´Ÿæ•°ã€‚&lt;br&gt;
å½“  &lt;code&gt;len&lt;/code&gt;  å°äºŽ 2 æ—¶ï¼Œè®¡ç®—  &lt;code&gt;size = len - 2&lt;/code&gt;  ä¼šå¯¼è‡´ æ•´æ•°ä¸‹æº¢ï¼š&lt;br&gt;
ä¾‹å¦‚ï¼Œ &lt;code&gt;len&lt;/code&gt;  ä¸º 1 æ—¶ï¼Œ &lt;code&gt;size&lt;/code&gt;  å°†å˜ä¸º 0xffffffffï¼ˆ4294967295ï¼‰ï¼Œå³æ— ç¬¦å·æ•´æ•°çš„æœ€å¤§å€¼ã€‚&lt;br&gt;
ä¸‹æº¢çš„åŽŸå› åœ¨äºŽæ— ç¬¦å·æ•´æ•°çš„è¿ç®—ç‰¹æ€§ï¼Œå½“å‡æ³•ç»“æžœä¸ºè´Ÿæ—¶ï¼Œä¼šå›žç»•ï¼ˆwrap aroundï¼‰åˆ°æœ€å¤§å€¼ã€‚&lt;/li&gt;
&lt;li&gt;0 å­—èŠ‚å†…å­˜åˆ†é…&lt;br&gt;
åœ¨ä¸‹æº¢çš„æƒ…å†µä¸‹ï¼Œå½“  &lt;code&gt;size&lt;/code&gt;  è¢«è®¾ç½®ä¸º 0xffffffff æ—¶ï¼Œè¡¨è¾¾å¼  &lt;code&gt;size + 1&lt;/code&gt;  å˜ä¸º 0ã€‚&lt;br&gt;
è¿™ä¼šå¯¼è‡´  &lt;code&gt;malloc(0)&lt;/code&gt; ï¼Œå³åˆ†é…ä¸€ä¸ª 0 å­—èŠ‚çš„ç¼“å†²åŒºã€‚&lt;br&gt;
åœ¨è®¸å¤šç³»ç»Ÿä¸­ï¼Œ0 å­—èŠ‚çš„  &lt;code&gt;malloc()&lt;/code&gt;  æ˜¯åˆæ³•çš„ï¼Œå®ƒä¼šè¿”å›žä¸€ä¸ªæŒ‡é’ˆï¼Œä½†è¯¥æŒ‡é’ˆä¸èƒ½è¢«å†™å…¥ä»»ä½•æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;å †ç¼“å†²åŒºæº¢å‡º&lt;br&gt;
 &lt;code&gt;memcpy(comment, src, size)&lt;/code&gt;  å°†ä»Ž  &lt;code&gt;src&lt;/code&gt;  å¤åˆ¶  &lt;code&gt;size&lt;/code&gt;  ä¸ªå­—èŠ‚åˆ°  &lt;code&gt;comment&lt;/code&gt; ï¼Œå…¶ä¸­  &lt;code&gt;size&lt;/code&gt;  çš„å€¼ä¸º 0xffffffffã€‚&lt;br&gt;
ç”±äºŽ  &lt;code&gt;comment&lt;/code&gt;  æ˜¯ä¸€ä¸ª 0 å­—èŠ‚çš„ç¼“å†²åŒºï¼Œè¿™å°†å¯¼è‡´ å †ç¼“å†²åŒºæº¢å‡ºï¼Œå¯èƒ½è¦†ç›–å…¶ä»–å †å†…å­˜åŒºåŸŸï¼Œä»Žè€Œå¯¼è‡´ç¨‹åºå´©æºƒæˆ–è¢«æ”»å‡»è€…åˆ©ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;ä¿®å¤&lt;/li&gt;
&lt;/ul&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (len &amp;lt;= &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;type&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; size = len - &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; ...&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Example 3&lt;/li&gt;
&lt;/ol&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;bool&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;CopyStructs&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(InputFile* pInFile, &lt;span class=&#34;type&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;long&lt;/span&gt; count)&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;type&#34;&gt;unsigned&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;long&lt;/span&gt; i;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     m_pStructs = new Structs[count]; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (i = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; i &amp;lt; count; i++) &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (!ReadFromFile(pInFile, &amp;amp;(m_pStructs[i]))) &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;             &lt;span class=&#34;keyword&#34;&gt;break&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;The C++â€™s  &lt;code&gt;new[]&lt;/code&gt;  operator, it is similar to  &lt;code&gt;malloc(count*sizeof(Structs))&lt;/code&gt; &lt;br&gt;
Allocate a buffer smaller than we need, the attacker is able to write over the buffer&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;By &lt;strong&gt;overflowing the multiplication operation&lt;/strong&gt; internally&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;Example 4&lt;/li&gt;
&lt;/ol&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;define&lt;/span&gt; MAX_BUF 256&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;BadCode&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; *input)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;type&#34;&gt;short&lt;/span&gt; len; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; buf[MAX_BUF]; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     len = &lt;span class=&#34;built_in&#34;&gt;strlen&lt;/span&gt;(input); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (len &amp;lt; MAX_BUF) &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         &lt;span class=&#34;built_in&#34;&gt;strcpy&lt;/span&gt;(buf, input); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;strlen()&lt;/code&gt;  è¿”å›žæ— ç¬¦å·æ•´æ•°&lt;br&gt;
 &lt;code&gt;strlen()&lt;/code&gt;  è¿”å›žçš„æ˜¯æ— ç¬¦å·æ•´æ•°ç±»åž‹ &lt;code&gt;size_t&lt;/code&gt; ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ª 32 ä½æˆ– 64 ä½æ— ç¬¦å·æ•´æ•°ã€‚&lt;br&gt;
 &lt;code&gt;len&lt;/code&gt;  è¢«å®šä¹‰ä¸ºä¸€ä¸ª 16 ä½æœ‰ç¬¦å·çŸ­æ•´åž‹ &lt;code&gt;short&lt;/code&gt; ï¼Œå…¶èŒƒå›´æ˜¯ -32,768 åˆ° 32,767ã€‚&lt;/li&gt;
&lt;li&gt;ç±»åž‹æˆªæ–­å’Œç¬¦å·ç¿»è½¬&lt;br&gt;
å½“  &lt;code&gt;strlen(input)&lt;/code&gt;  è¿”å›žçš„é•¿åº¦è¶…è¿‡  &lt;code&gt;32,767&lt;/code&gt;  æ—¶ï¼Œèµ‹å€¼ç»™  &lt;code&gt;short len&lt;/code&gt;  æ—¶ä¼šå‘ç”Ÿ ç±»åž‹æˆªæ–­ï¼Œå¯¼è‡´æº¢å‡ºã€‚&lt;br&gt;
ä¾‹å¦‚ï¼Œå¦‚æžœ  &lt;code&gt;strlen(input)&lt;/code&gt;  è¿”å›ž 40,000ï¼Œé‚£ä¹ˆèµ‹å€¼åŽï¼Œ &lt;code&gt;len&lt;/code&gt;  çš„å€¼å°†ä¼šå˜æˆ -25,536ï¼ˆæº¢å‡ºåŽçš„å€¼ï¼‰ï¼Œå› ä¸º  &lt;code&gt;short&lt;/code&gt;  ç±»åž‹çš„æœ€å¤§æ­£å€¼åªèƒ½åˆ° 32,767ã€‚&lt;br&gt;
è¿™ä¼šå°†ä¸€ä¸ªæœ¬åº”æ˜¯å¤§äºŽ 256 çš„å€¼å˜æˆä¸€ä¸ªè´Ÿæ•°ã€‚&lt;/li&gt;
&lt;li&gt;ç¼“å†²åŒºæº¢å‡ºé£Žé™©&lt;br&gt;
åœ¨ç±»åž‹æˆªæ–­åŽï¼Œ &lt;code&gt;len&lt;/code&gt;  å¯èƒ½æ˜¯è´Ÿæ•°ã€‚æ¡ä»¶  &lt;code&gt;if (len &amp;lt; MAX_BUF)&lt;/code&gt;  å°†ä¼šæˆç«‹ï¼Œå› ä¸ºè´Ÿæ•°å°äºŽ 256ã€‚&lt;br&gt;
è¿™æ„å‘³ç€ï¼Œå³ä½¿è¾“å…¥å­—ç¬¦ä¸²çš„å®žé™…é•¿åº¦è¶…è¿‡äº† 256 å­—èŠ‚ï¼Œ &lt;code&gt;strcpy(buf, input)&lt;/code&gt;  ä»ä¼šè¢«æ‰§è¡Œï¼Œå¯¼è‡´ç¼“å†²åŒºæº¢å‡ºã€‚&lt;/li&gt;
&lt;li&gt;ä¿®å¤&lt;br&gt;
 &lt;code&gt;len = strnlen(input, MAX_BUF);&lt;/code&gt; : The  &lt;code&gt;strnlen()&lt;/code&gt;  function returns an integer value capped by  &lt;code&gt;MAX_BUF&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;Integer Overflow Prevention&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Integer Overflow Prevention&#34;&gt;#&lt;/a&gt;Integer Overflow Prevention&lt;/h1&gt;
Integer overflow is very hard to discover and prevent
&lt;ol&gt;
&lt;li&gt;Runtime checks&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;ubsan instruments binaries to be executed and checks the results of arithmetic operations&lt;/li&gt;
&lt;li&gt;Microsoft Visual C++ 2005 and later automatically catch calls to operator new that overflow&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Library support&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;SafeInt class performs safe operations&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Static analysis tools and formal verification techniques&lt;br&gt;
 åœ¨ç¨‹åºç¼–è¯‘å‰å¯¹æºä»£ç è¿›è¡Œåˆ†æžï¼Œå¯»æ‰¾æ½œåœ¨çš„æ•´æ•°æº¢å‡ºé—®é¢˜ã€‚è¿™äº›å·¥å…·å¯ä»¥æ£€æµ‹ä»£ç ä¸­çš„å¸¸è§æ•´æ•°è¿ç®—é”™è¯¯ï¼ŒåŒ…æ‹¬åŠ å‡ä¹˜é™¤æº¢å‡ºã€ç±»åž‹è½¬æ¢æº¢å‡ºç­‰&lt;/li&gt;
&lt;/ol&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/course/Stack-buffer-overflow/</guid>
            <title>Stack buffer overflow</title>
            <link>http://example.com/course/Stack-buffer-overflow/</link>
            <category>C</category>
            <category>software security</category>
            <category>vulnerability</category>
            <pubDate>Sat, 26 Oct 2024 17:50:30 +1000</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;Stack buffer overflow&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Stack buffer overflow&#34;&gt;#&lt;/a&gt;Stack buffer overflow&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;The Process Stack&lt;/li&gt;
&lt;/ol&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Sample Process C Code&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; a, &lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; b, &lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; c)&lt;/span&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; buffer1[&lt;span class=&#34;number&#34;&gt;5&lt;/span&gt;]; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; buffer2[&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;]; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    	... &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;type&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	A(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;(...); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   	 ... &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img data-src=&#34;https://img.picui.cn/free/2024/10/26/671ca1b71cfbb.png&#34; alt=&#34;img&#34;&gt;&lt;/p&gt;
&lt;p&gt;åœ¨è°ƒç”¨å‡½æ•°æ—¶ï¼Œå‡½æ•°å‚æ•°æ˜¯æŒ‰ç…§ä»Žå³åˆ°å·¦çš„é¡ºåºä¾æ¬¡åŽ‹å…¥æ ˆä¸­ã€‚è¿™ç§å‚æ•°ä¼ é€’æ–¹å¼æ˜¯ x86 æž¶æž„çš„æ ‡å‡†åšæ³•ï¼Œç”¨äºŽä¿è¯å‡½æ•°å‚æ•°åœ¨æ ˆä¸Šçš„æ­£ç¡®é¡ºåºã€‚&lt;br&gt;
åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå‡½æ•°  &lt;code&gt;A(int a, int b, int c)&lt;/code&gt;  è¢«è°ƒç”¨æ—¶ï¼Œ &lt;code&gt;c&lt;/code&gt;  é¦–å…ˆè¢«åŽ‹å…¥æ ˆï¼Œç„¶åŽæ˜¯  &lt;code&gt;b&lt;/code&gt; ï¼Œæœ€åŽæ˜¯  &lt;code&gt;a&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Buffer Overflow&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Occurs when:&lt;br&gt;
Input is unconstrained&lt;br&gt;
Runs past the end of a buffer, replacing valid (control) data&lt;/li&gt;
&lt;li&gt;Technique that allows:&lt;br&gt;
Your code to be executed by another program&lt;br&gt;
Overflow data area to alter variable values&lt;/li&gt;
&lt;li&gt;Problem: declaration in version of login.c is  &lt;code&gt;char name[80], passwd[80], hash[13];&lt;/code&gt; . Attack login procedure:
&lt;ol&gt;
&lt;li&gt;User types username, which is stored in name&lt;/li&gt;
&lt;li&gt;Compute hash for the corresponding password&lt;/li&gt;
&lt;li&gt;User types password, pads to 80 chars, and types hash for that password&lt;/li&gt;
&lt;li&gt;The program validates password against user-supplied hash; user is in (with any password)&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Stack Smashing&lt;br&gt;
 ç¼“å†²åŒºæº¢å‡ºæ”»å‡»çš„æ ¸å¿ƒæ˜¯è¦†ç›–æ ˆä¸Šçš„ è¿”å›žåœ°å€ï¼ˆretï¼‰ã€‚å½“è¿”å›žåœ°å€è¢«è¦†ç›–æ—¶ï¼Œç¨‹åºåœ¨å‡½æ•°è¿”å›žæ—¶ä¸ä¼šè·³å›žè°ƒç”¨å‡½æ•°çš„ä½ç½®ï¼Œè€Œæ˜¯è·³è½¬åˆ°æ”»å‡»è€…æŒ‡å®šçš„ä½ç½®ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ç§æŠ€æœ¯è®©ç¨‹åºæ‰§è¡Œä»»æ„ä»£ç ï¼ˆå¦‚æ¶æ„ä»£ç æˆ– shellcodeï¼‰ï¼Œè¿™è¢«ç§°ä¸ºå †æ ˆç ´åã€‚&lt;/li&gt;
&lt;/ol&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Stack Smashing&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;functionA&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; *str)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; buffer[&lt;span class=&#34;number&#34;&gt;16&lt;/span&gt;]; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;built_in&#34;&gt;strcpy&lt;/span&gt;(buffer, str);   &lt;span class=&#34;comment&#34;&gt;//segmentation fault&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; large_string[&lt;span class=&#34;number&#34;&gt;256&lt;/span&gt;]; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; i; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (i = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span class=&#34;number&#34;&gt;255&lt;/span&gt;; i++) &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;       &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		large_string[i] = &lt;span class=&#34;string&#34;&gt;&amp;#x27;A&amp;#x27;&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	functionA(large_string); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;buffer&lt;/code&gt; ï¼šåœ¨  &lt;code&gt;functionA&lt;/code&gt;  ä¸­å£°æ˜Žä¸º 16 å­—èŠ‚çš„å­—ç¬¦æ•°ç»„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;strcpy(buffer, str)&lt;/code&gt; ï¼šä½¿ç”¨  &lt;code&gt;strcpy&lt;/code&gt;  å°†å¤–éƒ¨ä¼ å…¥çš„å­—ç¬¦ä¸² str å¤åˆ¶åˆ° buffer ä¸­ã€‚ç”±äºŽ  &lt;code&gt;strcpy&lt;/code&gt;  ä¸æ£€æŸ¥é•¿åº¦ï¼Œå¦‚æžœ  &lt;code&gt;str&lt;/code&gt;  çš„é•¿åº¦è¶…è¿‡ 16 å­—èŠ‚ï¼Œä¼šå¯¼è‡´ç¼“å†²åŒºæº¢å‡ºã€‚&lt;/li&gt;
&lt;li&gt;åœ¨  &lt;code&gt;main&lt;/code&gt;  ä¸­ï¼Œ &lt;code&gt;large_string&lt;/code&gt;  æ˜¯ä¸€ä¸ª 256 å­—èŠ‚çš„æ•°ç»„ï¼Œå®ƒè¢«å¡«å……ä¸º 255 ä¸ª â€˜Aâ€™ã€‚å½“  &lt;code&gt;large_string&lt;/code&gt;  è¢«ä¼ é€’ç»™  &lt;code&gt;functionA&lt;/code&gt;  æ—¶ï¼Œ &lt;code&gt;buffer&lt;/code&gt;  è¢«æº¢å‡ºã€‚&lt;/li&gt;
&lt;li&gt;ä¿®å¤ï¼š  &lt;code&gt;strcpy(buffer, str)&lt;/code&gt;  --&amp;gt;  &lt;code&gt;strncpy(buffer, str, 16);&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img data-src=&#34;https://img.picui.cn/free/2024/10/26/671ca87ccb1e2.png&#34; alt=&#34;img&#34;&gt;&lt;br&gt;
 &lt;code&gt;large_str&lt;/code&gt;  has overflowed  &lt;code&gt;buffer&lt;/code&gt;  and  &lt;code&gt;sfp&lt;/code&gt;  and  &lt;code&gt;ret&lt;/code&gt;  and  &lt;code&gt;*str&lt;/code&gt; .Note that  &lt;code&gt;ret&lt;/code&gt;  is the return address!&lt;br&gt;
This means we can get the function to return to any point in the code that we specify.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Buffer overflows allow us to change return address
&lt;ol&gt;
&lt;li&gt;Can point to any function in the library&lt;/li&gt;
&lt;li&gt;Can point to own code&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Add code in the overflowed buffer
&lt;ol&gt;
&lt;li&gt;Run at privilege of process (very useful if root!)&lt;/li&gt;
&lt;li&gt;Even a small buffer can invoke a shell using the system call (often called shellcode)&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Attacker would like to run shell at root level
&lt;ol&gt;
&lt;li&gt;Make system call to  &lt;code&gt;execve&lt;/code&gt; , passing  &lt;code&gt;/bin/sh&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Needs to be part of the buffer, and in assembly code (ä»¥ä¾¿ç²¾ç¡®æŽ§åˆ¶å…¶å¤§å°å’ŒåŠŸèƒ½)&lt;/li&gt;
&lt;li&gt;Program has to fit in buffer without overwriting return address (å¦‚æžœ shellcode è¦†ç›–äº†è¿”å›žåœ°å€æœ¬èº«ï¼Œå¯èƒ½å¯¼è‡´ç¨‹åºå´©æºƒè€Œæ— æ³•æ‰§è¡Œæ”»å‡»ä»£ç )&lt;/li&gt;
&lt;li&gt;Pad out buffer to return address, and point return address to start of buffer&lt;/li&gt;
&lt;li&gt;Donâ€™t generate core dump (this will cause suspicion)&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;What do You Need to Hack a Buffer Overflow
&lt;ol&gt;
&lt;li&gt;Address where buffer begins&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Easy to get if you have access to the same type of system being attacked&lt;/li&gt;
&lt;li&gt;Can use Null Operation (NOP) commands to make the target address bigger&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Location where return address is stored&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Can pad out the buffer with return address&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Assembly language program to spawn a shell (shellcode payload)&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Can use gdb to disassemble a program for you&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Affected Languages&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Buffer overflows mainly occur in low-level programming languages that allow direct memory access: Assembler, C, C++&lt;br&gt;
Note that some high-level languages such as Java, C# and Visual Basic are written in C, C++ or call modules written in these languages&lt;/p&gt;
&lt;ol start=&#34;6&#34;&gt;
&lt;li&gt;
&lt;p&gt;Buffer Overflow Examples&lt;br&gt;
Functions that handle arrays but do not check length (checking for termination character is insufficient) In C/C++,   &lt;code&gt;gets&lt;/code&gt; ,  &lt;code&gt;strcpy&lt;/code&gt; ,  &lt;code&gt;strcat&lt;/code&gt; ,  &lt;code&gt;sprintf&lt;/code&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Example 1&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; buf[&lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;]; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; gets(buf);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;char buf[20]&lt;/code&gt; ï¼šå®šä¹‰äº†ä¸€ä¸ªé•¿åº¦ä¸º 20 çš„å­—ç¬¦æ•°ç»„  &lt;code&gt;buf&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;gets(buf)&lt;/code&gt; ï¼šä½¿ç”¨  &lt;code&gt;gets()&lt;/code&gt;  å‡½æ•°ä»Žæ ‡å‡†è¾“å…¥è¯»å–å­—ç¬¦ä¸²ï¼Œå¹¶å­˜å‚¨åœ¨  &lt;code&gt;buf&lt;/code&gt;  ä¸­&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;gets()&lt;/code&gt;  å‡½æ•°ä¸æ£€æŸ¥è¾“å…¥çš„é•¿åº¦ï¼Œæ„å‘³ç€å¦‚æžœè¾“å…¥çš„å­—ç¬¦ä¸²é•¿åº¦è¶…è¿‡äº†  &lt;code&gt;buf&lt;/code&gt;  çš„å¤§å°ï¼ˆ20 å­—èŠ‚ï¼‰ï¼Œåˆ™ä¼šå‘ç”Ÿç¼“å†²åŒºæº¢å‡ºã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¿®å¤ï¼š  &lt;code&gt;fgets(buf, sizeof(buf), stdin);&lt;/code&gt;&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Example 2&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; buf[&lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;]; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; prefix[] = &lt;span class=&#34;string&#34;&gt;&amp;quot;http://&amp;quot;&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   ... &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   &lt;span class=&#34;comment&#34;&gt;// copies the string prefix to buf &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;built_in&#34;&gt;strcpy&lt;/span&gt;(buf, prefix); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   &lt;span class=&#34;comment&#34;&gt;// concatenates path to the string buf &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;built_in&#34;&gt;strncat&lt;/span&gt;(buf, path, &lt;span class=&#34;keyword&#34;&gt;sizeof&lt;/span&gt;(buf));&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;char buf[20]&lt;/code&gt; ï¼šå®šä¹‰äº†ä¸€ä¸ªé•¿åº¦ä¸º 20 å­—èŠ‚çš„å­—ç¬¦æ•°ç»„  &lt;code&gt;buf&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;char prefix[] = &amp;quot;http://&amp;quot;;&lt;/code&gt; ï¼šå®šä¹‰äº†ä¸€ä¸ªåŒ…å«å­—ç¬¦ä¸²  &lt;code&gt;&amp;quot;http://&amp;quot;&lt;/code&gt;  çš„å­—ç¬¦æ•°ç»„ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;strcpy(buf, prefix)&lt;/code&gt; ï¼šå°†å­—ç¬¦ä¸²  &lt;code&gt;&amp;quot;http://&amp;quot;&lt;/code&gt;  å¤åˆ¶åˆ°  &lt;code&gt;buf&lt;/code&gt;  ä¸­ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é—®é¢˜ï¼š &lt;code&gt;&amp;quot;http://&amp;quot;&lt;/code&gt;  é•¿åº¦ä¸º 7 å­—èŠ‚ï¼ˆåŒ…æ‹¬ç»ˆæ­¢ç¬¦ \0ï¼‰ï¼Œåœ¨å¤åˆ¶åŽï¼Œ &lt;code&gt;buf&lt;/code&gt;  ä¸­åªå‰©ä¸‹ 13 ä¸ªå­—èŠ‚å¯ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;strncat(buf, path, sizeof(buf))&lt;/code&gt; ï¼šå°†å­—ç¬¦ä¸²  &lt;code&gt;path&lt;/code&gt;  è¿žæŽ¥åˆ°  &lt;code&gt;buf&lt;/code&gt;  ä¸­ï¼ŒæŒ‡å®šçš„æœ€å¤§é•¿åº¦ä¸º  &lt;code&gt;sizeof(buf)&lt;/code&gt; ï¼ˆå³ 20 å­—èŠ‚ï¼‰ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é—®é¢˜ï¼šè¿™é‡Œçš„  &lt;code&gt;sizeof(buf)&lt;/code&gt;  æ˜¯ 20 å­—èŠ‚ï¼Œä½†åœ¨å‰é¢å·²ç»ç”¨æŽ‰äº† 7 å­—èŠ‚ï¼ˆåŒ…æ‹¬ç»ˆæ­¢ç¬¦ï¼‰ã€‚ &lt;code&gt;strncat()&lt;/code&gt;  è¯•å›¾è¿½åŠ   &lt;code&gt;path&lt;/code&gt;  çš„å†…å®¹æ—¶ï¼Œå¯èƒ½ä¼šè¶…å‡º  &lt;code&gt;buf&lt;/code&gt;  çš„å‰©ä½™ç©ºé—´ï¼ˆ13 å­—èŠ‚ï¼‰ï¼Œå¯¼è‡´ç¼“å†²åŒºæº¢å‡ºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¿®å¤ï¼š &lt;code&gt;strncat(buf, path, sizeof(buf) - strlen(buf) - 1);&lt;/code&gt;&lt;/p&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Example 3&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; buf[&lt;span class=&#34;number&#34;&gt;32&lt;/span&gt;]; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;built_in&#34;&gt;strncpy&lt;/span&gt;(buf, data, &lt;span class=&#34;built_in&#34;&gt;strlen&lt;/span&gt;(data)); &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;code&gt;strncpy(buf, data, strlen(data))&lt;/code&gt; ï¼šå°†å­—ç¬¦ä¸²  &lt;code&gt;data&lt;/code&gt;  å¤åˆ¶åˆ°  &lt;code&gt;buf&lt;/code&gt;  ä¸­ï¼Œå¤åˆ¶çš„é•¿åº¦ä¸º  &lt;code&gt;strlen(data)&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ç¼ºé™· 1ï¼šç¼ºå°‘ç»ˆæ­¢ç¬¦ \0ï¼š &lt;code&gt;strncpy&lt;/code&gt;  ä¸ä¼šè‡ªåŠ¨æ·»åŠ å­—ç¬¦ä¸²çš„ç»ˆæ­¢ç¬¦  &lt;code&gt;\0&lt;/code&gt; ï¼Œå¦‚æžœ  &lt;code&gt;data&lt;/code&gt;  çš„é•¿åº¦ç­‰äºŽæˆ–å¤§äºŽ 32ï¼Œé‚£ä¹ˆ  &lt;code&gt;buf&lt;/code&gt;  ä¸ä¼šä»¥  &lt;code&gt;\0&lt;/code&gt;  ç»“å°¾ã€‚è¿™å¯èƒ½å¯¼è‡´  &lt;code&gt;buf&lt;/code&gt;  è¢«å½“ä½œæœªç»ˆæ­¢çš„å­—ç¬¦ä¸²å¤„ç†ï¼Œå¸¦æ¥ä¸ç¡®å®šçš„è¡Œä¸ºæˆ–å®‰å…¨é£Žé™©ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç¼ºé™· 2ï¼šå¯èƒ½çš„ç¼“å†²åŒºæº¢å‡ºï¼šå¦‚æžœ  &lt;code&gt;strlen(data) &amp;gt; 32&lt;/code&gt; ï¼Œ &lt;code&gt;strncpy&lt;/code&gt;  å°†å°è¯•å¤åˆ¶è¶…è¿‡  &lt;code&gt;buf&lt;/code&gt;  å¤§å°çš„å†…å®¹ï¼Œå¯¼è‡´ç¼“å†²åŒºæº¢å‡ºã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¿®å¤ï¼š &lt;code&gt;strncpy(buf, data, sizeof(buf) - 1); buf[sizeof(buf) - 1] = &#39;\0&#39;;&lt;/code&gt;&lt;/p&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;Example 4&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; buf[MAX_PATH]; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;built_in&#34;&gt;sprintf&lt;/span&gt;(buf, &lt;span class=&#34;string&#34;&gt;&amp;quot;%s - %d\n&amp;quot;&lt;/span&gt;, path, errno);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;sprintf(buf, &amp;quot;%s - %d\n&amp;quot;, path, errno)&lt;/code&gt;  ä¼šå°†  &lt;code&gt;path&lt;/code&gt;  å’Œ  &lt;code&gt;errno&lt;/code&gt;  çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²å¤åˆ¶åˆ°  &lt;code&gt;buf&lt;/code&gt;  ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;sprintf&lt;/code&gt;  ä¸æ£€æŸ¥  &lt;code&gt;buf&lt;/code&gt;  çš„å¤§å°æ˜¯å¦è¶³ä»¥å®¹çº³æ ¼å¼åŒ–åŽçš„ç»“æžœã€‚å¦‚æžœ  &lt;code&gt;path&lt;/code&gt;  å¾ˆé•¿ï¼ŒåŠ ä¸Šæ•°å­—  &lt;code&gt;errno&lt;/code&gt;  å’Œå…¶ä»–å­—ç¬¦ï¼Œå¯èƒ½ä¼šè¶…è¿‡  &lt;code&gt;MAX_PATH&lt;/code&gt; ï¼Œå¯¼è‡´ç¼“å†²åŒºæº¢å‡ºã€‚&lt;/li&gt;
&lt;li&gt;ä¿®å¤ï¼š  &lt;code&gt;snprintf(buf, sizeof(buf), &amp;quot;%s - %d\n&amp;quot;, path, errno);&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;Stack buffer overflow prevention&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Stack buffer overflow prevention&#34;&gt;#&lt;/a&gt;Stack buffer overflow prevention&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;Spotting Buffer Overflows&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Check inputs, whether read from the network, a file, or from the command line&lt;/li&gt;
&lt;li&gt;Check transfer of data from said input to internal structures&lt;/li&gt;
&lt;li&gt;Look for use of unsafe string handling calls&lt;/li&gt;
&lt;li&gt;Look for use of arithmetic to calculate an allocation size or remaining buffer size&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Fixing Buffer Overflows&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Replace dangerous string handling functions&lt;/li&gt;
&lt;li&gt;Replace C string buffers with C++ strings&lt;/li&gt;
&lt;li&gt;Replace static arrays with STL containers&lt;/li&gt;
&lt;li&gt;Use analysis tools, Examples include Fortify, Coverity, PREfast, and Klocwor&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Code Analysis&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Statically check source to detect buffer overflows s&lt;/li&gt;
&lt;li&gt;Several tools exist to automate the review process&lt;br&gt;
Stanford:  Engler, et al.  Test trust inconsistency&lt;br&gt;
@stake.com  (&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL2wwcGh0LmNvbQ==&#34;&gt;l0pht.com&lt;/span&gt;): SLINT (designed for UNIX)&lt;br&gt;
Berkeley:  Wagner, et al.  Test constraint violations&lt;/li&gt;
&lt;li&gt;Find lots of bugs, but not all&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;Marking Stack as Non-Execute&lt;br&gt;
Basic stack exploit can be prevented by marking stack segment as non-executable&lt;br&gt;
Limitations and Problems&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Some apps need executable stack (e.g. LISP interpreters)&lt;/li&gt;
&lt;li&gt;Does not block more general overflow exploits&lt;/li&gt;
&lt;li&gt;Overflow on heap: overflow buffer next to func pointer&lt;/li&gt;
&lt;li&gt;Cannot make all the data segment non-executable&lt;/li&gt;
&lt;li&gt;More recent UNIX and MS windows emit dynamic code into program data for performance optimisations&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;Stack Protection and Run-time Checking&lt;br&gt;
Many run-time checking techniques
&lt;ol&gt;
&lt;li&gt;Example:  StackGuard (WireX)&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Run time tests for stack integrity&lt;/li&gt;
&lt;li&gt;Code generator for emitting code to set up and tear down functions&lt;/li&gt;
&lt;li&gt;Embeds â€œcanariesâ€ in stack frames and verify their integrity prior to function return&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Libsafe (Avaya Labs)&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Dynamically loaded library&lt;/li&gt;
&lt;li&gt;Intercepts calls to  &lt;code&gt;strcpy (dest, src)&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;Validate sufficient space in current stack frame: |framepointerâ€“dest| &amp;gt; strlen(src)&lt;/li&gt;
&lt;li&gt;If so, does strcpy. Otherwise, terminates application&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Address obfuscation (Stony Brookâ€™03)&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Encrypt return address on stack by XORing with random string. Decrypt just before returning from function&lt;/li&gt;
&lt;li&gt;Attacker needs decryption key to set return address to desired value&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;7&#34;&gt;
&lt;li&gt;PaX ASLR: Randomise location of libc&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Attacker cannot jump directly to exec function&lt;/li&gt;
&lt;/ul&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/course/x86-architecture-and-Assembly-basics/</guid>
            <title>x86 architecture and Assembly basics</title>
            <link>http://example.com/course/x86-architecture-and-Assembly-basics/</link>
            <category>software security</category>
            <category>Linux</category>
            <category>C language</category>
            <category>gdb</category>
            <pubDate>Fri, 25 Oct 2024 17:43:11 +1000</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34; x86 architecture&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;# x86 architecture&#34;&gt;#&lt;/a&gt; x86 architecture&lt;/h1&gt;
&lt;h2 id=&#34;Levels of Abstraction&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Levels of Abstraction&#34;&gt;#&lt;/a&gt; Levels of Abstraction&lt;/h2&gt;
&lt;p&gt;æŠ½è±¡å±‚æ¬¡ï¼ˆLevels of Abstractionï¼‰ æ˜¯æŒ‡åœ¨è®¡ç®—æœºç³»ç»Ÿè®¾è®¡ä¸­ï¼Œå°†å¤æ‚çš„ç³»ç»Ÿåˆ†è§£ä¸ºä¸åŒçš„å±‚æ¬¡ï¼Œä»¥ä¾¿äºŽç†è§£ã€è®¾è®¡å’Œå®žçŽ°ã€‚æ¯ä¸ªæŠ½è±¡å±‚éƒ½åŸºäºŽæ›´åº•å±‚çš„å±‚æ¬¡ï¼ŒåŒæ—¶ä¹Ÿä¸ºæ›´é«˜å±‚æ¬¡æä¾›åŸºç¡€ã€‚è¿™ç§å±‚æ¬¡åŒ–çš„è®¾è®¡æ–¹å¼ä½¿å¾—å¤æ‚ç³»ç»Ÿçš„å¼€å‘å’Œç»´æŠ¤æ›´åŠ é«˜æ•ˆã€‚ä»¥ä¸‹æ˜¯è¿™äº›æŠ½è±¡å±‚æ¬¡çš„å…·ä½“è§£é‡Šï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç¡¬ä»¶å±‚ï¼ˆHardware Levelï¼‰&lt;br&gt;
è§£é‡Šï¼šè¿™æ˜¯æœ€åº•å±‚çš„æŠ½è±¡å±‚ï¼Œä¸»è¦æ˜¯ç”±å„ç§ç”µå­ç”µè·¯å’Œé€»è¾‘é—¨ï¼ˆå¦‚ XORã€ANDã€ORã€NOT é—¨ç­‰ï¼‰ç»„æˆã€‚è¿™äº›ç”µè·¯å®žçŽ°äº†æœ€åŸºæœ¬çš„é€»è¾‘è¿ç®—å’Œæ•°æ®å¤„ç†ï¼Œæ˜¯è®¡ç®—æœºæ‰€æœ‰åŠŸèƒ½çš„åŸºç¡€ã€‚&lt;br&gt;
ç‰¹ç‚¹ï¼šè¿™ä¸€å±‚æ˜¯æœ€æŽ¥è¿‘ç‰©ç†ç¡¬ä»¶çš„ï¼Œç›´æŽ¥å¤„ç†ç”µä¿¡å·å’Œç‰©ç†å¼€å…³çŠ¶æ€ã€‚&lt;/li&gt;
&lt;li&gt;å¾®ç å±‚ï¼ˆMicrocode Levelï¼‰/ å›ºä»¶å±‚ï¼ˆFirmware Levelï¼‰&lt;br&gt;
è§£é‡Šï¼šå¾®ç ï¼ˆæˆ–å›ºä»¶ï¼‰æ˜¯ä¸€ç§åµŒå…¥åœ¨ç¡¬ä»¶ä¸­çš„ç‰¹æ®Šç¨‹åºï¼Œç”¨æ¥è§£é‡Šæœºå™¨æŒ‡ä»¤å¹¶æŽ§åˆ¶åº•å±‚ç¡¬ä»¶çš„æ“ä½œã€‚å®ƒä½äºŽç¡¬ä»¶å’Œæœºå™¨ç ä¹‹é—´ã€‚&lt;br&gt;
ç‰¹ç‚¹ï¼šå¾®ç ä½œä¸ºç¡¬ä»¶ä¸Žæœºå™¨ç çš„æ¡¥æ¢ï¼Œæ˜¯æŒ‡ä»¤æ‰§è¡Œçš„æŽ§åˆ¶é€»è¾‘ï¼Œå¯ä»¥åœ¨ä¸æ”¹å˜ç¡¬ä»¶çš„æƒ…å†µä¸‹æ›´æ–°æˆ–è°ƒæ•´è®¡ç®—æœºçš„åŠŸèƒ½ã€‚&lt;/li&gt;
&lt;li&gt;æœºå™¨ç å±‚ï¼ˆMachine Code Levelï¼‰&lt;br&gt;
è§£é‡Šï¼šæœºå™¨ç æ˜¯è®¡ç®—æœºç›´æŽ¥æ‰§è¡Œçš„äºŒè¿›åˆ¶ä»£ç ï¼Œé€šå¸¸ä»¥æ“ä½œç ï¼ˆopcodesï¼‰å’Œåå…­è¿›åˆ¶æ•°å­—å½¢å¼è¡¨ç¤ºã€‚å®ƒç”±ä¸€ç³»åˆ—ä½Žçº§æŒ‡ä»¤ç»„æˆï¼Œç”¨äºŽæŽ§åˆ¶è®¡ç®—æœºçš„å¤„ç†å™¨æ‰§è¡Œä»»åŠ¡ã€‚&lt;br&gt;
ç‰¹ç‚¹ï¼šæœºå™¨ç æ˜¯æœ€åº•å±‚çš„å¯ç¼–ç¨‹è¯­è¨€ï¼Œåªæœ‰è®¡ç®—æœºå¯ä»¥ç›´æŽ¥æ‰§è¡Œï¼Œç”±å¤„ç†å™¨æŒ‰ç…§æŒ‡ä»¤æ‰§è¡Œå…·ä½“æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;ä½Žçº§è¯­è¨€å±‚ï¼ˆLow-Level Languages Levelï¼‰&lt;br&gt;
è§£é‡Šï¼šä½Žçº§è¯­è¨€æ˜¯æœºå™¨ç çš„äººç±»å¯è¯»ç‰ˆæœ¬ï¼Œä¾‹å¦‚æ±‡ç¼–è¯­è¨€ï¼ˆAssembly Languageï¼‰ã€‚å®ƒä½¿ç”¨åŠ©è®°ç¬¦ï¼ˆå¦‚ MOVã€ADDã€JMP ç­‰ï¼‰æ¥ä»£è¡¨æœºå™¨æŒ‡ä»¤ï¼Œæ›´æ˜“äºŽç¼–ç¨‹å’Œè°ƒè¯•ã€‚&lt;br&gt;
ç‰¹ç‚¹ï¼šä½Žçº§è¯­è¨€ç´§å¯†å¯¹åº”è®¡ç®—æœºçš„ç¡¬ä»¶ç»“æž„ï¼Œç¼–ç¨‹è€…éœ€è¦äº†è§£å…·ä½“çš„è®¡ç®—æœºæž¶æž„ï¼Œé€‚åˆç¼–å†™æ“ä½œç³»ç»Ÿã€é©±åŠ¨ç¨‹åºå’ŒåµŒå…¥å¼ç³»ç»Ÿã€‚&lt;/li&gt;
&lt;li&gt;é«˜çº§è¯­è¨€å±‚ï¼ˆHigh-Level Languages Levelï¼‰&lt;br&gt;
è§£é‡Šï¼šé«˜çº§è¯­è¨€ï¼ˆå¦‚ Cã€C++ã€Java ç­‰ï¼‰æä¾›äº†æ›´æŠ½è±¡ã€æ›´äººæ€§åŒ–çš„è¯­æ³•å’Œç»“æž„ï¼Œä½¿å¾—ç¼–ç¨‹è€…å¯ä»¥æ›´è½»æ¾åœ°ç¼–å†™å¤æ‚çš„ç¨‹åºã€‚è¿™äº›è¯­è¨€ä¸­çš„ä»£ç é€šè¿‡ç¼–è¯‘å™¨è½¬æ¢æˆæœºå™¨ç ã€‚&lt;br&gt;
ç‰¹ç‚¹ï¼šé«˜çº§è¯­è¨€é€šå¸¸å…·æœ‰è‰¯å¥½çš„è·¨å¹³å°æ€§å’Œå¯ç§»æ¤æ€§ï¼Œç¼–ç¨‹æ•ˆçŽ‡é«˜ï¼Œé€‚åˆå¼€å‘åº”ç”¨ç¨‹åºå’Œå¤§åž‹è½¯ä»¶ç³»ç»Ÿã€‚&lt;/li&gt;
&lt;li&gt;è§£é‡Šåž‹è¯­è¨€å±‚ï¼ˆInterpreted Languages Levelï¼‰&lt;br&gt;
è§£é‡Šï¼šè§£é‡Šåž‹è¯­è¨€ï¼ˆå¦‚ Pythonã€JavaScriptï¼‰ä¸æ˜¯ç›´æŽ¥ç¼–è¯‘æˆæœºå™¨ç ï¼Œè€Œæ˜¯å…ˆè¢«ç¿»è¯‘æˆå­—èŠ‚ç ï¼Œç„¶åŽåœ¨è§£é‡Šå™¨ä¸­æ‰§è¡Œã€‚&lt;br&gt;
ç‰¹ç‚¹ï¼šè§£é‡Šåž‹è¯­è¨€æ›´çµæ´»ï¼Œé€‚åˆå¿«é€Ÿå¼€å‘å’ŒåŽŸåž‹è®¾è®¡ï¼Œä½†æ‰§è¡Œé€Ÿåº¦é€šå¸¸æ¯”ç¼–è¯‘åž‹è¯­è¨€æ…¢ã€‚&lt;/li&gt;
&lt;li&gt;å­—èŠ‚ç å±‚ï¼ˆBytecode Levelï¼‰&lt;br&gt;
è§£é‡Šï¼šå­—èŠ‚ç æ˜¯é«˜çº§è¯­è¨€åœ¨è¢«è§£é‡Šæ‰§è¡Œä¹‹å‰çš„ä¸­é—´å½¢å¼ã€‚è§£é‡Šå™¨å°†å­—èŠ‚ç ç¿»è¯‘ä¸ºæœºå™¨å¯ä»¥æ‰§è¡Œçš„æŒ‡ä»¤ã€‚&lt;br&gt;
ç‰¹ç‚¹ï¼šå­—èŠ‚ç çš„è®¾è®¡é€šå¸¸ä¸Žç¡¬ä»¶æ— å…³ï¼Œå¯ä»¥åœ¨ä¸åŒçš„å¹³å°ä¸Šè¢«ç›¸åŒçš„è§£é‡Šå™¨æ‰§è¡Œï¼Œä¾‹å¦‚ Java å’Œ Python çš„è™šæ‹Ÿæœºï¼ˆJVMã€Python Interpreterï¼‰éƒ½ä½¿ç”¨å­—èŠ‚ç ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img data-src=&#34;https://img.picui.cn/free/2024/10/25/671b4d8733f64.png&#34; alt=&#34;img&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;Assembly&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Assembly&#34;&gt;#&lt;/a&gt; Assembly&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;æ±‡ç¼–è¯­è¨€ï¼ˆAssembly Languageï¼‰ æ˜¯ä¸€ç§ä½Žçº§ç¼–ç¨‹è¯­è¨€ï¼Œå®ƒä¸Žè®¡ç®—æœºçš„æœºå™¨ç æœ‰ç€ä¸€ä¸€å¯¹åº”çš„å…³ç³»ï¼Œå¹¶ä¸”æ¯”æœºå™¨ç æ›´æ˜“äºŽäººç±»ç†è§£å’Œç¼–å†™ã€‚ä»¥ä¸‹æ˜¯å¯¹æ±‡ç¼–è¯­è¨€åŠç›¸å…³æ¦‚å¿µçš„è¯¦ç»†ä¸­æ–‡è§£é‡Šï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æ±‡ç¼–è¯­è¨€çš„å®šä¹‰&lt;br&gt;
æ±‡ç¼–è¯­è¨€æ˜¯æœ€æŽ¥è¿‘æœºå™¨ç çš„é«˜çº§è¯­è¨€ï¼Œå®ƒå¯ä»¥å°†æœºå™¨æŒ‡ä»¤ç”¨äººç±»å¯è¯»çš„åŠ©è®°ç¬¦ï¼ˆå¦‚ MOVã€ADDã€JMP ç­‰ï¼‰æ¥è¡¨ç¤ºã€‚è¿™ä½¿å¾—ç¨‹åºå‘˜èƒ½å¤Ÿç›´æŽ¥æŽ§åˆ¶ç¡¬ä»¶ï¼ŒåŒæ—¶æ¯”ç›´æŽ¥ç¼–å†™äºŒè¿›åˆ¶ä»£ç æ›´åŠ æ–¹ä¾¿ã€‚&lt;/li&gt;
&lt;li&gt;ä¸Žæœºå™¨ç çš„å…³ç³»&lt;br&gt;
æ±‡ç¼–è¯­è¨€æ˜¯æœ€å¯é çš„ã€å¯ä»¥ä»Žæœºå™¨ç ä¸­æ¢å¤çš„é«˜çº§è¯­è¨€ã€‚å¦‚æžœé«˜å±‚è¯­è¨€çš„æºä»£ç ä¸å¯ç”¨æ—¶ï¼Œé€šè¿‡åæ±‡ç¼–ï¼ˆdisassemblyï¼‰ï¼Œå¯ä»¥å°†æœºå™¨ç è½¬æ¢å›žå¯¹åº”çš„æ±‡ç¼–ä»£ç ã€‚&lt;br&gt;
æ±‡ç¼–è¯­è¨€å’Œæœºå™¨ç ä¹‹é—´çš„å¯¹åº”å…³ç³»ä½¿å¾—ç¨‹åºå‘˜å¯ä»¥æ¸…æ¥šåœ°äº†è§£è®¡ç®—æœºåº•å±‚çš„æ‰§è¡Œé€»è¾‘å’Œæµç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;è„†å¼±ä»£ç å’Œæ¶æ„è½¯ä»¶çš„å­˜å‚¨å½¢å¼&lt;br&gt;
åœ¨å†…å­˜æˆ–ç£ç›˜ä¸­ï¼Œè„†å¼±ä»£ç æˆ–æ¶æ„è½¯ä»¶é€šå¸¸ä»¥äºŒè¿›åˆ¶å½¢å¼ï¼ˆå³æœºå™¨ç ï¼‰å­˜å‚¨ã€‚è¿™ç§å½¢å¼æ˜¯è®¡ç®—æœºç›´æŽ¥æ‰§è¡Œçš„ä»£ç ï¼Œä½†å¯¹äººç±»è€Œè¨€ä¸å¯è¯»ã€‚&lt;/li&gt;
&lt;li&gt;åæ±‡ç¼–å™¨çš„ä½œç”¨&lt;br&gt;
åæ±‡ç¼–å™¨æ˜¯ä¸€ç§å·¥å…·ï¼Œå®ƒä»¥äºŒè¿›åˆ¶ä»£ç ä¸ºè¾“å…¥ï¼Œå¹¶å°†å…¶ç¿»è¯‘æˆç›¸åº”çš„æ±‡ç¼–ä»£ç è¾“å‡ºã€‚é€šè¿‡åæ±‡ç¼–ï¼Œå¯ä»¥å°†æœºå™¨ç è¿˜åŽŸä¸ºäººç±»å¯è¯»çš„æ±‡ç¼–è¯­è¨€ï¼Œæœ‰åŠ©äºŽåˆ†æžå’Œè°ƒè¯•ç¨‹åºï¼Œç‰¹åˆ«æ˜¯åœ¨é€†å‘å·¥ç¨‹æˆ–å®‰å…¨åˆ†æžä¸­ã€‚&lt;/li&gt;
&lt;li&gt;æ±‡ç¼–è¯­è¨€æ˜¯å¤šç§è¯­è¨€çš„é›†åˆ&lt;br&gt;
æ±‡ç¼–è¯­è¨€å®žé™…ä¸Šæ˜¯å¤šç§è¯­è¨€çš„é›†åˆï¼Œå› ä¸ºä¸åŒçš„è®¡ç®—æœºæž¶æž„ï¼ˆå¦‚ x86ã€ARMã€MIPS ç­‰ï¼‰æœ‰å„è‡ªç‹¬ç‰¹çš„æŒ‡ä»¤é›†å’Œæ±‡ç¼–è¯­è¨€æ ¼å¼ã€‚&lt;br&gt;
åœ¨å­¦ä¹ å’Œä½¿ç”¨æ±‡ç¼–è¯­è¨€æ—¶ï¼Œé€šå¸¸ä¼šé’ˆå¯¹ç‰¹å®šçš„è®¡ç®—æœºæž¶æž„è¿›è¡Œæ·±å…¥ç ”ç©¶ã€‚ä¾‹å¦‚ï¼Œx86 æ±‡ç¼–å’Œ ARM æ±‡ç¼–åœ¨æŒ‡ä»¤é›†ã€å¯„å­˜å™¨ä½¿ç”¨å’ŒæŒ‡ä»¤æ ¼å¼ä¸Šéƒ½æœ‰æ˜Žæ˜¾çš„ä¸åŒã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img data-src=&#34;https://img.picui.cn/free/2024/10/25/671b4f21f3929.png&#34; alt=&#34;img&#34;&gt;&lt;br&gt;
 æ•´ä¸ªè¿‡ç¨‹ä»Žæ±‡ç¼–è¯­è¨€ï¼ˆasm æ–‡ä»¶ï¼‰å¼€å§‹ï¼Œé€šè¿‡æ±‡ç¼–å™¨ç”Ÿæˆç›®æ ‡æ–‡ä»¶ï¼Œå†é€šè¿‡é“¾æŽ¥å™¨å°†ç›®æ ‡æ–‡ä»¶å’Œåº“æ–‡ä»¶ç»“åˆç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ï¼Œæœ€åŽå°†å¯æ‰§è¡Œæ–‡ä»¶åŠ è½½åˆ°å†…å­˜ä¸­è¿è¡Œ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ±‡ç¼–å™¨ï¼ˆAssemblerï¼‰&lt;br&gt;
æ±‡ç¼–å™¨çš„ä½œç”¨æ˜¯å°†æ±‡ç¼–è¯­è¨€çš„ä»£ç ï¼ˆasm æ–‡ä»¶ï¼‰ç¿»è¯‘æˆç›®æ ‡æ–‡ä»¶ï¼ˆobject fileï¼‰ã€‚ç›®æ ‡æ–‡ä»¶æ˜¯äºŒè¿›åˆ¶å½¢å¼çš„æ–‡ä»¶ï¼ŒåŒ…å«äº†æœºå™¨å¯ä»¥ç†è§£çš„æŒ‡ä»¤å’Œæ•°æ®ï¼Œä½†è¿˜ä¸æ˜¯å®Œæ•´çš„å¯æ‰§è¡Œç¨‹åºã€‚&lt;/li&gt;
&lt;li&gt;é“¾æŽ¥å™¨ï¼ˆLinkerï¼‰&lt;br&gt;
é“¾æŽ¥å™¨çš„ä½œç”¨æ˜¯å°†å¤šä¸ªç›®æ ‡æ–‡ä»¶å’Œåº“æ–‡ä»¶ï¼ˆå¦‚é™æ€åº“æˆ–åŠ¨æ€åº“ï¼‰ç»„åˆèµ·æ¥ï¼Œç”Ÿæˆä¸€ä¸ªå®Œæ•´çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆExecutableï¼‰ã€‚&lt;br&gt;
é™æ€åº“ï¼ˆStatic Libraryï¼‰ï¼šé™æ€åº“ä¸­çš„ä»£ç åœ¨ç¼–è¯‘æœŸé—´ç›´æŽ¥è¢«é“¾æŽ¥åˆ°å¯æ‰§è¡Œæ–‡ä»¶ä¸­ã€‚&lt;br&gt;
åŠ¨æ€åº“ï¼ˆDynamic Libraryï¼‰ï¼šåŠ¨æ€åº“ä¸­çš„ä»£ç åœ¨è¿è¡Œæ—¶è¢«åŠ è½½åˆ°å†…å­˜ä¸­ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Assembler vs. Compiler&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;ç¼–è¯‘å™¨ (Compiler) vs. æ±‡ç¼–å™¨ (Assembler)&lt;br&gt;
 ç¼–è¯‘å™¨ï¼šå°†é«˜çº§ç¼–ç¨‹è¯­è¨€çš„ä»£ç ï¼ˆå¦‚ Cã€C++ã€Java ç­‰ï¼‰è½¬æ¢ä¸ºæœºå™¨çº§ä»£ç ã€‚&lt;br&gt;
æ±‡ç¼–å™¨ï¼šå°†æ±‡ç¼–è¯­è¨€çš„ä»£ç è½¬æ¢ä¸ºæœºå™¨çº§ä»£ç ã€‚&lt;/li&gt;
&lt;li&gt;è¾“å…¥&lt;br&gt;
ç¼–è¯‘å™¨ï¼šä»¥é«˜çº§è¯­è¨€çš„æºä»£ç ä¸ºè¾“å…¥ã€‚&lt;br&gt;
æ±‡ç¼–å™¨ï¼šä»¥æ±‡ç¼–è¯­è¨€çš„ä»£ç ä¸ºè¾“å…¥ã€‚&lt;/li&gt;
&lt;li&gt;è½¬æ¢æ–¹å¼&lt;br&gt;
ç¼–è¯‘å™¨ï¼šä¼šæ£€æŸ¥å¹¶ä¸€æ¬¡æ€§å°†æ•´ä¸ªä»£ç è½¬æ¢ä¸ºæœºå™¨ä»£ç ã€‚&lt;br&gt;
æ±‡ç¼–å™¨ï¼šä¸€èˆ¬ä¸ä¸€æ¬¡æ€§è½¬æ¢å®Œæ•´ä»£ç ï¼Œè€Œæ˜¯åˆ†ä¸¤æ­¥å¤„ç†ã€‚&lt;/li&gt;
&lt;li&gt;å†…éƒ¨æ¨¡å—&lt;br&gt;
ç¼–è¯‘å™¨ï¼šåŒ…å«è¯æ³•åˆ†æžå™¨ã€è¯­æ³•åˆ†æžå™¨ã€è¯­ä¹‰åˆ†æžå™¨ã€ä»£ç ä¼˜åŒ–å™¨å’Œä»£ç ç”Ÿæˆå™¨ç­‰æ¨¡å—ã€‚(lexical analyzer, Syntax analyzer, Semantic analyzer, Code optimizer, Code generator)&lt;br&gt;
 æ±‡ç¼–å™¨ï¼šåœ¨ä¸¤æ¬¡æ‰«æä¸­å®Œæˆæ‰€æœ‰å·¥ä½œã€‚&lt;/li&gt;
&lt;li&gt;è¾“å‡ºç»“æžœ&lt;br&gt;
ç¼–è¯‘å™¨ï¼šè¾“å‡ºçš„æ˜¯æœºå™¨ä»£ç çš„åŠ©è®°ç¬¦ (Mnemonic) ç‰ˆæœ¬ã€‚&lt;br&gt;
æ±‡ç¼–å™¨ï¼šè¾“å‡ºçš„æ˜¯æœºå™¨ä»£ç çš„äºŒè¿›åˆ¶ç‰ˆæœ¬ã€‚&lt;/li&gt;
&lt;li&gt;å¸¸è§ç±»åž‹&lt;br&gt;
ç¼–è¯‘å™¨ï¼šå¦‚ Cã€C++ã€Java çš„ç¼–è¯‘å™¨ã€‚&lt;br&gt;
æ±‡ç¼–å™¨ï¼šå¦‚ GASï¼ˆGNU Assemblerï¼‰ã€GNU æ±‡ç¼–å™¨&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Two main forms of assembly syntax&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;NASM format: &lt;instr&gt; &lt;dest&gt;, &lt;source&gt; &amp;lt;; comment&amp;gt; : mov eax, 10&lt;/li&gt;
&lt;li&gt;AT&amp;amp;T format:  &lt;instr&gt; &lt;source&gt;, &lt;dest&gt; &amp;lt;# comment&amp;gt;: mov $10, %eax&lt;br&gt;
AT&amp;amp;T format reverses the order of operands, uses a % before registers and a $ before literal values&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;Fundamental Data Types&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img data-src=&#34;https://img.picui.cn/free/2024/10/25/671b528c52025.png&#34; alt=&#34;img&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Byteï¼ˆå­—èŠ‚ï¼‰&lt;br&gt;
å¤§å°ï¼š1 å­—èŠ‚ = 8 ä½ï¼ˆbitï¼‰ã€‚&lt;br&gt;
ç¤ºä¾‹ï¼šå›¾ä¸­å±•ç¤ºçš„ 5D æ˜¯ä¸€ä¸ª 8 ä½çš„äºŒè¿›åˆ¶æ•°ï¼ˆ01011101ï¼‰ï¼Œå®ƒå¯ä»¥ç”¨ä¸€ä¸ªå­—èŠ‚æ¥è¡¨ç¤ºã€‚&lt;br&gt;
è§£é‡Šï¼šä¸€ä¸ªå­—èŠ‚çš„äºŒè¿›åˆ¶ä½å¯ä»¥è¡¨ç¤º 0 åˆ° 255 ä¹‹é—´çš„æ•´æ•°ï¼ˆæ— ç¬¦å·ï¼‰ï¼Œæˆ– -128 åˆ° 127 ä¹‹é—´çš„æ•´æ•°ï¼ˆæœ‰ç¬¦å·ï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Wordï¼ˆå­—ï¼‰&lt;br&gt;
å¤§å°ï¼š2 å­—èŠ‚ = 16 ä½ï¼ˆbitï¼‰ã€‚&lt;br&gt;
ç¤ºä¾‹ï¼šå›¾ä¸­å±•ç¤ºçš„ 8BEC è¡¨ç¤ºä¸€ä¸ª 16 ä½çš„äºŒè¿›åˆ¶æ•°ï¼Œå…¶ä¸­ï¼š&lt;br&gt;
é«˜å­—èŠ‚ï¼ˆHigh Byteï¼‰ï¼š8B&lt;br&gt;
 ä½Žå­—èŠ‚ï¼ˆLow Byteï¼‰ï¼šEC&lt;br&gt;
 è§£é‡Šï¼šä¸€ä¸ª Word å¯ä»¥è¡¨ç¤º 0 åˆ° 65535 ä¹‹é—´çš„æ— ç¬¦å·æ•´æ•°ï¼Œæˆ– -32768 åˆ° 32767 ä¹‹é—´çš„æœ‰ç¬¦å·æ•´æ•°ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Dwordï¼ˆåŒå­—ï¼‰&lt;br&gt;
å¤§å°ï¼š4 å­—èŠ‚ = 32 ä½ï¼ˆbitï¼‰ã€‚&lt;br&gt;
ç¤ºä¾‹ï¼šå›¾ä¸­å±•ç¤ºçš„ 000136CF è¡¨ç¤ºä¸€ä¸ª 32 ä½çš„äºŒè¿›åˆ¶æ•°ï¼Œå…¶ä¸­ï¼š&lt;br&gt;
é«˜å­—ï¼ˆHigh Wordï¼‰ï¼š0001&lt;br&gt;
 ä½Žå­—ï¼ˆLow Wordï¼‰ï¼š36CF&lt;br&gt;
 è§£é‡Šï¼šä¸€ä¸ª Dword å¯ä»¥è¡¨ç¤ºæ›´å¤§çš„æ•´æ•°èŒƒå›´ï¼Œç”¨äºŽå­˜å‚¨æ›´å¤§çš„æ•°å€¼æˆ–å†…å­˜åœ°å€ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Qwordï¼ˆå››å­—ï¼‰&lt;br&gt;
å¤§å°ï¼š8 å­—èŠ‚ = 64 ä½ï¼ˆbitï¼‰ã€‚&lt;br&gt;
ç¤ºä¾‹ï¼šå›¾ä¸­å±•ç¤ºçš„ CF000136CF è¡¨ç¤ºä¸€ä¸ª 64 ä½çš„äºŒè¿›åˆ¶æ•°ï¼Œå…¶ä¸­ï¼š&lt;br&gt;
é«˜åŒå­—ï¼ˆHigh Dwordï¼‰ï¼šCF00&lt;br&gt;
 ä½ŽåŒå­—ï¼ˆLow Dwordï¼‰ï¼š0136CF&lt;br&gt;
 è§£é‡Šï¼šä¸€ä¸ª Qword å¯ä»¥è¡¨ç¤ºæ›´å¤§çš„æ•´æ•°æˆ–æµ®ç‚¹æ•°èŒƒå›´ï¼Œå¸¸ç”¨äºŽ 64 ä½å¤„ç†å™¨ä¸Šçš„è¿ç®—ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Data in Memory&lt;br&gt;
Little-endian format: a low-order byte is stored at the lower address&lt;br&gt;
&lt;img data-src=&#34;https://img.picui.cn/free/2024/10/25/671b538e3e57f.png&#34; alt=&#34;img&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;CPU Registers&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#CPU Registers&#34;&gt;#&lt;/a&gt;CPU Registers&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;CPU å¯„å­˜å™¨æ˜¯ CPU å†…éƒ¨çš„ä¸€å°éƒ¨åˆ†æ•°æ®å­˜å‚¨å•å…ƒï¼Œç”¨äºŽæš‚å­˜æŒ‡ä»¤ã€æ•°æ®å’ŒçŠ¶æ€ä¿¡æ¯ã€‚å¯„å­˜å™¨æ˜¯ CPU ä¸­é€Ÿåº¦æœ€å¿«çš„å­˜å‚¨å•å…ƒï¼Œæ¯”å…¶ä»–å­˜å‚¨è®¾å¤‡ï¼ˆå¦‚ RAMã€ç¡¬ç›˜ï¼‰å¿«å¾—å¤šï¼Œå› ä¸ºå®ƒä»¬ä½äºŽ CPU å†…éƒ¨ï¼Œèƒ½å¤Ÿå¿«é€Ÿè¯»å†™æ•°æ®ã€‚&lt;br&gt;
CPU å¯„å­˜å™¨çš„ç±»åž‹&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;é€šç”¨å¯„å­˜å™¨ï¼ˆGeneral Registersï¼‰&lt;br&gt;
ç”¨é€”ï¼šåœ¨ç¨‹åºæ‰§è¡ŒæœŸé—´ç”± CPU ä½¿ç”¨ï¼Œç”¨äºŽå­˜å‚¨æ•°æ®ã€æ“ä½œæ•°å’Œä¸´æ—¶ç»“æžœã€‚&lt;br&gt;
åŠŸèƒ½ï¼šå¯ä»¥ç”¨äºŽæ•´æ•°è¿ç®—ã€åœ°å€è¿ç®—å’Œæ•°æ®çš„ä¼ è¾“ï¼Œæ˜¯æœ€å¸¸ç”¨çš„å¯„å­˜å™¨ç±»åž‹ã€‚&lt;/li&gt;
&lt;li&gt;æ®µå¯„å­˜å™¨ï¼ˆSegment Registersï¼‰&lt;br&gt;
ç”¨é€”ï¼šç”¨äºŽç®¡ç†å’Œè·Ÿè¸ªå†…å­˜çš„ä¸åŒæ®µï¼ˆå¦‚ä»£ç æ®µã€æ•°æ®æ®µå’Œæ ˆæ®µï¼‰ã€‚&lt;br&gt;
åŠŸèƒ½ï¼šå¸®åŠ© CPU ç¡®å®šå†…å­˜è®¿é—®çš„å…·ä½“åŒºåŸŸï¼Œä½¿å¾—å†…å­˜åˆ†æ®µç®¡ç†æ›´åŠ é«˜æ•ˆã€‚&lt;/li&gt;
&lt;li&gt;çŠ¶æ€æ ‡å¿—ï¼ˆStatus Flagsï¼‰&lt;br&gt;
ç”¨é€”ï¼šå­˜å‚¨ç¨‹åºæ‰§è¡Œçš„çŠ¶æ€ä¿¡æ¯ï¼Œä¾‹å¦‚è¿ç®—ç»“æžœæ˜¯æ­£ã€è´Ÿã€é›¶ï¼Œæˆ–æ˜¯å¦å‘ç”Ÿæº¢å‡ºç­‰ã€‚&lt;br&gt;
åŠŸèƒ½ï¼šåœ¨ CPU è¿›è¡Œæ¡ä»¶åˆ¤æ–­æˆ–å†³ç­–æ—¶æä¾›å¿…è¦çš„ä¿¡æ¯æ”¯æŒï¼Œå†³å®šç¨‹åºçš„æ‰§è¡Œè·¯å¾„ã€‚&lt;/li&gt;
&lt;li&gt;æŒ‡ä»¤æŒ‡é’ˆï¼ˆInstruction Pointersï¼‰&lt;br&gt;
ç”¨é€”ï¼šç”¨äºŽè·Ÿè¸ªä¸‹ä¸€æ¡å°†è¦æ‰§è¡Œçš„æŒ‡ä»¤çš„åœ°å€ã€‚&lt;br&gt;
åŠŸèƒ½ï¼šç¡®ä¿ç¨‹åºçš„æŒ‡ä»¤æŒ‰é¡ºåºæ‰§è¡Œï¼Œæ˜¯æŽ§åˆ¶ç¨‹åºæµç¨‹çš„å…³é”®å¯„å­˜å™¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;x86 Registers
&lt;ol&gt;
&lt;li&gt;æ•°æ®å¯„å­˜å™¨ï¼ˆData Registersï¼‰
&lt;ul&gt;
&lt;li&gt;EAXï¼ˆç´¯åŠ å™¨ï¼‰ï¼šä¸»è¦ç”¨äºŽè¾“å…¥ / è¾“å‡ºå’Œå¤§å¤šæ•°ç®—æœ¯è¿ç®—ã€‚ä¾‹å¦‚ï¼ŒåŠ æ³•ã€å‡æ³•ã€ä¹˜æ³•å’Œé™¤æ³•æ“ä½œæ—¶ï¼Œé€šå¸¸ä¼šç”¨åˆ° EAXã€‚&lt;/li&gt;
&lt;li&gt;EBXï¼ˆåŸºå€å¯„å­˜å™¨ï¼‰ï¼šå¯ç”¨äºŽç´¢å¼•å¯»å€æ¨¡å¼ï¼Œå³åœ¨è®¿é—®æ•°ç»„æˆ–ç»“æž„ä¸­çš„å…ƒç´ æ—¶ï¼ŒEBX å¯ä»¥ä½œä¸ºåŸºå€å¯„å­˜å™¨ä½¿ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;ECXï¼ˆè®¡æ•°å¯„å­˜å™¨ï¼‰ï¼šåœ¨å¾ªçŽ¯æ“ä½œä¸­å­˜å‚¨å¾ªçŽ¯è®¡æ•°ï¼Œé€šå¸¸ç”¨äºŽå®žçŽ°è¿­ä»£æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;EDXï¼ˆæ•°æ®å¯„å­˜å™¨ï¼‰ï¼šä¹Ÿç”¨äºŽè¾“å…¥ / è¾“å‡ºæ“ä½œï¼Œæœ‰æ—¶ä¸Ž AX ä¸€èµ·ä½¿ç”¨ï¼Œä¾‹å¦‚åœ¨æŸäº›ä¹˜æ³•å’Œé™¤æ³•è¿ç®—ä¸­ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ç´¢å¼•å¯„å­˜å™¨ï¼ˆIndex Registersï¼‰
&lt;ul&gt;
&lt;li&gt;ESIï¼ˆæºç´¢å¼•ï¼‰ï¼šç”¨äºŽå­—ç¬¦ä¸²æ“ä½œçš„æºç´¢å¼•ï¼Œé€šå¸¸åœ¨æ•°æ®çš„è¯»å–æ“ä½œä¸­ä½¿ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;EDIï¼ˆç›®æ ‡ç´¢å¼•ï¼‰ï¼šç”¨äºŽå­—ç¬¦ä¸²æ“ä½œçš„ç›®æ ‡ç´¢å¼•ï¼Œé€šå¸¸åœ¨æ•°æ®çš„å†™å…¥æ“ä½œä¸­ä½¿ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æ®µå¯„å­˜å™¨ï¼ˆSegment Registersï¼‰
&lt;ul&gt;
&lt;li&gt;CSï¼ˆä»£ç æ®µå¯„å­˜å™¨ï¼‰ï¼šæŒ‡å‘åŒ…å«æ‰€æœ‰å°†è¦æ‰§è¡Œçš„æŒ‡ä»¤çš„ä»£ç æ®µã€‚&lt;/li&gt;
&lt;li&gt;DSï¼ˆæ•°æ®æ®µå¯„å­˜å™¨ï¼‰ï¼šæŒ‡å‘åŒ…å«å…¨å±€æ•°æ®ã€å¸¸é‡å’Œå·¥ä½œåŒºçš„æ•°æ®æ®µã€‚&lt;/li&gt;
&lt;li&gt;SSï¼ˆæ ˆæ®µå¯„å­˜å™¨ï¼‰ï¼šæŒ‡å‘åŒ…å«å±€éƒ¨æ•°æ®å’Œè¿‡ç¨‹æˆ–å­ç¨‹åºè¿”å›žåœ°å€çš„æ ˆæ®µã€‚&lt;/li&gt;
&lt;li&gt;å…¶ä»–æ®µå¯„å­˜å™¨ï¼ˆESã€FSã€GSï¼‰ï¼šæä¾›é¢å¤–çš„æ•°æ®å­˜å‚¨æ®µï¼Œç”¨äºŽå­˜æ”¾å…¶ä»–ç±»åž‹çš„æ•°æ®ã€‚&lt;br&gt;
åœ¨æ®µå†…çš„æ‰€æœ‰å†…å­˜ä½ç½®éƒ½ç›¸å¯¹äºŽæ®µçš„èµ·å§‹åœ°å€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;çŠ¶æ€å¯„å­˜å™¨ï¼ˆStatus Registerï¼‰
&lt;ul&gt;
&lt;li&gt;EFLAGS å¯„å­˜å™¨ï¼šç”¨äºŽå­˜å‚¨å¤„ç†å™¨çš„çŠ¶æ€æ ‡å¿—ï¼Œæ¯ä¸ªæ ‡å¿—ä½è¡¨ç¤ºä¸åŒçš„çŠ¶æ€æˆ–æ¡ä»¶ï¼š&lt;/li&gt;
&lt;li&gt;ZFï¼ˆé›¶æ ‡å¿—ï¼‰ï¼šå½“è¿ç®—ç»“æžœä¸ºé›¶æ—¶è®¾ç½®ã€‚&lt;/li&gt;
&lt;li&gt;CFï¼ˆè¿›ä½æ ‡å¿—ï¼‰ï¼šå½“è¿ç®—ç»“æžœè¿‡å¤§æˆ–è¿‡å°æ—¶è®¾ç½®ã€‚&lt;/li&gt;
&lt;li&gt;SFï¼ˆç¬¦å·æ ‡å¿—ï¼‰ï¼šå½“è¿ç®—ç»“æžœä¸ºè´Ÿæ—¶è®¾ç½®ã€‚&lt;/li&gt;
&lt;li&gt;TFï¼ˆé™·é˜±æ ‡å¿—ï¼‰ï¼šç”¨äºŽè°ƒè¯•ï¼Œè®¾ç½®è¯¥æ ‡å¿—æ—¶ï¼Œå¤„ç†å™¨ä¸€æ¬¡åªæ‰§è¡Œä¸€æ¡æŒ‡ä»¤ã€‚é€šå¸¸è¢«è°ƒè¯•å·¥å…·ï¼ˆå¦‚ GDBï¼‰ä½¿ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æŒ‡ä»¤æŒ‡é’ˆï¼ˆInstruction Pointer, EIPï¼‰ä¹Ÿç§°ä¸ºç¨‹åºè®¡æ•°å™¨ï¼Œå®ƒåŒ…å«ä¸‹ä¸€æ¡å°†è¢«æ‰§è¡Œçš„æŒ‡ä»¤çš„åç§»åœ°å€ã€‚
&lt;ul&gt;
&lt;li&gt;EIP çš„å”¯ä¸€ç›®çš„æ˜¯å‘Šè¯‰å¤„ç†å™¨ä¸‹ä¸€æ­¥è¦æ‰§è¡Œä»€ä¹ˆæŒ‡ä»¤ã€‚&lt;/li&gt;
&lt;li&gt;å½“å‰æŒ‡ä»¤çš„å®Œæ•´åœ°å€ä¸º CS:EIPï¼ˆä»£ç æ®µå¯„å­˜å™¨åŠ æŒ‡ä»¤æŒ‡é’ˆï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æžœæ”»å‡»è€…èƒ½å¤ŸæŽ§åˆ¶ EIPï¼Œä»–ä»¬å°±èƒ½æŽ§åˆ¶ CPU çš„æ‰§è¡Œæµç¨‹ï¼Œå› æ­¤ EIP æ˜¯å¸¸è§æ”»å‡»ï¼ˆå¦‚ç¼“å†²åŒºæº¢å‡ºï¼‰çš„ç›®æ ‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;å…¶ä»–æŒ‡é’ˆå¯„å­˜å™¨ï¼ˆOther Pointer Registersï¼‰
&lt;ul&gt;
&lt;li&gt;ESPï¼ˆæ ˆæŒ‡é’ˆå¯„å­˜å™¨ï¼‰ï¼šæä¾›ç¨‹åºæ ˆä¸­çš„åç§»å€¼ï¼ŒSS:ESP è¡¨ç¤ºæ ˆé¡¶ï¼ˆå½“å‰æ•°æ®æˆ–åœ°å€åœ¨ç¨‹åºæ ˆä¸­çš„ä½ç½®ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;EBPï¼ˆåŸºå€æŒ‡é’ˆå¯„å­˜å™¨ï¼‰ï¼šä¸»è¦ç”¨äºŽå¼•ç”¨ä¼ é€’ç»™å­ç¨‹åºçš„å‚æ•°å˜é‡ï¼ˆå¦‚å‡½æ•°è°ƒç”¨ï¼‰ã€‚SS:EBP è¡¨ç¤ºå½“å‰è°ƒç”¨çš„æ ˆå¸§ (stack frame)ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;Assembly basics&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Assembly basics&#34;&gt;#&lt;/a&gt; Assembly basics&lt;/h1&gt;
&lt;h2 id=&#34;Simple Instructions&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Simple Instructions&#34;&gt;#&lt;/a&gt;Simple Instructions&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;mov instruction&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img data-src=&#34;https://img.picui.cn/free/2024/10/25/671b589f37dc7.png&#34; alt=&#34;img&#34;&gt;&lt;/p&gt;
&lt;p&gt;lea (load effective address) instruction puts a memory address into the&lt;br&gt;
destination&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;e.g. lea eax, [ebx+8] puts EBX+8 into EAX&lt;/li&gt;
&lt;li&gt;e.g. mov eax, [ebx+8] loads the data at the memory address EBX+8&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img data-src=&#34;https://img.picui.cn/free/2024/10/25/671b595145504.png&#34; alt=&#34;img&#34;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;mov eax, [ebx+8] places the value 0x20 into EAX&lt;/li&gt;
&lt;li&gt;lea eax, [ebx+8] places the value 0xB30048 into EAX&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Arithmetic&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;sub eax, 0x10&lt;br&gt;
 æè¿°ï¼šä»Žå¯„å­˜å™¨ EAX ä¸­å‡åŽ» 0x10ï¼ˆåå…­è¿›åˆ¶çš„ 16ï¼‰ã€‚&lt;br&gt;
ç»“æžœï¼šEAX çš„å€¼å‡å°‘ 16ã€‚&lt;/li&gt;
&lt;li&gt;add eax, ebx&lt;br&gt;
 æè¿°ï¼šå°†å¯„å­˜å™¨ EBX çš„å€¼åŠ åˆ° EAX ä¸­ï¼Œå¹¶å°†ç»“æžœå­˜å‚¨åœ¨ EAX ä¸­ã€‚&lt;br&gt;
ç»“æžœï¼šEAX = EAX + EBXã€‚&lt;/li&gt;
&lt;li&gt;inc edx&lt;br&gt;
 æè¿°ï¼šå°†å¯„å­˜å™¨ EDX çš„å€¼åŠ  1ã€‚&lt;br&gt;
ç»“æžœï¼šEDX çš„å€¼å¢žåŠ  1ã€‚&lt;/li&gt;
&lt;li&gt;dec ecx&lt;br&gt;
 æè¿°ï¼šå°†å¯„å­˜å™¨ ECX çš„å€¼å‡ 1ã€‚&lt;br&gt;
ç»“æžœï¼šECX çš„å€¼å‡å°‘ 1ã€‚&lt;/li&gt;
&lt;li&gt;mul 0x50&lt;br&gt;
 æè¿°ï¼šå°†å¯„å­˜å™¨ EAX çš„å€¼ä¹˜ä»¥ 0x50ï¼ˆåå…­è¿›åˆ¶çš„ 80ï¼‰ï¼Œå¹¶å°†ç»“æžœå­˜å‚¨åœ¨ EDX&lt;br&gt;
 ä¸­ã€‚&lt;br&gt;
ç»“æžœï¼šEAX ä¸­å­˜å‚¨ä½Ž 32 ä½çš„ä¹˜ç§¯ï¼ŒEDX ä¸­å­˜å‚¨é«˜ 32 ä½çš„ä¹˜ç§¯ã€‚&lt;/li&gt;
&lt;li&gt;div 0x75&lt;br&gt;
 æè¿°ï¼šç”¨å¯„å­˜å™¨ EDX&lt;br&gt;
ï¼ˆå°† EDX å’Œ EAX ç»“åˆèµ·æ¥ï¼Œè¡¨ç¤º 64 ä½çš„æ•°å€¼ï¼‰é™¤ä»¥ 0x75ï¼ˆåå…­è¿›åˆ¶çš„ 117ï¼‰ã€‚&lt;br&gt;
ç»“æžœï¼šå•†å­˜å‚¨åœ¨ EAX ä¸­ï¼Œä½™æ•°å­˜å‚¨åœ¨ EDX ä¸­ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Logics&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;xor eax, eax&lt;br&gt;
 æè¿°ï¼šå°†å¯„å­˜å™¨ EAX å’Œè‡ªèº«è¿›è¡Œå¼‚æˆ–æ“ä½œï¼Œæ¸…é™¤ EAX ä¸­çš„å€¼ï¼ˆå³å°† EAX ç½®ä¸º 0ï¼‰ã€‚&lt;br&gt;
ç»“æžœï¼šEAX = 0ã€‚&lt;/li&gt;
&lt;li&gt;or eax, 0x7575&lt;br&gt;
 æè¿°ï¼šå¯¹ EAX å¯„å­˜å™¨å’Œ 0x7575 è¿›è¡Œé€»è¾‘æˆ–ï¼ˆORï¼‰æ“ä½œã€‚&lt;br&gt;
ç»“æžœï¼šEAX çš„æ¯ä¸ªä½éƒ½ä¸Ž 0x7575 çš„ç›¸åº”ä½è¿›è¡Œæˆ–æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;mov eax, 0xA å’Œ shl eax, 2&lt;br&gt;
mov eax, 0xAï¼šå°† EAX è®¾ç½®ä¸º 0xAï¼ˆåå…­è¿›åˆ¶çš„ 10ï¼‰ã€‚&lt;br&gt;
shl eax, 2ï¼šå°† EAX å¯„å­˜å™¨ä¸­çš„å€¼å·¦ç§» 2 ä½ã€‚&lt;br&gt;
ç»“æžœï¼šEAX çš„å€¼å˜ä¸º 0x28ï¼ˆåå…­è¿›åˆ¶çš„ 40ï¼‰ï¼Œå› ä¸ºäºŒè¿›åˆ¶çš„ 1010 å·¦ç§» 2 ä½å˜ä¸º 101000ã€‚&lt;/li&gt;
&lt;li&gt;mov bl, 0xA å’Œ ror bl, 2&lt;br&gt;
mov bl, 0xAï¼šå°† BL è®¾ç½®ä¸º 0xAï¼ˆåå…­è¿›åˆ¶çš„ 10ï¼‰ã€‚&lt;br&gt;
ror bl, 2ï¼šå°† BL å¯„å­˜å™¨ä¸­çš„å€¼å³æ—‹ 2 ä½ã€‚&lt;br&gt;
ç»“æžœï¼šBL çš„å€¼å˜ä¸º 10000010ï¼Œå› ä¸ºäºŒè¿›åˆ¶çš„ 1010 å³æ—‹ 2 ä½å˜ä¸º 10000010ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;nop&lt;br&gt;
 æè¿°ï¼šNOP æŒ‡ä»¤ä¸æ‰§è¡Œä»»ä½•æ“ä½œï¼Œä»…ä»…è®©å¤„ç†å™¨ç»§ç»­æ‰§è¡Œä¸‹ä¸€æ¡æŒ‡ä»¤ã€‚&lt;br&gt;
ä½œç”¨ï¼šNOP å®žé™…ä¸Šæ˜¯ xchg eax, eax çš„ä¼ªæŒ‡ä»¤ï¼Œå› ä¸ºå°† EAX ä¸Žè‡ªèº«äº¤æ¢ä¸ä¼šæ”¹å˜ä»»ä½•å€¼ã€‚&lt;br&gt;
ç”¨é€”ï¼šåœ¨ç¼“å†²åŒºæº¢å‡ºæ”»å‡»ä¸­ï¼Œæ”»å‡»è€…å¸¸ä½¿ç”¨ NOP æŒ‡ä»¤æ¥å¡«å……æ”»å‡»ä»£ç ï¼Œä½¿å¾—æ‰§è¡Œå…·æœ‰ä¸€å®šçš„ç¼“å†²ç©ºé—´ã€‚NOP çš„æ“ä½œç æ˜¯ 0x90ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;The Stack&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#The Stack&#34;&gt;#&lt;/a&gt;The Stack&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;æ ˆçš„åŸºæœ¬æ¦‚å¿µ&lt;br&gt;
æ ˆ æ˜¯ä¸€ç§ åŽè¿›å…ˆå‡ºï¼ˆLIFOï¼‰ çš„æ•°æ®ç»“æž„ï¼Œè¿™æ„å‘³ç€æœ€åŽæ”¾å…¥çš„æ•°æ®å°†æ˜¯ç¬¬ä¸€ä¸ªè¢«å–å‡ºçš„ã€‚&lt;br&gt;
æ ˆé€šå¸¸ç”¨äºŽå­˜å‚¨å‡½æ•°è°ƒç”¨çš„å‚æ•°ã€å±€éƒ¨å˜é‡ã€è¿”å›žåœ°å€å’Œä¸€äº›æŽ§åˆ¶ä¿¡æ¯ã€‚&lt;br&gt;
æ ˆçš„ä¸»è¦å¯„å­˜å™¨åŒ…æ‹¬ï¼š&lt;br&gt;
ESPï¼ˆæ ˆæŒ‡é’ˆï¼‰ï¼šæŒ‡å‘å½“å‰æ ˆé¡¶ã€‚&lt;br&gt;
EBPï¼ˆåŸºå€æŒ‡é’ˆï¼‰ï¼šè·Ÿè¸ªå±€éƒ¨å˜é‡å’Œå‡½æ•°å‚æ•°çš„ä½ç½®ã€‚&lt;/li&gt;
&lt;li&gt;æ ˆæŒ‡ä»¤&lt;br&gt;
æ ˆæ“ä½œåŒ…æ‹¬ä»¥ä¸‹å‡ ç§å¸¸è§æŒ‡ä»¤ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;pushï¼šå°†æ•°æ®åŽ‹å…¥æ ˆä¸­ï¼ŒESP ä¼šå‡å°‘ï¼ˆæ ˆå‘ä¸‹å¢žé•¿ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;popï¼šä»Žæ ˆä¸­å¼¹å‡ºæ•°æ®ï¼ŒESP ä¼šå¢žåŠ ã€‚&lt;/li&gt;
&lt;li&gt;callï¼šè°ƒç”¨å‡½æ•°ï¼Œå°†å½“å‰æŒ‡ä»¤çš„åœ°å€åŽ‹å…¥æ ˆä¸­ï¼Œå¹¶è·³è½¬åˆ°æŒ‡å®šå‡½æ•°çš„ä½ç½®ã€‚&lt;/li&gt;
&lt;li&gt;leaveï¼šç”¨äºŽå‡½æ•°è¿”å›žæ—¶ï¼Œå°†æ ˆæ¢å¤åˆ°è°ƒç”¨è€…çš„çŠ¶æ€ã€‚&lt;/li&gt;
&lt;li&gt;enterï¼šä¸ºæ–°å‡½æ•°æ ˆå¸§åˆ†é…ç©ºé—´ï¼Œä¿å­˜å½“å‰çš„ EBPï¼Œå¹¶æ›´æ–° EBP ä¸ºæ–°æ ˆå¸§çš„èµ·å§‹ä½ç½®ã€‚&lt;/li&gt;
&lt;li&gt;retï¼šå‡½æ•°è¿”å›žï¼Œå°†æ ˆé¡¶çš„è¿”å›žåœ°å€å¼¹å‡ºåˆ° EIP ä¸­ï¼Œæ¢å¤ç¨‹åºçš„æ‰§è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;å‡½æ•°è°ƒç”¨çš„æ ˆæ“ä½œ&lt;br&gt;
åœ¨å‡½æ•°è°ƒç”¨è¿‡ç¨‹ä¸­ï¼Œæ ˆçš„ä½¿ç”¨é€šå¸¸æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;å‚æ•°å…¥æ ˆï¼šä½¿ç”¨ push æŒ‡ä»¤å°†å‡½æ•°çš„å‚æ•°ä¾æ¬¡åŽ‹å…¥æ ˆä¸­ã€‚&lt;/li&gt;
&lt;li&gt;è°ƒç”¨å‡½æ•°ï¼šä½¿ç”¨  &lt;code&gt;call &amp;lt;location&amp;gt;&lt;/code&gt;  æŒ‡ä»¤è°ƒç”¨å‡½æ•°ã€‚å½“å‰æŒ‡ä»¤åœ°å€ï¼ˆEIPï¼‰ä¼šè¢«åŽ‹å…¥æ ˆä¸­ï¼Œä¾¿äºŽå‡½æ•°æ‰§è¡Œå®Œæ¯•åŽè¿”å›žã€‚EIP å°†è¢«è®¾ç½®ä¸ºå‡½æ•°çš„èµ·å§‹åœ°å€ï¼ˆ &lt;code&gt;&amp;lt;location&amp;gt;&lt;/code&gt; ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä¿å­˜å±€éƒ¨å˜é‡å’Œ EBPï¼šå‡½æ•°è°ƒç”¨åŽï¼Œå±€éƒ¨å˜é‡å’Œè°ƒç”¨è€…çš„ EBP è¢«åŽ‹å…¥æ ˆä¸­ï¼Œç”¨äºŽä¸ºæ–°å‡½æ•°æ ˆå¸§åˆ†é…ç©ºé—´ã€‚&lt;/li&gt;
&lt;li&gt;æ‰§è¡Œå‡½æ•°ï¼šå‡½æ•°å†…éƒ¨æ‰§è¡Œå…·ä½“çš„ä»»åŠ¡ï¼ŒåŒ…æ‹¬è®¿é—®å±€éƒ¨å˜é‡ã€å¤„ç†é€»è¾‘å’Œä¿®æ”¹æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;æ¢å¤å±€éƒ¨å˜é‡å’Œè°ƒç”¨è€…çš„ EBPï¼šä½¿ç”¨ leave æŒ‡ä»¤ï¼Œå°† EBP å’Œå±€éƒ¨å˜é‡æ¢å¤ä¸ºè°ƒç”¨è€…çš„çŠ¶æ€ã€‚&lt;/li&gt;
&lt;li&gt;æ¢å¤ EIPï¼šä½¿ç”¨ ret æŒ‡ä»¤ï¼Œå°†æ ˆé¡¶çš„è¿”å›žåœ°å€å¼¹å‡ºåˆ° EIP ä¸­ï¼Œä»¥ç»§ç»­æ‰§è¡Œè°ƒç”¨å‡½æ•°çš„ç¨‹åºã€‚&lt;/li&gt;
&lt;li&gt;æ¸…ç†å‚æ•°ï¼šå‚æ•°åœ¨å‡½æ•°è¿”å›žåŽå¯èƒ½éœ€è¦è¢«æ¸…ç†ï¼Œä»Žè€Œæ¢å¤æ ˆçš„å¹³è¡¡çŠ¶æ€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img data-src=&#34;https://img.picui.cn/free/2024/10/25/671b64bb0713f.png&#34; alt=&#34;img&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;Conditionals and Branching&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Conditionals and Branching&#34;&gt;#&lt;/a&gt;Conditionals and Branching&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;æ¡ä»¶æŒ‡ä»¤ï¼ˆConditionalsï¼‰
&lt;ol&gt;
&lt;li&gt;test æŒ‡ä»¤&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;åŠŸèƒ½ï¼štest æŒ‡ä»¤ç±»ä¼¼äºŽé€»è¾‘ä¸Žï¼ˆANDï¼‰æ“ä½œï¼Œä½†ä¸ä¼šä¿®æ”¹æ“ä½œæ•°ï¼Œåªç”¨äºŽè®¾ç½®æ ‡å¿—ä½ã€‚&lt;/li&gt;
&lt;li&gt;æ ‡å¿—ä½ï¼šä¸»è¦è®¾ç½® ZFï¼ˆé›¶æ ‡å¿—ï¼‰ã€‚å¦‚æžœæ“ä½œæ•°ä¹‹é—´çš„é€»è¾‘ä¸Žç»“æžœä¸ºé›¶ï¼Œåˆ™ ZF è¢«ç½® 1ï¼Œå¦åˆ™ç½® 0ã€‚&lt;/li&gt;
&lt;li&gt;ç”¨æ³•ï¼šé€šå¸¸ç”¨äºŽæ£€æŸ¥æŸä¸ªä½æ˜¯å¦è¢«è®¾ç½®ï¼Œä¾‹å¦‚åˆ¤æ–­ä¸€ä¸ªå˜é‡æ˜¯å¦ä¸ºé›¶æˆ–æ£€æµ‹ç‰¹å®šä½æ˜¯å¦ä¸º 1ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;cmp æŒ‡ä»¤&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;åŠŸèƒ½ï¼šcmp æŒ‡ä»¤ç±»ä¼¼äºŽå‡æ³•ï¼ˆSUBï¼‰æ“ä½œï¼Œä½†ä¸ä¼šæ”¹å˜æ“ä½œæ•°çš„å€¼ï¼Œåªç”¨äºŽè®¾ç½®æ ‡å¿—ä½ã€‚&lt;/li&gt;
&lt;li&gt;æ ‡å¿—ä½ï¼šä¸»è¦è®¾ç½® ZFï¼ˆé›¶æ ‡å¿—ï¼‰ å’Œ CFï¼ˆè¿›ä½æ ‡å¿—ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ZFï¼ˆé›¶æ ‡å¿—ï¼‰ï¼šå½“ä¸¤ä¸ªæ“ä½œæ•°ç›¸ç­‰æ—¶ï¼ŒZF è¢«ç½® 1ã€‚&lt;/li&gt;
&lt;li&gt;CFï¼ˆè¿›ä½æ ‡å¿—ï¼‰ï¼šå½“ç›®æ ‡æ“ä½œæ•°å°äºŽæºæ“ä½œæ•°æ—¶ï¼ŒCF è¢«ç½® 1ã€‚&lt;/li&gt;
&lt;li&gt;ç”¨æ³•ï¼šé€šå¸¸ç”¨äºŽæ¯”è¾ƒä¸¤ä¸ªæ•°å€¼å¤§å°ï¼Œä»¥å†³å®šä¸‹ä¸€æ­¥çš„æ¡ä»¶è·³è½¬ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;cmp æŒ‡ä»¤çš„æ ‡å¿—ä½ç»“æžœ&lt;br&gt;
 cmp dst, src çš„ä¸åŒç»“æžœä¸‹çš„æ ‡å¿—ä½å˜åŒ–ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;dst = srcï¼šZF = 1, CF = 0ï¼ˆç›®æ ‡æ“ä½œæ•°ç­‰äºŽæºæ“ä½œæ•°ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;dst &amp;lt; srcï¼šZF = 0, CF = 1ï¼ˆç›®æ ‡æ“ä½œæ•°å°äºŽæºæ“ä½œæ•°ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;dst &amp;gt; srcï¼šZF = 0, CF = 0ï¼ˆç›®æ ‡æ“ä½œæ•°å¤§äºŽæºæ“ä½œæ•°ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;åˆ†æ”¯æŒ‡ä»¤ï¼ˆBranchingï¼‰&lt;br&gt;
åˆ†æ”¯æ˜¯æ ¹æ®ç¨‹åºçš„æŽ§åˆ¶æµæœ‰æ¡ä»¶åœ°æ‰§è¡Œä»£ç åºåˆ—ã€‚åˆ†æ”¯æŒ‡ä»¤å†³å®šç¨‹åºåœ¨ç‰¹å®šæ¡ä»¶ä¸‹çš„è·³è½¬ã€‚
&lt;ol&gt;
&lt;li&gt;æ— æ¡ä»¶è·³è½¬ï¼ˆUnconditional Jumpï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;jmp &lt;location&gt;ï¼šæ— æ¡ä»¶è·³è½¬æŒ‡ä»¤ä¼šç›´æŽ¥è·³è½¬åˆ°æŒ‡å®šçš„ä½ç½®ï¼ˆ&lt;location&gt;ï¼‰ï¼Œæ— è®ºæ¡ä»¶æ˜¯å¦æ»¡è¶³ã€‚&lt;/li&gt;
&lt;li&gt;ç”¨æ³•ï¼šæ— æ¡ä»¶è·³è½¬ç”¨äºŽæ”¹å˜ç¨‹åºçš„æ‰§è¡Œé¡ºåºï¼Œæ˜¯ä¸€ç§ä¸ä¾èµ–æ ‡å¿—ä½çš„è·³è½¬å½¢å¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;æ¡ä»¶è·³è½¬ï¼ˆConditional Jumpï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æ¡ä»¶è·³è½¬æŒ‡ä»¤ï¼šä½¿ç”¨æ ‡å¿—å¯„å­˜å™¨çš„å€¼æ¥å†³å®šæ˜¯å¦è¿›è¡Œè·³è½¬ã€‚å¸¸è§çš„æ¡ä»¶è·³è½¬æŒ‡ä»¤æœ‰è¶…è¿‡ 30 ç§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://example.com/course/C-language-basics-and-Computer-memory/</guid>
            <title>C language basics and Computer memory</title>
            <link>http://example.com/course/C-language-basics-and-Computer-memory/</link>
            <category>software security</category>
            <category>Linux</category>
            <category>C language</category>
            <pubDate>Thu, 24 Oct 2024 21:00:05 +1000</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;C language basics&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#C language basics&#34;&gt;#&lt;/a&gt;C language basics&lt;/h1&gt;
&lt;h2 id=&#34;input/output&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#input/output&#34;&gt;#&lt;/a&gt; input/output&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;To print output to the terminal screen:&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;printf(â€œHello\nâ€);&lt;/li&gt;
&lt;li&gt;printf(â€œHello %sâ€, â€œhaxorâ€);  // using a format string&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;To get input from the user:&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;scanf(&amp;quot;%d&amp;quot;, &amp;amp;number);&lt;/li&gt;
&lt;/ul&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Input/output format symbols&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;test\n&amp;quot;&lt;/span&gt;);   &lt;span class=&#34;comment&#34;&gt;// `\n`:  Carriage return/new line&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;test %d&amp;quot;&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;123&lt;/span&gt;);  &lt;span class=&#34;comment&#34;&gt;//`%d`:  Decimal value&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;test %s&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;123&amp;quot;&lt;/span&gt;);  &lt;span class=&#34;comment&#34;&gt;//`%s`:  String value&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;test %x&amp;quot;&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0x123&lt;/span&gt;);  &lt;span class=&#34;comment&#34;&gt;//`%x`:  Hex value&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;C Program takes command-line arguments&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//meet.c&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;greeting(&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; *temp1, &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; *temp2) &lt;span class=&#34;comment&#34;&gt;// greeting function to say hello&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; name[&lt;span class=&#34;number&#34;&gt;400&lt;/span&gt;];  &lt;span class=&#34;comment&#34;&gt;// string variable to hold the name&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;strcpy&lt;/span&gt;(name, temp2);  &lt;span class=&#34;comment&#34;&gt;// copy function argument to name&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;Hello %s %s\n&amp;quot;&lt;/span&gt;, temp1, name);  &lt;span class=&#34;comment&#34;&gt;// print out the greeting&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;main(&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; argc, &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; *argv[]) &lt;span class=&#34;comment&#34;&gt;// note the format for arguments&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    greeting(argv[&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;], argv[&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;]);  &lt;span class=&#34;comment&#34;&gt;// call function, pass title &amp;amp; name&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;Bye %s %s\n&amp;quot;&lt;/span&gt;, argv[&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;], argv[&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;]);  &lt;span class=&#34;comment&#34;&gt;// say â€œbye&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;Compiling C programs&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Compiling C programs&#34;&gt;#&lt;/a&gt; Compiling C programs&lt;/h2&gt;
Compiling C programs(Linux) Using gcc
&lt;ol&gt;
&lt;li&gt;To compile our  &lt;code&gt;meet.c&lt;/code&gt;  program, type&lt;/li&gt;
&lt;/ol&gt;
 &lt;figure class=&#34;highlight bash&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$gcc&lt;/span&gt; -o meet meet.c&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Then to execute the new program, type&lt;/li&gt;
&lt;/ol&gt;
 &lt;figure class=&#34;highlight bash&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;$ ./meet zz&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Commonly used gcc flags&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;-o &lt;filename&gt;: produces compiled binary file with filename (a.out by default).&lt;/li&gt;
&lt;li&gt;-S: produces assembly code in a file; saved with a .s extension&lt;/li&gt;
&lt;li&gt;-g, -ggdb: produces extra debugging information for gdb (GNU debugger)&lt;/li&gt;
&lt;li&gt;-c: compiles without linking; produces object files with an .o extension&lt;/li&gt;
&lt;li&gt;Check out manual by using: man gcc&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;32-bit vs 64-bit compilation&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;To compile into 32-bit binaries:&lt;/li&gt;
&lt;/ul&gt;
 &lt;figure class=&#34;highlight bash&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$gcc&lt;/span&gt; -m32 hello.c -o hello&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;install a standard library of&lt;/li&gt;
&lt;/ul&gt;
 &lt;figure class=&#34;highlight bash&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$sudo&lt;/span&gt; apt install gcc-multilib &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;C vs C#&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#C vs C#&#34;&gt;#&lt;/a&gt; C vs C#&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;C# is type-safe&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Strong static type system + runtime checks (e.g. bounds, type casts) + automatic memory management&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;C is type-unsafe&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Pointers + no runtime check (out-of-bound access, bad type casts), manual memory management&lt;br&gt;
Runtime array bounds check in C#&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;If the following C# code is executed on .NET:&lt;/p&gt;
 &lt;figure class=&#34;highlight c#&#34;&gt;&lt;figcaption&gt;&lt;span&gt;(â—Ë‡âˆ€Ë‡â—)&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;int&lt;/span&gt; arr[&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; arr[&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;] = &lt;span class=&#34;number&#34;&gt;50&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;An exception will be raised at runtime!&lt;/p&gt;
&lt;p&gt;The length of the array is recorded and checked by the runtime&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The length of an array is fixed once created&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;No runtime array bounds check in C, If the same C code is executed:&lt;/p&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;(â—Ë‡âˆ€Ë‡â—)&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; arr[&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; arr[&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;] = &lt;span class=&#34;number&#34;&gt;50&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;No error, result in a silent buffer overflow!&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Unexpected behaviours such as mysterious crashes depending on what was overwritten&lt;/li&gt;
&lt;li&gt;Attackers may exploit this if they can control the overwritten data&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Automatic memory management in C#&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Programmers do not write code to perform memory management tasks&lt;br&gt;
Garbage collector manages the allocation and release of memory&lt;br&gt;
C# has no common memory problems such as buffer overflow&lt;/p&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;C# strings&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;C# strings are  &lt;code&gt;objects&lt;/code&gt;  of the  &lt;code&gt;String&lt;/code&gt;  class&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Similar to an array of chars, but immutable&lt;/li&gt;
&lt;li&gt;The length is stored on the object for bounds checks at runtime&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;All string manipulation operations do not modify the original string&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;A new string is created upon modification&lt;/li&gt;
&lt;li&gt;For example,  &lt;code&gt;str.Trim()&lt;/code&gt;  returns a new string&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;C strings&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;C strings are arrays of characters&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Terminated by and including the first occurrence of the null character  &lt;code&gt;\0&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;String length is not automatically tracked&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;It is determined by the number of bytes (character) preceding the null character.&lt;/li&gt;
&lt;li&gt;The memory required to store a string is the number of characters plus one&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;A string can be manipulated just like any other arrays&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;We usually use some built-in string functions in C libraries&lt;/li&gt;
&lt;/ul&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;copy one string to another&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#&lt;span class=&#34;keyword&#34;&gt;include&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;lt;string.h&amp;gt;&lt;/span&gt;    &lt;span class=&#34;comment&#34;&gt;// use string library     &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; str1[] = &lt;span class=&#34;string&#34;&gt;&amp;quot;Hello, Z&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; str2[&lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;strcpy&lt;/span&gt;(str2, str1);  &lt;span class=&#34;comment&#34;&gt;// copy each character in str1 into str2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;The function  &lt;code&gt;strcpy&lt;/code&gt;  copies each character in the source string (a series of characters ending with and including a null character) into the destination string&lt;/p&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;To compare two strings&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; str1[] = &lt;span class=&#34;string&#34;&gt;&amp;quot;hello&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; str2[] = &lt;span class=&#34;string&#34;&gt;&amp;quot;haxor&amp;quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; (&lt;span class=&#34;built_in&#34;&gt;strcmp&lt;/span&gt;(str1, str2) == &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;Strings are the same.\n&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;Strings are different.\n&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;This code prints out: Strings are different.&lt;br&gt;
Note that the function  &lt;code&gt;strcmp()&lt;/code&gt;  does not return a  &lt;code&gt;boolean&lt;/code&gt;  result&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Zero represents false, anything else represents true&lt;/li&gt;
&lt;li&gt;No  &lt;code&gt;boolean&lt;/code&gt;  type in C language prior to C99&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;6&#34;&gt;
&lt;li&gt;&lt;strong&gt;Other common string functions&lt;/strong&gt; &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9lbi53aWtpYm9va3Mub3JnL3dpa2kvQ19Qcm9ncmFtbWluZy9TdHJpbmdfbWFuaXB1bGF0aW9u&#34;&gt;More can be found&lt;/span&gt;&lt;br&gt;
 &lt;code&gt;strlen&lt;/code&gt; : gets the length of a string&lt;br&gt;
 &lt;code&gt;strncpy&lt;/code&gt; : copies one string to another with a bound&lt;br&gt;
 &lt;code&gt;strcat&lt;/code&gt; ,  &lt;code&gt;strncat&lt;/code&gt; : string concatenation&lt;br&gt;
 &lt;code&gt;gets&lt;/code&gt; ,  &lt;code&gt;fgets&lt;/code&gt; : receives input into a string&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;C strings is error prone&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#C strings is error prone&#34;&gt;#&lt;/a&gt;C strings is error prone&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Common string manipulation errors:&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Buffer errors&lt;/li&gt;
&lt;li&gt;Heap errors&lt;/li&gt;
&lt;li&gt;Outâ€byâ€bound errors&lt;/li&gt;
&lt;li&gt;Integer overflows&lt;/li&gt;
&lt;li&gt;Other memory, pointer and type errors&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;When data is copied from an unbounded source to a fixedâ€length sink&lt;/strong&gt;&lt;/p&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Unbounded string copy&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; 	&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; username[&lt;span class=&#34;number&#34;&gt;8&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; 	&lt;span class=&#34;built_in&#34;&gt;puts&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;Please enter your username:&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; 	gets(username);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; 	&lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;Your username is %s\n&amp;quot;&lt;/span&gt;, username);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;Use of  &lt;code&gt;gets()&lt;/code&gt;  Function&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The function  &lt;code&gt;gets()&lt;/code&gt;  reads input from the user into a buffer, but it does not check the length of the input against the bufferâ€™s size.&lt;br&gt;
In this code, the  &lt;code&gt;username&lt;/code&gt;  array is only 8 bytes long. However,  &lt;code&gt;gets()&lt;/code&gt;  allows users to enter an input of any length, which means it can write beyond the 8 bytes allocated for  &lt;code&gt;username&lt;/code&gt; .&lt;br&gt;
This can cause a buffer overflow, which can lead to memory corruption, unexpected behavior, or even security vulnerabilities where attackers can execute arbitrary code.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Fixed-Length Buffer&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The username array is declared to have a size of 8, but we need to reserve one byte for the null-terminator  &lt;code&gt;\0&lt;/code&gt; , which marks the end of the string.&lt;br&gt;
This means only 7 characters can safely be stored in the username buffer.&lt;br&gt;
If the input exceeds this limit, it will overflow into adjacent memory, potentially causing the program to crash or behave unpredictably.&lt;/p&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Unbounded string copy(fixed)&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; username[&lt;span class=&#34;number&#34;&gt;8&lt;/span&gt;];  &lt;span class=&#34;comment&#34;&gt;// Buffer limited to 8 bytes&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;puts&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;Please enter your username:&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    fgets(username, &lt;span class=&#34;keyword&#34;&gt;sizeof&lt;/span&gt;(username), &lt;span class=&#34;built_in&#34;&gt;stdin&lt;/span&gt;);  &lt;span class=&#34;comment&#34;&gt;// Limit input size to prevent overflow&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;Your username is %s\n&amp;quot;&lt;/span&gt;, username);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;;  &lt;span class=&#34;comment&#34;&gt;// Standard return type&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;Better string functions from libraries&lt;/strong&gt;&lt;br&gt;
Should use functions that restrict the number of bytes for safer programming&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Use  &lt;code&gt;fgets()&lt;/code&gt; , instead of  &lt;code&gt;gets()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Use  &lt;code&gt;strncpy()&lt;/code&gt; , instead of  &lt;code&gt;strcpy()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Use  &lt;code&gt;strncat()&lt;/code&gt; , instead of  &lt;code&gt;strcat()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Use  &lt;code&gt;snprintf()&lt;/code&gt; , instead of instead of  &lt;code&gt;sprintf()&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Nullâ€termination errors&lt;/strong&gt;&lt;/p&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Nullâ€termination errors&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; argc, &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; *argv[])&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; arr[&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;built_in&#34;&gt;strncpy&lt;/span&gt;(arr, &lt;span class=&#34;string&#34;&gt;&amp;quot;0123456789&amp;quot;&lt;/span&gt;, &lt;span class=&#34;keyword&#34;&gt;sizeof&lt;/span&gt;(arr));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;%s\n&amp;quot;&lt;/span&gt;, arr);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;The array is not properly terminated by a null character!&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;When there is no null character among the first n character of the source, the string placed in the&lt;br&gt;
destination will not be null-terminated!&lt;br&gt;
The  &lt;code&gt;printf()&lt;/code&gt;  call prints out all bytes as character till reaching a null!&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To test out, letâ€™s add another array:&lt;/p&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Nullâ€termination errors&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; argc, &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; *argv[])&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; arr[&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; arr2[&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;built_in&#34;&gt;strncpy&lt;/span&gt;(arr, &lt;span class=&#34;string&#34;&gt;&amp;quot;0123456789&amp;quot;&lt;/span&gt;, &lt;span class=&#34;keyword&#34;&gt;sizeof&lt;/span&gt;(arr));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;built_in&#34;&gt;strncpy&lt;/span&gt;(arr2, &lt;span class=&#34;string&#34;&gt;&amp;quot;9876543210&amp;quot;&lt;/span&gt;, &lt;span class=&#34;keyword&#34;&gt;sizeof&lt;/span&gt;(arr2));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;%s\n&amp;quot;&lt;/span&gt;, arr);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;The program will print out 01234567899876543210&lt;br&gt;
Where the length of source string is the same or greater than the length of target string&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The source string gets truncated&lt;/li&gt;
&lt;li&gt;The target string may not be properly terminated by null!&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;How can we fix it?&lt;br&gt;
Manually add a null character at the end of the target string:&lt;/p&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Nullâ€termination errors(fixed)&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; argc, &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; *argv[])&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; arr[&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;built_in&#34;&gt;strncpy&lt;/span&gt;(arr, &lt;span class=&#34;string&#34;&gt;&amp;quot;0123456789&amp;quot;&lt;/span&gt;, &lt;span class=&#34;keyword&#34;&gt;sizeof&lt;/span&gt;(arr)&lt;span class=&#34;number&#34;&gt;-1&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	arr[&lt;span class=&#34;keyword&#34;&gt;sizeof&lt;/span&gt;(arr)&lt;span class=&#34;number&#34;&gt;-1&lt;/span&gt;] = &lt;span class=&#34;string&#34;&gt;&amp;#x27;\0&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;%s\n&amp;quot;&lt;/span&gt;, arr);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;The function char  &lt;code&gt;*fgets(char *str, int n, FILE *stream)&lt;/code&gt;  reads  &lt;code&gt;(n-1)&lt;/code&gt;  characters from the specific stream plus the final null character&lt;/p&gt;
&lt;h1 id=&#34; Computer memory&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;# Computer memory&#34;&gt;#&lt;/a&gt; Computer memory&lt;/h1&gt;
&lt;h2 id=&#34; Intel x86 (32-bit)&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;# Intel x86 (32-bit)&#34;&gt;#&lt;/a&gt; Intel x86 (32-bit)&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;von Neumann architecture&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Central processing unit (CPU) executes code&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Main memory of the system (RAM) stores all data and code&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Input/output system (I/O) interfaces with devices such as hard drives, keyboards, and monitors&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://img.picui.cn/free/2024/10/24/671a56f0c953f.png&#34; alt=&#34;img&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;CPU&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The &lt;strong&gt;control unit&lt;/strong&gt; gets instructions to execute from RAM using the instruction pointer, which stores the address of the instruction to execute&lt;br&gt;
&lt;strong&gt;Registers&lt;/strong&gt; are the CPUâ€™s basic data storage units and are often used to save time so that the CPU doesnâ€™t need to access RAM.&lt;/p&gt;
&lt;p&gt;åœ¨ 32 ä½ x86 æž¶æž„ä¸­ï¼Œä¸»è¦çš„é€šç”¨å¯„å­˜å™¨åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;EAX: ç´¯åŠ å™¨å¯„å­˜å™¨ï¼Œç”¨äºŽç®—æœ¯è¿ç®—å’Œè¿”å›žå€¼ã€‚&lt;/li&gt;
&lt;li&gt;EBX: åŸºå€å¯„å­˜å™¨ï¼Œå¸¸ç”¨äºŽåŸºå€å­˜å–ã€‚&lt;/li&gt;
&lt;li&gt;ECX: è®¡æ•°å™¨å¯„å­˜å™¨ï¼Œå¸¸ç”¨äºŽå¾ªçŽ¯å’Œç§»ä½æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;EDX: æ•°æ®å¯„å­˜å™¨ï¼Œç”¨äºŽ I/O æ“ä½œå’Œä¹˜é™¤æ³•ã€‚&lt;/li&gt;
&lt;li&gt;ESI: æºç´¢å¼•å¯„å­˜å™¨ï¼Œå¸¸ç”¨äºŽæŒ‡å‘å†…å­˜æ•°æ®æºã€‚&lt;/li&gt;
&lt;li&gt;EDI: ç›®æ ‡ç´¢å¼•å¯„å­˜å™¨ï¼Œå¸¸ç”¨äºŽæŒ‡å‘å†…å­˜æ•°æ®ç›®æ ‡ã€‚&lt;/li&gt;
&lt;li&gt;EBP: åŸºå€æŒ‡é’ˆå¯„å­˜å™¨ï¼Œç”¨äºŽæ ˆå¸§åŸºå€æŒ‡é’ˆã€‚&lt;/li&gt;
&lt;li&gt;ESP: æ ˆæŒ‡é’ˆå¯„å­˜å™¨ï¼ŒæŒ‡å‘å½“å‰æ ˆé¡¶&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The &lt;strong&gt;Arithmetic Logic Unit (ALU)&lt;/strong&gt; executes an instruction fetched from RAM and places the results in registers or memory&lt;/p&gt;
&lt;p&gt;CPU runs a program by fetching and executing each instruction&lt;/p&gt;
&lt;h2 id=&#34;Programs in the main memory&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Programs in the main memory&#34;&gt; #&lt;/a&gt;  Programs in the main memory&lt;/h2&gt;
&lt;p&gt;Processes are programs loaded into memory, broken into small sections&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;.text section&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;.data section&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;.bss section&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Heap section&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Stack section&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Environment/Arguments section&lt;/p&gt;
&lt;p&gt;&lt;img data-src=&#34;https://img.picui.cn/free/2024/10/24/671a56f09cb3d.png&#34; alt=&#34;img&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;.text section&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Correspond to the .text portion of the binary executable file.&lt;/p&gt;
&lt;p&gt;Contain the machine instructions to get the task done&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;.data section&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Store global initialised variables such as:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;int a = 0;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;.bss section&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Store global uninitialised variables such as:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;int a;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;Heap section&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Store dynamically allocated variables&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Contain the pre-existing value of that memory&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Grows from the lower-addressed memory to the higher-addressed memory&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;int *I = malloc (sizeof (int));&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;Stack section&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Keep track of function calls (recursively)&lt;/p&gt;
&lt;p&gt;Grow from the higher-addressed memory to the lower-addressed memory&lt;/p&gt;
&lt;p&gt;Local variables are in the stack section&lt;/p&gt;
&lt;ol start=&#34;6&#34;&gt;
&lt;li&gt;Environment/Arguments section&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Store a copy of system-level variables that may be required by the process&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;For example, path, shell name, hostname, etc.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Command-line arguments are stored in this area.&lt;/p&gt;
&lt;h2 id=&#34; Buffers&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;# Buffers&#34;&gt;#&lt;/a&gt; Buffers&lt;/h2&gt;
&lt;p&gt;A storage place used to receive and hold data until it can be handled by a process&lt;br&gt;
Each process can have its own set of buffers&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;E.g. memory allocated within the .data or .bss section of the processâ€™s memory&lt;br&gt;
Buffer is of &lt;strong&gt;fixed length once allocated&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;Hold any predefined type of data&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34; Pointers&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;# Pointers&#34;&gt;#&lt;/a&gt; Pointers&lt;/h2&gt;
&lt;p&gt;Pointers hold the address of other pieces of memory&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Their size is fixed of 4 bytes for 32-bit memory address&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;C string can be written as a pointer to character:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;char * str;&lt;/li&gt;
&lt;li&gt;int * point1;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;C#â€™s reference types implicitly use pointers&lt;br&gt;
Use dereference to read the value inside the memory address pointed to by the pointer:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;printf(&amp;quot;%d&amp;quot;, *point1);&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The  &lt;code&gt;*&lt;/code&gt;  symbol dereferences the pointer called point1 and displays the value of the integer using the  &lt;code&gt;printf()&lt;/code&gt;  function&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The type of  &lt;code&gt;point1&lt;/code&gt;  is a pointer&lt;/li&gt;
&lt;li&gt;The type of  &lt;code&gt;*point1&lt;/code&gt;  is an integer&lt;/li&gt;
&lt;/ul&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Putting the pieces of memory together&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; ind = &lt;span class=&#34;number&#34;&gt;5&lt;/span&gt;;                     &lt;span class=&#34;comment&#34;&gt;// integer stored in .data (initialized)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; *str;                       &lt;span class=&#34;comment&#34;&gt;// string pointer stored in .bss (uninitialized)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; nothing;                     &lt;span class=&#34;comment&#34;&gt;// integer stored in .bss (uninitialized)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;type&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;fun&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; c)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;                                              &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; 	&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; i = c;                                  &lt;span class=&#34;comment&#34;&gt;// stored in stack section&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; 	str = (&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; *)&lt;span class=&#34;built_in&#34;&gt;malloc&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt; * &lt;span class=&#34;keyword&#34;&gt;sizeof&lt;/span&gt;(&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt;));    &lt;span class=&#34;comment&#34;&gt;// reserves 10 characters in heap region &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; 	&lt;span class=&#34;built_in&#34;&gt;strncpy&lt;/span&gt;(str, &lt;span class=&#34;string&#34;&gt;&amp;quot;abcde&amp;quot;&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;5&lt;/span&gt;);                   &lt;span class=&#34;comment&#34;&gt;// copies &amp;quot;abcde&amp;quot; into str&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;type&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	fun(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
 ]]></description>
        </item>
    </channel>
</rss>
