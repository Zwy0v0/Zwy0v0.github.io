<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title> â€¢ Posts by &#34;vulnerability&#34; tag</title>
        <link>http://example.com</link>
        <description>ðŸŒ¸</description>
        <language>zh-CN</language>
        <pubDate>Sat, 26 Oct 2024 17:50:30 +1000</pubDate>
        <lastBuildDate>Sat, 26 Oct 2024 17:50:30 +1000</lastBuildDate>
        <category>C</category>
        <category>software security</category>
        <category>vulnerability</category>
        <category>C language</category>
        <category>Linux</category>
        <category>gdb</category>
        <category>JavaScript</category>
        <category>Blog</category>
        <category>æ—¥å¸¸</category>
        <item>
            <guid isPermalink="true">http://example.com/course/Stack-buffer-overflow/</guid>
            <title>Stack buffer overflow</title>
            <link>http://example.com/course/Stack-buffer-overflow/</link>
            <category>C</category>
            <category>software security</category>
            <category>vulnerability</category>
            <pubDate>Sat, 26 Oct 2024 17:50:30 +1000</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;Stack buffer overflow&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Stack buffer overflow&#34;&gt;#&lt;/a&gt;Stack buffer overflow&lt;/h1&gt;

&lt;ol&gt;
&lt;li&gt;The Process Stack&lt;/li&gt;
&lt;/ol&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Sample Process C Code&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; a, &lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; b, &lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; c)&lt;/span&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; buffer1[&lt;span class=&#34;number&#34;&gt;5&lt;/span&gt;]; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; buffer2[&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;]; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    	... &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;type&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	A(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;built_in&#34;&gt;printf&lt;/span&gt;(...); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   	 ... &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;&lt;img data-src=&#34;https://img.picui.cn/free/2024/10/26/671ca1b71cfbb.png&#34; alt=&#34;img&#34;&gt;&lt;/p&gt;
&lt;p&gt;åœ¨è°ƒç”¨å‡½æ•°æ—¶ï¼Œå‡½æ•°å‚æ•°æ˜¯æŒ‰ç…§ä»Žå³åˆ°å·¦çš„é¡ºåºä¾æ¬¡åŽ‹å…¥æ ˆä¸­ã€‚è¿™ç§å‚æ•°ä¼ é€’æ–¹å¼æ˜¯ x86 æž¶æž„çš„æ ‡å‡†åšæ³•ï¼Œç”¨äºŽä¿è¯å‡½æ•°å‚æ•°åœ¨æ ˆä¸Šçš„æ­£ç¡®é¡ºåºã€‚&lt;br&gt;åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå‡½æ•° &lt;code&gt;A(int a, int b, int c)&lt;/code&gt; è¢«è°ƒç”¨æ—¶ï¼Œ&lt;code&gt;c&lt;/code&gt; é¦–å…ˆè¢«åŽ‹å…¥æ ˆï¼Œç„¶åŽæ˜¯ &lt;code&gt;b&lt;/code&gt;ï¼Œæœ€åŽæ˜¯ &lt;code&gt;a&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Buffer Overflow&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Occurs when:&lt;br&gt; Input is unconstrained&lt;br&gt; Runs past the end of a buffer, replacing valid (control) data &lt;/li&gt;
&lt;li&gt;Technique that allows:&lt;br&gt;  Your code to be executed by another program&lt;br&gt;  Overflow data area to alter variable values&lt;/li&gt;
&lt;li&gt;Problem: declaration in version of login.c is &lt;code&gt;char name[80], passwd[80], hash[13];&lt;/code&gt;. Attack login procedure: &lt;ol&gt;
&lt;li&gt;User types username, which is stored in name &lt;/li&gt;
&lt;li&gt;Compute hash for the corresponding password &lt;/li&gt;
&lt;li&gt;User types password, pads to 80 chars, and types hash for that password &lt;/li&gt;
&lt;li&gt;The program validates password against user-supplied hash; user is in (with any password)&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Stack Smashing&lt;br&gt;ç¼“å†²åŒºæº¢å‡ºæ”»å‡»çš„æ ¸å¿ƒæ˜¯è¦†ç›–æ ˆä¸Šçš„ è¿”å›žåœ°å€ï¼ˆretï¼‰ã€‚å½“è¿”å›žåœ°å€è¢«è¦†ç›–æ—¶ï¼Œç¨‹åºåœ¨å‡½æ•°è¿”å›žæ—¶ä¸ä¼šè·³å›žè°ƒç”¨å‡½æ•°çš„ä½ç½®ï¼Œè€Œæ˜¯è·³è½¬åˆ°æ”»å‡»è€…æŒ‡å®šçš„ä½ç½®ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ç§æŠ€æœ¯è®©ç¨‹åºæ‰§è¡Œä»»æ„ä»£ç ï¼ˆå¦‚æ¶æ„ä»£ç æˆ– shellcodeï¼‰ï¼Œè¿™è¢«ç§°ä¸ºå †æ ˆç ´åã€‚ &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;Stack Smashing&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;functionA&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; *str)&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; buffer[&lt;span class=&#34;number&#34;&gt;16&lt;/span&gt;]; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;built_in&#34;&gt;strcpy&lt;/span&gt;(buffer, str);   &lt;span class=&#34;comment&#34;&gt;//segmentation fault&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; large_string[&lt;span class=&#34;number&#34;&gt;256&lt;/span&gt;]; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;type&#34;&gt;int&lt;/span&gt; i; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; (i = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span class=&#34;number&#34;&gt;255&lt;/span&gt;; i++) &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;       &amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		large_string[i] = &lt;span class=&#34;string&#34;&gt;&amp;#x27;A&amp;#x27;&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	functionA(large_string); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;buffer&lt;/code&gt;ï¼šåœ¨ &lt;code&gt;functionA&lt;/code&gt; ä¸­å£°æ˜Žä¸º 16 å­—èŠ‚çš„å­—ç¬¦æ•°ç»„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;strcpy(buffer, str)&lt;/code&gt;ï¼šä½¿ç”¨ &lt;code&gt;strcpy&lt;/code&gt; å°†å¤–éƒ¨ä¼ å…¥çš„å­—ç¬¦ä¸² str å¤åˆ¶åˆ° buffer ä¸­ã€‚ç”±äºŽ &lt;code&gt;strcpy&lt;/code&gt; ä¸æ£€æŸ¥é•¿åº¦ï¼Œå¦‚æžœ &lt;code&gt;str&lt;/code&gt; çš„é•¿åº¦è¶…è¿‡ 16 å­—èŠ‚ï¼Œä¼šå¯¼è‡´ç¼“å†²åŒºæº¢å‡ºã€‚&lt;/li&gt;
&lt;li&gt;åœ¨ &lt;code&gt;main&lt;/code&gt; ä¸­ï¼Œ&lt;code&gt;large_string&lt;/code&gt; æ˜¯ä¸€ä¸ª 256 å­—èŠ‚çš„æ•°ç»„ï¼Œå®ƒè¢«å¡«å……ä¸º 255 ä¸ª â€˜Aâ€™ã€‚å½“ &lt;code&gt;large_string&lt;/code&gt; è¢«ä¼ é€’ç»™ &lt;code&gt;functionA&lt;/code&gt; æ—¶ï¼Œ&lt;code&gt;buffer&lt;/code&gt; è¢«æº¢å‡ºã€‚&lt;/li&gt;
&lt;li&gt;ä¿®å¤ï¼š &lt;code&gt;strcpy(buffer, str)&lt;/code&gt; â€“&amp;gt; &lt;code&gt;strncpy(buffer, str, 16);&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img data-src=&#34;https://img.picui.cn/free/2024/10/26/671ca87ccb1e2.png&#34; alt=&#34;img&#34;&gt;&lt;br&gt; &lt;code&gt;large_str&lt;/code&gt; has overflowed &lt;code&gt;buffer&lt;/code&gt; and &lt;code&gt;sfp&lt;/code&gt; and &lt;code&gt;ret&lt;/code&gt; and &lt;code&gt;*str&lt;/code&gt;.Note that &lt;code&gt;ret&lt;/code&gt; is the return address!&lt;br&gt;This means we can get the function to return to any point in the code that we specify.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Buffer overflows allow us to change return address &lt;ol&gt;
&lt;li&gt;Can point to any function in the library &lt;/li&gt;
&lt;li&gt;Can point to own code&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Add code in the overflowed buffer &lt;ol&gt;
&lt;li&gt;Run at privilege of process (very useful if root!) &lt;/li&gt;
&lt;li&gt;Even a small buffer can invoke a shell using the system call (often called shellcode)&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;Attacker would like to run shell at root level&lt;ol&gt;
&lt;li&gt;Make system call to &lt;code&gt;execve&lt;/code&gt;, passing &lt;code&gt;/bin/sh&lt;/code&gt; &lt;/li&gt;
&lt;li&gt;Needs to be part of the buffer, and in assembly code (ä»¥ä¾¿ç²¾ç¡®æŽ§åˆ¶å…¶å¤§å°å’ŒåŠŸèƒ½)&lt;/li&gt;
&lt;li&gt;Program has to fit in buffer without overwriting return address(å¦‚æžœ shellcode è¦†ç›–äº†è¿”å›žåœ°å€æœ¬èº«ï¼Œå¯èƒ½å¯¼è‡´ç¨‹åºå´©æºƒè€Œæ— æ³•æ‰§è¡Œæ”»å‡»ä»£ç ) &lt;/li&gt;
&lt;li&gt;Pad out buffer to return address, and point return address to start of buffer &lt;/li&gt;
&lt;li&gt;Donâ€™t generate core dump (this will cause suspicion)&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;What do You Need to Hack a Buffer Overflow&lt;ol&gt;
&lt;li&gt;Address where buffer begins&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Easy to get if you have access to the same type of system being attacked &lt;/li&gt;
&lt;li&gt;Can use Null Operation (NOP) commands to make the target address bigger&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Location where return address is stored&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Can pad out the buffer with return address&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Assembly language program to spawn a shell (shellcode payload)&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Can use gdb to disassemble a program for you&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Affected Languages&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Buffer overflows mainly occur in low-level programming languages that allow direct memory access: Assembler, C, C++&lt;br&gt;Note that some high-level languages such as Java, C# and Visual Basic are written in C, C++ or call modules written in these languages&lt;/p&gt;
&lt;ol start=&#34;6&#34;&gt;
&lt;li&gt;&lt;p&gt;Buffer Overflow Examples&lt;br&gt; Functions that handle arrays but do not check length (checking for termination character is insufficient) In C&amp;#x2F;C++,  &lt;code&gt;gets&lt;/code&gt;, &lt;code&gt;strcpy&lt;/code&gt;, &lt;code&gt;strcat&lt;/code&gt;, &lt;code&gt;sprintf&lt;/code&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Example 1&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; buf[&lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;]; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; gets(buf);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;char buf[20]&lt;/code&gt;ï¼šå®šä¹‰äº†ä¸€ä¸ªé•¿åº¦ä¸º 20 çš„å­—ç¬¦æ•°ç»„ &lt;code&gt;buf&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;gets(buf)&lt;/code&gt;ï¼šä½¿ç”¨ &lt;code&gt;gets()&lt;/code&gt; å‡½æ•°ä»Žæ ‡å‡†è¾“å…¥è¯»å–å­—ç¬¦ä¸²ï¼Œå¹¶å­˜å‚¨åœ¨ &lt;code&gt;buf&lt;/code&gt; ä¸­&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;gets()&lt;/code&gt; å‡½æ•°ä¸æ£€æŸ¥è¾“å…¥çš„é•¿åº¦ï¼Œæ„å‘³ç€å¦‚æžœè¾“å…¥çš„å­—ç¬¦ä¸²é•¿åº¦è¶…è¿‡äº† &lt;code&gt;buf&lt;/code&gt; çš„å¤§å°ï¼ˆ20 å­—èŠ‚ï¼‰ï¼Œåˆ™ä¼šå‘ç”Ÿç¼“å†²åŒºæº¢å‡ºã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä¿®å¤ï¼š &lt;code&gt;fgets(buf, sizeof(buf), stdin);&lt;/code&gt;&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Example 2&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; buf[&lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;]; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; prefix[] = &lt;span class=&#34;string&#34;&gt;&amp;quot;http://&amp;quot;&lt;/span&gt;; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   ... &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   &lt;span class=&#34;comment&#34;&gt;// copies the string prefix to buf &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;built_in&#34;&gt;strcpy&lt;/span&gt;(buf, prefix); &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;   &lt;span class=&#34;comment&#34;&gt;// concatenates path to the string buf &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;built_in&#34;&gt;strncat&lt;/span&gt;(buf, path, &lt;span class=&#34;keyword&#34;&gt;sizeof&lt;/span&gt;(buf));&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;char buf[20]&lt;/code&gt;ï¼šå®šä¹‰äº†ä¸€ä¸ªé•¿åº¦ä¸º 20 å­—èŠ‚çš„å­—ç¬¦æ•°ç»„ &lt;code&gt;buf&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;char prefix[] = &amp;quot;http://&amp;quot;;&lt;/code&gt;ï¼šå®šä¹‰äº†ä¸€ä¸ªåŒ…å«å­—ç¬¦ä¸² &lt;code&gt;&amp;quot;http://&amp;quot;&lt;/code&gt; çš„å­—ç¬¦æ•°ç»„ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;strcpy(buf, prefix)&lt;/code&gt;ï¼šå°†å­—ç¬¦ä¸² &lt;code&gt;&amp;quot;http://&amp;quot;&lt;/code&gt; å¤åˆ¶åˆ° &lt;code&gt;buf&lt;/code&gt; ä¸­ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é—®é¢˜ï¼š&lt;code&gt;&amp;quot;http://&amp;quot;&lt;/code&gt; é•¿åº¦ä¸º 7 å­—èŠ‚ï¼ˆåŒ…æ‹¬ç»ˆæ­¢ç¬¦ \0ï¼‰ï¼Œåœ¨å¤åˆ¶åŽï¼Œ&lt;code&gt;buf&lt;/code&gt; ä¸­åªå‰©ä¸‹ 13 ä¸ªå­—èŠ‚å¯ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;strncat(buf, path, sizeof(buf))&lt;/code&gt;ï¼šå°†å­—ç¬¦ä¸² &lt;code&gt;path&lt;/code&gt; è¿žæŽ¥åˆ° &lt;code&gt;buf&lt;/code&gt; ä¸­ï¼ŒæŒ‡å®šçš„æœ€å¤§é•¿åº¦ä¸º &lt;code&gt;sizeof(buf)&lt;/code&gt;ï¼ˆå³ 20 å­—èŠ‚ï¼‰ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é—®é¢˜ï¼šè¿™é‡Œçš„ &lt;code&gt;sizeof(buf)&lt;/code&gt; æ˜¯ 20 å­—èŠ‚ï¼Œä½†åœ¨å‰é¢å·²ç»ç”¨æŽ‰äº† 7 å­—èŠ‚ï¼ˆåŒ…æ‹¬ç»ˆæ­¢ç¬¦ï¼‰ã€‚&lt;code&gt;strncat()&lt;/code&gt; è¯•å›¾è¿½åŠ  &lt;code&gt;path&lt;/code&gt; çš„å†…å®¹æ—¶ï¼Œå¯èƒ½ä¼šè¶…å‡º &lt;code&gt;buf&lt;/code&gt; çš„å‰©ä½™ç©ºé—´ï¼ˆ13 å­—èŠ‚ï¼‰ï¼Œå¯¼è‡´ç¼“å†²åŒºæº¢å‡ºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä¿®å¤ï¼š&lt;code&gt;strncat(buf, path, sizeof(buf) - strlen(buf) - 1);&lt;/code&gt;&lt;/p&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Example 3&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; buf[&lt;span class=&#34;number&#34;&gt;32&lt;/span&gt;]; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;built_in&#34;&gt;strncpy&lt;/span&gt;(buf, data, &lt;span class=&#34;built_in&#34;&gt;strlen&lt;/span&gt;(data)); &lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;code&gt;strncpy(buf, data, strlen(data))&lt;/code&gt;ï¼šå°†å­—ç¬¦ä¸² &lt;code&gt;data&lt;/code&gt; å¤åˆ¶åˆ° &lt;code&gt;buf&lt;/code&gt; ä¸­ï¼Œå¤åˆ¶çš„é•¿åº¦ä¸º &lt;code&gt;strlen(data)&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;ç¼ºé™· 1ï¼šç¼ºå°‘ç»ˆæ­¢ç¬¦ \0ï¼š&lt;code&gt;strncpy&lt;/code&gt; ä¸ä¼šè‡ªåŠ¨æ·»åŠ å­—ç¬¦ä¸²çš„ç»ˆæ­¢ç¬¦ &lt;code&gt;\0&lt;/code&gt;ï¼Œå¦‚æžœ &lt;code&gt;data&lt;/code&gt;çš„é•¿åº¦ç­‰äºŽæˆ–å¤§äºŽ 32ï¼Œé‚£ä¹ˆ &lt;code&gt;buf&lt;/code&gt; ä¸ä¼šä»¥ &lt;code&gt;\0&lt;/code&gt; ç»“å°¾ã€‚è¿™å¯èƒ½å¯¼è‡´ &lt;code&gt;buf&lt;/code&gt; è¢«å½“ä½œæœªç»ˆæ­¢çš„å­—ç¬¦ä¸²å¤„ç†ï¼Œå¸¦æ¥ä¸ç¡®å®šçš„è¡Œä¸ºæˆ–å®‰å…¨é£Žé™©ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç¼ºé™· 2ï¼šå¯èƒ½çš„ç¼“å†²åŒºæº¢å‡ºï¼šå¦‚æžœ &lt;code&gt;strlen(data) &amp;gt; 32&lt;/code&gt;ï¼Œ&lt;code&gt;strncpy&lt;/code&gt; å°†å°è¯•å¤åˆ¶è¶…è¿‡ &lt;code&gt;buf&lt;/code&gt; å¤§å°çš„å†…å®¹ï¼Œå¯¼è‡´ç¼“å†²åŒºæº¢å‡ºã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä¿®å¤ï¼š&lt;code&gt;strncpy(buf, data, sizeof(buf) - 1); buf[sizeof(buf) - 1] = &amp;#39;\0&amp;#39;;&lt;/code&gt;&lt;/p&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;Example 4&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
 &lt;figure class=&#34;highlight c&#34;&gt;&lt;figcaption&gt;&lt;span&gt;OvO&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;type&#34;&gt;char&lt;/span&gt; buf[MAX_PATH]; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;span class=&#34;built_in&#34;&gt;sprintf&lt;/span&gt;(buf, &lt;span class=&#34;string&#34;&gt;&amp;quot;%s - %d\n&amp;quot;&lt;/span&gt;, path, errno);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;sprintf(buf, &amp;quot;%s - %d\n&amp;quot;, path, errno)&lt;/code&gt; ä¼šå°† &lt;code&gt;path&lt;/code&gt; å’Œ &lt;code&gt;errno&lt;/code&gt; çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²å¤åˆ¶åˆ° &lt;code&gt;buf&lt;/code&gt; ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;sprintf&lt;/code&gt; ä¸æ£€æŸ¥ &lt;code&gt;buf&lt;/code&gt; çš„å¤§å°æ˜¯å¦è¶³ä»¥å®¹çº³æ ¼å¼åŒ–åŽçš„ç»“æžœã€‚å¦‚æžœ &lt;code&gt;path&lt;/code&gt; å¾ˆé•¿ï¼ŒåŠ ä¸Šæ•°å­— &lt;code&gt;errno&lt;/code&gt; å’Œå…¶ä»–å­—ç¬¦ï¼Œå¯èƒ½ä¼šè¶…è¿‡ &lt;code&gt;MAX_PATH&lt;/code&gt;ï¼Œå¯¼è‡´ç¼“å†²åŒºæº¢å‡ºã€‚&lt;/li&gt;
&lt;li&gt;ä¿®å¤ï¼š &lt;code&gt;snprintf(buf, sizeof(buf), &amp;quot;%s - %d\n&amp;quot;, path, errno);&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;Stack buffer overflow prevention&#34; class=&#34;active&#34;&gt;&lt;a class=&#34;anchor&#34;  href=&#34;#Stack buffer overflow prevention&#34;&gt;#&lt;/a&gt;Stack buffer overflow prevention&lt;/h1&gt;

&lt;ol&gt;
&lt;li&gt;Spotting Buffer Overflows&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Check inputs, whether read from the network, a file, or from the command line &lt;/li&gt;
&lt;li&gt;Check transfer of data from said input to internal structures &lt;/li&gt;
&lt;li&gt;Look for use of unsafe string handling calls &lt;/li&gt;
&lt;li&gt;Look for use of arithmetic to calculate an allocation size or remaining buffer size&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Fixing Buffer Overflows&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Replace dangerous string handling functions &lt;/li&gt;
&lt;li&gt;Replace C string buffers with C++ strings &lt;/li&gt;
&lt;li&gt;Replace static arrays with STL containers &lt;/li&gt;
&lt;li&gt;Use analysis tools, Examples include Fortify, Coverity, PREfast, and Klocwor&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Code Analysis&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Statically check source to detect buffer overflows s &lt;/li&gt;
&lt;li&gt;Several tools exist to automate the review process&lt;br&gt;Stanford:  Engler, et al.  Test trust inconsistency&lt;br&gt;@stake.com  (l0pht.com): SLINT (designed for UNIX)&lt;br&gt;Berkeley:  Wagner, et al.  Test constraint violations &lt;/li&gt;
&lt;li&gt;Find lots of bugs, but not all&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;Marking Stack as Non-Execute&lt;br&gt;Basic stack exploit can be prevented by marking stack segment as non-executable&lt;br&gt;Limitations and Problems&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Some apps need executable stack (e.g. LISP interpreters) &lt;/li&gt;
&lt;li&gt;Does not block more general overflow exploits &lt;/li&gt;
&lt;li&gt;Overflow on heap: overflow buffer next to func pointer &lt;/li&gt;
&lt;li&gt;Cannot make all the data segment non-executable &lt;/li&gt;
&lt;li&gt;More recent UNIX and MS windows emit dynamic code into program data for performance optimisations&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;Stack Protection and Run-time Checking&lt;br&gt;Many run-time checking techniques &lt;ol&gt;
&lt;li&gt;Example:  StackGuard (WireX)&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Run time tests for stack integrity &lt;/li&gt;
&lt;li&gt;Code generator for emitting code to set up and tear down functions &lt;/li&gt;
&lt;li&gt;Embeds â€œcanariesâ€ in stack frames and verify their integrity prior to function return&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Libsafe (Avaya Labs)&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Dynamically loaded library &lt;/li&gt;
&lt;li&gt;Intercepts calls to &lt;code&gt;strcpy (dest, src)&lt;/code&gt; &lt;ul&gt;
&lt;li&gt;Validate sufficient space in current stack frame: |framepointerâ€“dest| &amp;gt; strlen(src)  &lt;/li&gt;
&lt;li&gt;If so, does strcpy. Otherwise, terminates application&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Address obfuscation (Stony Brookâ€™03)&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Encrypt return address on stack by XORing with random string. Decrypt just before returning from function &lt;/li&gt;
&lt;li&gt;Attacker needs decryption key to set return address to desired value&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;7&#34;&gt;
&lt;li&gt;PaX ASLR: Randomise location of libc&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Attacker cannot jump directly to exec function&lt;/li&gt;
&lt;/ul&gt;
 ]]></description>
        </item>
    </channel>
</rss>
